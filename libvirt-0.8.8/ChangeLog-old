Mon Jul  6 14:26:02 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/downloads.html docs/downloads.html.in: update download
	  informations after switch to git

Fri Jul  3 16:21:48 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in NEWS docs/* po/*: release of
	  libvirt-0.6.5
	* .gitignore: adding cscope files

Fri Jul  3 15:08:24 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c: patch from C.J. Adams-Collier adding support
	  for arm emulation if qemu-system-arm is present

Thu Jul  3 11:27:14 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	Patch from Cole Robinson in https://bugzilla.redhat.com/499569

	* src/security_selinux.c: Skip labelling if no src path
	present

Thu Jul  3 11:26:04 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	Patch from Tim Waugh in https://bugzilla.redhat.com/507555

	* src/security_selinux.c: Don't unnecessarily try to change a
	file context

Thu Jul  3 11:24:44 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	Patch from Dan Berrange in https://bugzilla.redhat.com/493692

	* src/security_selinux.c: Re-label shared and readonly images

Thu Jul  2 15:58:09 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/schemas/network.rng: fix the network schemas to match
	  new accepted elements, patch by Satoru SATOH
	* src/network_conf.c: fix network driver to save the domain name
	  in XML if present, patch by Satoru SATOH
	* AUTHORS: adding Satoru SATOH

Wed Jul  1 23:29:33 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/node_device.c: fix an endless loop in node device XML dump,
	  patch by Cole Robinson

Wed Jul  1 23:23:19 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/drvone.html docs/drvone.html.in: small OpenNebula driver
	  doc update by Abel Miguez Rodriguez

Wed Jul  1 16:22:38 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/drvone.html.in docs/drvone.html docs/drivers.html.in
	  docs/hvsupport.html.in docs/sitemap.html.in docs/*: added
	  documentation for OpenNebula driver by Abel Miguez Rodriguez
	  and regenerated the docs

Wed Jul  1 15:05:25 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/virterror.c: fix some missing comments in public
	  modules.
	* docs/libvirt-api.xml docs/libvirt-refs.xml
	  docs/devhelp/libvirt-libvirt.html docs/html/libvirt-libvirt.html:
	  regenerated documentation
	* po/*: updated the polish localization and regenerated

Wed Jul  1 13:18:37 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/logging.html[.in] qemud/libvirtd.conf qemud/qemud.c
	  src/logging.[ch]: cleanup the logging code and docs to remove
	  all references to log level 0, cleanup hardcoded values and add
	  a default VIR_LOG_DEFAULT value, patch by Amy Griffis

Wed Jul  1 12:38:28 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/opennebula/one_conf.c src/opennebula/one_driver.c: cleanup
	  and small update for OpenNebula driver by Abel Miguez Rodriguez

Wed Jul  1 11:38:15 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/opennebula/one_client.c, src/opennebula/one_client.h:
	Remove unused code. Ensure null termination after strncpy

Wed Jul  1 10:21:15 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/storage_driver.c: don't destroy a pool when calling create
	  by mistake, patch by Dave Allan.

Mon Jun 29 18:01:20 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Reduce LXC capabilities
	* src/lxc_container.c: Use libcap-ng to clear capabilities,
	and also drop SYS_MODULE, SYS_TIME, AUDIT_CONTROL, and
	MAC_ADMIN, in addition to SYS_BOOT.
	* src/lxc_controller.c: Drop all capabilities once container
	has been spawned.

Mon Jun 29 12:48:20 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Use libcap-ng to clear capabilities for many child processes
	* src/Makefile.am: Link to libcap-ng in util code
	* src/qemu_conf.c: Clear capabilities when running qemu -help
	* src/qemu_driver.c: Clear capabilities when running VMs
	* src/remote_internal.c: Clear capabilities for auto-spawned
	libvirtd session daemon, and SSH tunnel client
	* src/uml_driver.c: Clear capabilities for UML VMs
	* src/util.h, src/util.c: Add virExec() flag to allow
	clearing of capabilities when spawning processes

Mon Jun 29 12:28:20 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Prepare for using libcap-ng
	* configure.in: Add check for libcap-ng
	* libvirt.spec.in: Build with libcap-ng on Fedora >= 12

Mon Jun 29 12:01:20 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Add HACKING doc to the website
	* docs/hacking.html.in, docs/sitemaps.html.in: HTML-ized
	version of HACKING
	* docs/internals.html, docs/sitemap.html, docs/api_extension.html,
	docs/news.html: Re-generate for sitemap changes

Mon Jun 29 10:51:20 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix crash in QEMU driver with bad capabilities data
	* src/capabilities.c, src/capabilities.h: Export a method
	virCapabilitiesFreeNUMAInfo()
	* src/qemu_conf.c: Don't kill the whole QEMU driver if
	populating capabilities with NUMA info fails.
	* src/qemu_driver.c: Fix missing security model data
	after capabilities refresh. Avoid leaving driver with
	NULL capabilities if refresh fails.

Fri Jun 26 22:13:16 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/parthelper.c: fix a superfluous % on printf format problem
	  raised by Matthias Bolte

Fri Jun 26 22:02:22 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/nodeinfo.c: sometimes libnuma can't handle some topologies,
	  but those failures should not completely break libvirt, patch
	  by Dan Berrange, fixes #506590

Fri Jun 26 20:11:38 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: avoid a segfault when dumping XML with recent
	  xen versions, patch by Sascha, fixes #503254

Fri Jun 26 18:15:08 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/libvirt_private.syms src/parthelper.c src/storage_backend_disk.c
	  src/storage_conf.c src/storage_conf.h: allow to create storage
	  volumes on disk backend, patches by Henrik Persson
	* AUTHORS: add Henrik Persson

Fri Jun 26 17:06:18 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/libvirt.c src/libvirt_private.syms src/logging.c
	  src/logging.h src/util.c src/libvirt_debug.syms: big cleanup of
	  the debug configuration option and code by Amy Griffis

Fri Jun 26 16:07:54 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/node_device.c src/node_device_hal.h src/node_device_hal_linux.c:
	  fix bogus WWN in NPIV support, patch by David Allan

Thu Jun 25 17:12:09 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/storage_conf.c: fix reading of storage pool definitions at startup
	  patch by Cole Robinson

Thu Jun 25 16:57:40 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/uml_driver.c: fix UML driver logging macros, patch by Amy
	  Griffis
	* AUTHORS: adding Amy Griffis

Thu Jun 25 16:50:54 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/node_device_conf.c: fix a leak, patch by Dave Allan

Thu Jun 25 15:46:11 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: fix a domain state problem after
	  migration, patch  by Federico Simoncelli, fixes #507537
	* src/domain_conf.c:  fix a transcient domain state problem after
	  destroy, patch  by Federico Simoncelli, fixes #507304
	* AUTHORS: add Federico Simoncelli and Javier Fontan

Thu Jun 25 10:32:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix broken dominfo command when no security driver is implemented
	* src/libvirt.c: Clarify semantics of return value for
	virDomainGetSecurityLabel and virNodeGetSecurityModel
	* src/remote_internal.c src/qemu_driver.c: memset seclabel
	to zero
	* src/virsh.c: Check VIR_ERR_NO_SUPPORT when querying security
	labels in dominfo command.

Wed Jun 24 19:40:43 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: update a lot of translations, and regenerate the po* files

Wed Jun 24 19:28:16 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in src/Makefile.am
	  src/opennebula/one_client.[ch] src/opennebula/one_conf.h
	  src/opennebula/one_driver.[ch] : Finish the integration of OpenNebula,
	  avoid dependancy on OpenNebula libraries, require xmlrpc-c-devel
	  and build it by default, based on patch by Javier Fontan and DanB
	  suggestions

Wed Jun 24 18:15:56 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/opennebula/one_conf.c src/opennebula/one_driver.c: fix One
	  driver compilation issues, patch by Javier Fontan and remove
	  some tabs in format strings

Mon Jun 22 12:40:11 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/libvirt_private.syms src/storage_conf.c src/storage_conf.h
	src/storage_driver.c src/test.c:
	Refactor storage XML parsing to be consistent with domain/network conf.

Mon Jun 22 12:38:19 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Activate virtual networks initialized in custom test driver.

Mon Jun 22 12:35:34 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/util.c: Fix segfault if storage pool has no type attribute
	(possibly others)

Mon Jun 22 12:33:37 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Fix memory reporting for inactive domains
	in the qemu driver.

Mon Jun 22 12:31:38 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_fs.c src/storage_driver.c:
	Fix raw storage volume creation for allocation < capacity.

Mon Jun 22 11:09:18 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Fix domain ID after redefining a running VM

Mon Jun 22 12:27:39 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/conf.[ch]: restrict VMX syntax parsing types, patch by Matthias
	  Bolte

Mon Jun 22 12:14:48 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/storage_driver.c: cleanup when creating a storage pool fails,
	  patch by Henrik Persson

Fri Jun 19 14:32:41 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c src/conf.c src/conf.h src/qemu_conf.c src/xen_unified.c
	  src/xm_internal.c tests/conftest.c tests/xmconfigtest.c: extend
	  the configuration parser for VMX syntax, patch by Matthias Bolte

Thu Jun 18 14:56:24 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix socket path for remote SSH
	tunnels to honour read-only flag

Wed Jun 17 10:31:35 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/node_device.[ch] src/storage_backend.[ch]: fixes a
	  module dependency problem, patch by Dave Allan

Tue Jun 16 14:30:05 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c
	tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-product.args
	tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-product.xml:
	Allow USB hostdev product to be 0x0000

Tue Jun 16 11:43:17 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_fs.c: Fix FS volume creation with backing stores.

Tue Jun 16 11:33:54 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/libvirt_private.syms
	src/lxc_driver.c src/qemu_conf.c src/qemu_driver.c:
	Set default emulator in domain_conf.*, rather than the driver.

Tue Jun 16 11:18:00 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/capabilities.c src/capabilities.h src/libvirt_private.syms
	src/lxc_conf.c src/qemu_conf.c: Add virCapabilities*EmulatorRequired.

Tue Jun 16 11:16:17 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_conf.c src/qemu_conf.h tests/qemuhelptest.c
	tests/qemuxml2argvtest.c:   Check that '-drive format=' is supported

Tue Jun 16 10:04:32 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* tests/.cvsignore tests/.hgignore tests/.gitignore:
	Add qemuhelptest to .*ignore files

Tue Jun 16 10:00:50 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_conf.c: Fix qemu command flags fetching

Tue Jun 16 10:30:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c: Add new variant of availheap sysctl
	for ABI changes in Xen

Mon Jun 15 18:15:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix build on non-Linux targets
	* src/nodeinfo.c: s/nodeError/nodeReportError/

Mon Jun 15 15:58:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix build from tar.gz
	* src/Makefile.am: Add missing node_device_hal.h to list of
	distributed files

Mon Jun 15 12:05:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: Fix bogus initialization in virFindFileInPath

Fri Jun 12 14:16:42 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Remove use of getuid()==0 for privilege checks
	* qemud/qemud.c, qemud/qemud.h, src/driver.h, src/libvirt.c,
	src/libvirt_internal.h, src/lxc_driver.c, src/network_driver.c,
	src/node_device_devkit.c, src/node_device_hal.c,
	src/qemu_conf.h, src/qemu_driver.c, src/remote_internal.c,
	src/storage_driver.c, src/uml_conf.h, src/uml_driver.c,
	src/xen_internal.c, src/xen_unified.c: Remove all use of
	getuid()/geteuid() to determine if privileged. Replace with
	'privileged' flag provided by libvirtd, or direct access
	checks.

Fri Jun 12 13:36:42 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Include OS driver name (if any) in device XML
	* src/node_device.c: Refresh OS driver when generating XML,
	and include impl for Linux sysfs
	* src/noe_device_conf.c, src/node_device_conf.h: Add field
	for OS driver name to config
	* src/node_device_hal.c: Record sysfs path to be used for
	driver name fetching later.

Fri Jun 12 13:06:42 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Improve error reporting for virConnectOpen URIs
	* src/lxc_driver.c, src/openvz_driver.c, src/qemu_driver.c,
	src/uml_driver.c, src/xen_unified.c: Always return ACCEPT
	or ERROR for URIs without hostname set, but with the driver's
	matching URI scheme. ie never decline a correct URI
	* src/xend_internal.c: Default port to 8000 if not given
	in the http:// URI.
	* src/remote_internal.c: Accept all URIs not handled by an
	earlier driver.
	* src/virterror.c: Improve error message text for
	VIR_ERR_NO_CONNECT code

Fri Jun 12 12:26:42 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix re-detection of transient VMs after libvirtd restart
	* src/domain_conf.c, src/domain_conf.h, src/libvirt_private.syms:
	Extend virDomainLoadAllConfigs to allow for loading of live
	state info from XML files. Add APIs to format/parse state info
	from virDomainObjPtr to XML.
	* src/lxc_driver.c, src/uml_driver.c: Adapt for API change in
	virDomainLoadAllConfigs.
	* src/qemu_driver.c, src/qemu_conf.c, src/qemu_conf.h: Remove
	all code for loading live state files, and use standard APIs
	from domain_conf.h.
	* src/security.h, src/security_selinux.c: Add API for reserving
	an existing in-use MCS context from a running VM detected at
	daemon startup.

Thu Jun 11 17:33:43 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/remote.c: fixing a typo pointed out by Runa Bhattacharjee

Thu Jun 11 16:22:22 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/node_device_hal.c src/node_device_conf.[ch]: add support
	  for serial number in HAL storage backend, patch by Dave Allan
	* docs/schemas/nodedev.rng,
	tests/nodedevschemadata/storage_serial_3600c0ff000d7a2a5d463ff4902000000.xml:
	  update the schemas and add a test case, also by Dave Allan

Thu Jun 11 15:18:44 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_conf.[ch]: make qemuParseHelpStr() available
	to tests

	* tests/qemuhelptest.c, tests/qemuhelpdata/*: add tests
	for 'qemu -help' parsing.

Thu Jun 11 15:17:12 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_conf.c: detect newer qemu-kvm versions

Thu Jun 11 15:15:02 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_conf.c: re-factor qemu version parsing.

Thu Jun 11 15:14:37 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in src/libvirt_private.syms src/storage_backend_fs.c
	  src/util.c src/util.h: find and use kvm-img, qemu-img or qcow-create
	  dynamically at runtime, patch by Doug Goldstein
	* AUTHORS: add Doug Goldstein

Tue Jun  9 15:21:17 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/formatdomain.html docs/formatdomain.html.in: typo fix
	  by Garry Dolley

Tue Jun  9 12:39:24 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	API extension docs (Dave Allen)
	* docs/internals.html.in, docs/api_extension.html.in,
	docs/sitemap.html.in: Start new section on libvirt internal
	development & add doc about public API extensions
	* docs/api_extension/*patch: Example patch files
	* docs/*.html: Re-generate for updated sitemap

Thu Jun  4 15:54:24 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/xm_internals.c: the memory shrinking on device removal
	  didn't copy the right amount of memory, patch by Daniel Berrange
	  fixes #497051

Wed Jun  3 15:32:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/vbox/vbox_tmpl.c: Add NUMA memory APIs

Wed Jun  3 15:44:55 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/network_driver.c: forbid set Autostart on transcient networks

Wed Jun  3 14:30:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/vbox/vbox_tmpl.c: Switch to positional struct initializers
	instead of named initializes, to match preferred style

Wed Jun  3 14:29:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_driver.c: Implement capabilities and nodeinfo APIs

Wed Jun  3 14:28:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Generic shared impls of all NUMA apis
	* src/libvirt_private.syms: Add all nodeinfo.c APIs
	* src/lxc_conf.c, src/openvz_conf, src/qemu_conf.c,
	src/vbox/vbox_tmpl.c, src/uml_conf.c: Update for
	changed API names in nodeinfo.h
	* src/nodeinfo.c, src/nodeinfo.h: Add generic impls of
	the virNodeGetCellsFreeMemory & virNodeGetFreeMemory APis
	* src/openvz_driver.c: Use nodeGetInfo() directly in driver
	* src/qemu_driver.c, src/uml_driver.c: Remove NUMA APis impls
	in favour of generic impl in nodeinfo.c

Wed Jun  3 14:12:47 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/virsh.c: various typo or english fixups
	  raised by Runa Bhattacharjee

Wed Jun  3 12:19:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix HAL driver restart thread safety
	* src/node_device_hal.c: Only clear & recreate device objects,
	not entire driver struct.
	* src/node_device.c: Remove overly verbose logging of mutex
	operations.

Wed Jun  3 12:03:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Support networking in UML driver
	* src/bridge.c: Add new brDeleteTap function. Allow brAddTap
	to create a persistent tap devices.
	* src/bridge.h, src/libvirt_bridge.syms: Add brDeleteTap
	* src/domain_conf.c: Fix missing 'break' in network XML formatter
	* src/uml_conf.c, src/uml_conf.h, src/uml_driver.c: Add support
	for bridge, network, mcast and user mode network interfaces

Wed Jun  3 11:53:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc User Mode Linux startup/shutdown bugs
	* src/util.c: Make virKillProcess refuse to kill PID==1 too
	* src/uml_driver.c: Increment retries counter when starting
	guest. Check for monitor command failure. Use unique source
	socket per domain for talking to monitor.  Use virKillProcess
	for killing guests. Fix guest cleanup when getting inotify

Wed Jun  3 11:32:52 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Honour LIBVIRT_LOG_FILTERS/OUTPUTS env variables
	when initializing logging.

Tue Jun  2 17:05:52 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/node_device.[ch] src/node_device_conf.[ch]
	  src/node_device_hal.[ch] src/node_device_hal_linux.c
	  src/qemu_driver.c src/remote_internal.c src/storage_backend.c
	  src/virsh.c src/xen_unified.c tests/nodedevxml2xmltest.c
	  po/POTFILES.in: implementation for node device create and destroy
	  in NPIV support, patch by David Allan

Fri May 29 18:37:17 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in NEWS docs/* po/*: release of
	  libvirt-0.6.4
	* src/libvirt.c src/virterror.c: some comments cleanups

Fri May 29 15:34:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Set free'd variables to NULL to avoid potential
	double-free() scenario when client unexpectedly closes connection

Fri May 29 15:26:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Win32 portability fixes
	* docs/libvirt-api.xml, docs/libvirt-refs.xml,
	docs/devhelp/libvirt-libvirt.html, docs/devhelp/libvirt-virterror.html,
	docs/html/libvirt-libvirt.html, docs/html/libvirt-virterror.html:
	Regenerate docs from new API docs
	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	qemud/remote.c, qemud/remote_protocol.c, qemud/remote_protocol.h,
	qemud/remote_protocol.x, src/datatypes.c, src/datatypes.h,
	src/driver.h, src/libvirt.c, src/remote_internal.c: Change
	all variable and field names from 'interface' to 'iface' to
	avoid clash with Win32 COM object name
	* tests/testutils.c: Disable regex code if not avaialble
	* qemud/Makefile.am: Fix BUILT_SOURCES on non-libvirtd builds

Fri May 29 16:25:32 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/lxc_container.c: fix a portability issue if PR_CAPBSET_DROP
	  not defined.

Fri May 29 10:16:13 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/network_driver.c src/network_conf.c src/network_conf.h:
	Fix regression defining colliding networks at daemon startup.

Fri May 29 10:13:55 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/network_driver.c: networkDestroy: Report error if network
	is inactive

Fri May 29 10:10:00 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: qemu_driver: Fix another domain startup error
	reporting race.

Fri May 29 10:01:19 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c : qemuDomainLookupByUUID: print correct UUID
	string on failed lookup.

Fri May 29 10:00:01 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/virsh.c : virsh: Use consistent spacing for net-list

Fri May 29 15:29:32 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c docs/schemas/domain.rng
	  tests/capabilityschemadata/caps-qemu-kvm.xml: PPC Qemu Machine Type
	  changed from g3bw to g3beige some time ago, patch by Thomas Baker

Fri May 29 14:26:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix regression with network interface parsing
	* src/domain_conf.c: Add missing 'break' statement in network
	parser

Fri May 29 14:26:10 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/schemas/storagevol.rng docs/formatstorage.html[.in]
	  tests/storagevolschemadata/vol-qcow2.xml: fix storage volume
	  inconsistencies in schema and document, patch by Ryota Ozaki

Fri May 29 14:07:13 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: update of many localizations, regenerate the po

Thu May 28 14:20:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix misc bugs in ARGV -> XML convertor
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Fill
	in autogenerated MAC adress and UUID when converting ARGV
	into XML. Avoid crash if net device vlan isn't specified.
	Cope with quoting of argument values
	* tests/qemuargv2xmltest.c: Initialize random number generator
	and pass in capabilities when parsing ARGV

Thu May 28 14:13:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Avoid broken networking with new QEMU/KVM >= 86
	* src/qemu_conf.c: Remove ifname= and script= args to QEMU
	when passing a TAP device file handle.

Thu May 28 14:11:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix misc syntax check failures with OpenNebula driver
	* src/opennebula/one_conf.c, src/opennebula/one_conf.h,
	src/opennebula/one_driver.c, src/opennebula/one_driver.h: Kill
	trailing whitespace, automatic re-indent of all code, added
	missing translation marking
	* Makefile.maint: Add oneError() as a function with translatable
	strings.
	* po/POTFILES.in: Add one_conf.c, one_driver.c

Thu May 28 13:27:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/logging.c: Include function name & line number in all
	logging levels.

Thu May 28 12:00:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix python domain events example & binding.
	* examples/domain-events/events-python/event-test.py: Fix
	broken handling of timers
	* python/libvir.c: Take reference on virDomainPtr object
	before wrapping it to avoid double-free.

Tue May 26 13:09:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix error location logging
	* src/virterror.c, src/virterror_internal.h: Re-factor error
	reporting APIs to ensure correct source location info is
	passed through to eventual virLogMessage call.

Tue May 26 11:25:30 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am: Add ocaml intermediate files to CLEANFILES

Mon May 25 13:52:30 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/opennebula/one_conf.[ch] src/opennebula/one_driver.[ch]:
	  the OpenNebula driver
	* configure.in include/libvirt/virterror.h qemud/Makefile.am
	  qemud/qemud.c src/Makefile.am src/domain_conf.[ch] src/driver.h
	  src/libvirt.c src/virterror.c: integration of the OpenNebula
	  driver in the libvirt infrastructure
	* AUTHORS: add Abel Miguez Rodriguez

Mon May 25 11:42:15 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* examples/domain-events/events-c/event-test.c: fixed the example
	  code for event handling, patch by Pritesh Kothari

Thu May 21 15:22:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Test case for QEMU driver ARGV -> XML conversion
	* tests/qemuargv2xmltest.c: Add test case for ARGV -> XML
	conversion in QEMU driver
	* tests/qemuxml2argvdata/qemuxml2argv-bootloader.args,
	tests/qemuxml2argvdata/qemuxml2argv-bootloader.xml: Fix QEMU
	binary to be xenner, not qemu-kvm
	* tests/qemuxml2argvdata/qemuxml2argv-disk-cdrom-empty.xml: Remove
	trailing blank line
	* tests/qemuxml2argvdata/qemuxml2argv-hostdev-pci-address.xml:
	Switch to unmanaged PCI device for tests
	* tests/testutils.c, tests/testutils.h: Add API for stripping
	lines matching a pattern.
	* .hgignore, tests/.cvsignore, tests/.gitignore: Ignore new
	test case binary

Thu May 21 15:20:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* docs/drvqemu.html[.in], docs/drvxen.html[.in]: Add docs on
	use of new domain XML conversions

Thu May 21 15:16:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c, src/qemu_conf.c, src/qemu_conf.h: Add new
	APIs for converting from QEMU argv into domain XML, and use for
	domain XML conversion APIs.

Thu May 21 15:15:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.h, src/vbox/vbox_tmp.c: Fix typo s/ES97/AC97/

Thu May 21 14:59:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Basic domain XML conversions
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Wire up
	API for conversion from XML to native argv
	* src/xen_unified.c, src/xen_unified.h: Wire up API for domain
	XML conversions to & from native

Thu May 21 14:48:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Remote protocol support for domain XML conversion APIs
	* qemud/remote.c: Handlers for new RPC messages
	* qemud/remote_dispatch_*.h, qemud/remote_protocol.c,
	qemud/remote_protocol.h: Re-generate for new RPC calls
	* qemud/remote_protocol.x: Add domain XML conversion APIs
	* src/remote_internal.c: Client for domain XML conversion
	APIs


Thu May 21 14:32:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Public APIs for domain XML conversions.
	* docs/devhelp/libvirt-libvirt.html, docs/devhelp/libvirt-virterror.html,
	docs/html/libvirt-libvirt.html, docs/html/libvirt-virterror.html,
	docs/libvirt-api.xml, docs/libvirt-refs.xml: Regenerate with new public
	APIs
	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	src/driver.h, src/libvirt.c, src/libvirt_public.syms: Add
	virConnectDomainXMLFromNative and virConnectDomainXMLToNative
	* src/lxc_driver.c, src/openvz_driver.c, src/qemu_driver.c,
	src/remote_internal.c, src/test.c, src/uml_driver.c,
	src/xen_unified.c: Stub out new API entry points
	* src/virsh.c: Add domxml-to-native and domxml-from-native commands

Thu May 21 11:52:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py, python/libvirt_wrap.h, python/types.c: Add
	rules for generating virInterface APIs in python

Thu May 21 10:01:43 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/formatstorage.html[.in]: fix a error in format type example
	  pointed out by Ryota Ozaki

Wed May 20 16:23:10 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in include/libvirt/libvirt.h[.in]
	  include/libvirt/virterror.h qemud/remote.c
	  qemud/remote_dispatch_args.h qemud/remote_dispatch_prototypes.h
	  qemud/remote_dispatch_ret.h qemud/remote_dispatch_table.h
	  qemud/remote_protocol.[chx] src/Makefile.am src/datatypes.c
	  src/datatypes.h src/driver.h src/libvirt.c src/remote_internal.c
	  src/virterror.c src/libvirt_private.syms src/libvirt_public.syms:
	  Add the Interface config APIs and remote stubs for those, patch
	  by Laine Stump
	* AUTHORS: add Laine

Wed May 20 15:35:35 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c src/console.c src/network_driver.c
	  src/node_device_conf.c src/node_device_hal.c src/storage_conf.c
	  src/util.c: cleanup of some direct stderr logging

Wed May 20 15:33:27 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/pci.c: small portability patch

Wed May 20 09:10:28 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/lxc_driver.c: fix a couple of error code, patch by
	  Amy Griffis

Tue May 19 09:39:01 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_fs.c: VolumeCreateXMLFrom FS storage
	backend implementation.

Tue May 19 09:36:48 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend.h src/storage_driver.c: Storage driver
	implementation for CreateXMLFrom

Tue May 19 09:26:53 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/node_device_hal.c: Fix node device media insert/eject
	detection.

Tue May 19 09:24:54 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/node_device_hal.c: Fix a possible deadlock in HAL nodedev
	driver.

Tue May 19 09:22:43 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* Makefile.am: Fix rpm build: add 'mylibtool' to EXTRADIST.

Tue May 19 09:20:54 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* qemud/Makefile.am: Generate some config files at build time.

Tue May 19 09:16:37 EDT 2009 Cole Robinson <crobinso@redhat.com>

	Add documentation for <sound> device XML format.
	* docs/formatdomain.html docs/formatdomain.html.in

Tue May 19 09:14:12 EDT 2009 Cole Robinson <crobinso@redhat.com>

	Use virAsprintf, rather than VIR_ALLOC + strcpy + strcat
	* qemud/remote.c src/remote_internal.c src/storage_backend.c
	  src/storage_backend_fs.c src/storage_backend_logical.c
	  src/test.c

Tue May 19 09:04:05 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/virsh.c: Don't validate disk type in virsh attach-disk

Tue May 19 09:00:43 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* python/libvir.py: Don't overwrite legitimate python import error.

Tue May 19 12:04:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix misc locking bugs identified by lock checker
	* src/test.c: Add missing driver lock calls in testOpen()
	* src/uml_driver.c: Remove bogus driver unlock call in
	umlDomainStart. Ensure driver lock is held for the duration
	of umlDomainSetAutostart.
	* src/network_driver.c: Ensure driver lock is held for the
	duration of networkStart, networkDestroy and networkSetAutostart
	* src/storage_driver.c: Ensure driver lock is held for the
	duration of storagePoolRefresh, and storagePoolSetAutostart.
	Ensure driver is locked before re-obtaining pool lock in
	storageVolumeCreateXML.
	* src/qemu_driver.c: Ensure lock is held when removing domain
	event callbacks in qemudClose(). Drop driver lock before calling
	qemudAutostartConfigs, since that will obtain a lock when calling
	virConnectClose. Hold lock across duration of suspend, resume,
	start, get security label, device attach and device detach
	operations.

Tue May 19 11:10:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Add an optional OCaml+CIL mutex lock checker
	* .hgignore, src/.cvsignore, src/.gitignore, tests/.gitignore,
	tests/.cvsignore: Ignore binary files from ocaml build. Ignore
	.i and .s files from gcc -save-temps
	* configure.in: Add --enable-test-locking arg to turn on build
	of OCaml/CIL mutex locking test
	* src/Makefile.am: Add $(LOCK_CHECKING_CFLAGS) used when lock
	checking tests are enabled.
	* tests/Makefile.am, tests/object-locking.ml: Add OCaml/CIL
	program for validating mutex locking correctness

Mon May 18 16:10:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Declare support for migration in capabilities

Fri May 15 15:59:08 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/vbox/vbox_driver.c src/vbox/vbox_tmpl.c: last patch for
	  hostonly networks support in vbox driver, patch by Pritesh Kothari

Fri May 15 15:44:01 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/vbox/vbox_tmpl.c: implement vbox vrdp/sdl/gui support,
	  patches by Pritesh Kothari

Fri May 15 11:41:46 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/schemas/domain.rng src/domain_conf.[ch] src/qemu_driver.c:
	  extend the generic code for the RDP and desktop extensions of
	  the graphic tag needed for vbox, patch by Pritesh Kothari

Thu May 14 12:29:41 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: remove [] around cpumaps for recent xend
	  patch by Tatsuro Enokura

Wed May 13 13:37:02 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/virsh.c: Fix a few 'used uninitialized' warnings.

Wed May 13 18:06:17 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/buf.c: avoid an XML attribute escaping bug #499791

Wed May 13 12:34:06 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_container.c: Replace sys/capability.h with
	linux/capability.h, to avoid unneccessary dependancy
	on the libcap package.

Tue May 12 16:39:06 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* tests/eventtest.c: Use safewrite instead of write
	* po/POTFILES.in: Add src/vbox/vbox_driver.c

Tue May 12 16:25:59 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_fs.c: Break out FS volume build routines to
	their own functions.

Tue May 12 16:16:09 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/virsh.c: Virsh commands vol-clone and vol-create-from

Tue May 12 16:14:43 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Test driver implementation of
	virStorageVolCreateXMLFrom

Tue May 12 16:11:14 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* qemud/remote.c qemud/remote_dispatch_args.h
	  qemud/remote_dispatch_prototypes.h qemud/remote_distpatch_ret.h
	  qemud/remote_dispatch_table.h qemud/remote_protocol.c
	  qemud/remote_protocol.h qemud/remote_protocol.x
	  src/remote_internal.c:
	  Remote support for virStorageVolCreateXMLFrom

Tue May 12 16:00:49 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.c
	  src/driver.h src/libvirt.c src/libvirt_public.syms:
	  Public API definition for virStorageVolCreateXMLFrom
	* docs/devhelp/libvirt-libvirt.html
	  docs/devhelp/libvirt-virterror.html
	  docs/html/libvirt-libvirt.html docs/html/libvirt-virterror.html
	  docs/libvirt-api.xml docs/libvirt-refs.xml:
	  Regenerate API documentation.

Tue May 12 15:58:28 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend.c: Document a function
	* src/storage_backend_fs.c: Don't squash file probe errors.

Tue May 12 17:45:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* .hgignore, tests/.cvsignore, tests/.gitignore: Ignore
	new eventtest binary.
	* tests/Makefile.am, tests/eventtest.c, tests/testutils.h: Add
	test case for exercising the event loop

Tue May 12 17:43:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix watch/timer event deletion
	* qemud/event.c: Change handling of deleted watches/timers
	to ensure correct dispatch of callbacks when deleted flag
	is set

Tue May 12 17:42:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/event.c: Start watch/timer IDs from 1 to avoid problem
	with accidental uninitialized variables at 0. Fix interrupting
	of main thread when updating/deleting watches/timers.

Tue May 12 16:38:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c, qemud/qemud.h, qemud/event.c: Remove use
	of qemudSetNonBock/SetCloseExec in favour of virSetNonBlock
	and virSetCloseExec.

Tue May 12 16:38:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Allow for quieter build with 'make -s'
	* configure.in: Use 'mylibtool' wrapper around 'libtool'
	* mylibtool: Quiet version of libtool just printing build
	target name without flags.

Tue May 12 16:35:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Improve driver open URI handling
	* src/vbox/vbox_driver.c: Register dummy no-op driver if
	the virtualbox libraries are not avialable
	* src/vbox/vbox_tmpl.c: Return fatal error if open fails
	for a URI we expect to handle

Tue May 12 17:25:52 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/network_driver.c: enable bridges which are not up, i.e.
	  without an IP address, patch by Ludwig Nussel

Mon May 11 16:25:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/datatypes.c: Change hash destructors to call the internal
	virUnrefXXX methods instead of public virXXXFree methods (Laine
	Stump)

Mon May 11 16:25:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_container.c: Fix unused variable warning

Mon May 11 16:15:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix QEMU ARGV detection with kvm >= 85
	* src/qemu_conf.c: Increase limit on QEMU -help output size.
	Improve error reporting when handling help output
	* src/qemu_driver.c: Don't overwrite errors when extracting
	QEMU versio ninfo

Mon May 11 15:55:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Report detailed error if initial connection open
	attempt fails

Mon May 11 16:03:37 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/lxc_container.c: drop LXC CAP_SYS_BOOT capability to avoid
	  reboot from inside containers, patch by Ryota Ozaki

Mon May 11 09:51:00 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c : Check that QEMU is still alive while
	reading startup output.

Mon May 11 09:44:40 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/util.[ch] : Add pidfile argument to __virExec
	* src/proxy_internal.c src/qemu_driver.c src/uml_driver.c
	src/remote_driver.c: Adjust virExecDaemonize calls accordingly.
	* src/qemu_conf.c : No longer pass -pidfile argument to qemu
	* tests/qemuxml2argvdata/*.args : Remove qemu -pidfile argument.

Mon May 11 09:35:26 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Report qemu log data if we fail to daemonize.

Mon May 11 09:29:52 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/libvirt_private.syms src/util.[ch]: Add a helper function
	virExecDaemonize
	* src/proxy_internal.c src/qemu_driver.c src/uml_driver.c
	src/remote_driver.c: Use the new helper.

Mon May 11 11:54:53 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/vbox/vbox_tmpl.c: "Host only" and "Internal" network support
	  for vbox, patch by Pritesh Kothari

Mon May 11 11:47:51 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.[ch] docs/schemas/domain.rng: add support
	  for internal network in the generic part of the code, and
	  update the Relax-NG grammar accordingly, patch by Pritesh Kothari

Fri May  8 11:24:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/cgroup.c: Create cgroups mode 755, not 655 (Ryota Ozaki)

Fri May  8 11:22:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix /dev/ population to use char devices (Ryota Ozaki)
	* src/lxc_controller.c: Add /dev/ptmx to allow cgroup resources
	* src/lxc_container.c: Create dev nodes as char devices, not
	plain files

Fri May  8 12:15:05 CEST 2009 Guido Günther <agx@sigxcpu.org>

	* src/vbox/vbox_tmpl.c (virDrvOpen): return VIR_DRV_OPEN_DECLINED
	  instead of VIR_DRV_OPEN_ERROR when vbox can't be found so other
	  hypervisors can be probed. Patch by Pritesh Kothari.

Fri May  8 12:09:12 CEST 2009 Guido Günther <agx@sigxcpu.org>

	* src/vbox/vbox_tmpl.c (vboxUninitialize): fix crash when init fails
	  early (i.e. due to vbox not being installed)

Fri May  8 11:10:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Make name & UUID uniqueness checking in
	define, create & restore functions more robust. Throw error
	in destory operation, if guest isn't running

Fri May  8 11:07:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Enable migrate/save/restore for QEMU
	0.10.0 or later releases

Fri May  8 11:05:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/driver.c: Log dlopen related errors at higher log level
	so important messages are visible by default

Fri May  8 10:56:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* include/libvirt/virterror.h, src/virterror.c: Add new error
	code VIR_ERR_OPERATION_INVALID for operations that are not
	applicable at this time (eg, pause on an inactive guest)
	* src/qemu_driver.c, src/xen_internal.c, src/xend_internal.c:
	Use new error code where relevant.

Thu May  7 09:31:22 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/libvirtd.init.in: improve the LSB init header for the
	  init.d file, patch by Frederik Himpe

Thu May  7 09:26:50 CEST 2009 Guido Günther <agx@sigxcpu.org>

	* src/util.c (virFileWritePid): check for NULL pointers
	  to avoid bogus pid files
	  (virFileReadPid): likewise
	  (virFileDeletePid): likewise

Thu May  7 09:24:47 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c src/domain_conf.h: parse and save multiple
	  graphics elements instead of one, patch by Pritesh Kothari
	* src/qemu_conf.c src/qemu_driver.c: adapt the qemu/kvm driver for
	  the new structures, patch by Pritesh Kothari
	* src/xend_internal.c src/xm_internal.c: same thing for Xen drivers

Thu May  7 09:16:05 CEST 2009 Guido Günther <agx@sigxcpu.org>

	* src/lxc_controller.c (main): don't crash when called without
	arguments

Wed May  6 16:55:02 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_driver.c: fix handling of <hostdev managed='yes'>

Wed May  6 10:19:36 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c : Refresh QEMU driver capabilities for each
	getCapabilities call.

Wed May  6 15:42:08 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/vbox/vbox_driver.c src/vbox/vbox_tmpl.c: changes in
	  VirtualBox driver version detection and move informations
	  from a global variable into a driver structure, patch by Pritesh
	  Kothari.

Wed May  6 15:27:04 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: add a couple of missing directories

Wed May  6 15:22:08 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/vbox/vbox_XPCOMCGlue.[ch]: improve VirtualBox path detection
	  patch by Pritesh Kothari

Tue May  5 10:20:27 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Don't throw away StartVM errors when
	migrating/restoring in qemu driver.

Tue May  5 10:19:14 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Small cleanups in test driver VolCreateXML

Tue May  5 10:18:15 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_driver.c: Remove some debug code from storage_driver.c

Tue May  5 10:16:56 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/libvirt.c: Use proper error code in virStorageVolCreateXML

Mon May  4 11:44:09 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_fs.c: Fix a comment typo in storage_backend_fs.c

Mon May  4 11:42:01 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/util.c: virExec: Delay daemonizing as long as possible.

Mon May  4 11:40:27 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/util.c: Add some documentation to __virExec and virExec

Tue Apr 28 11:54:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix check for -Wformat-security which depends on -Wformat
	* m4/compiler-flags.m4: Set previously verified compiler flags
	when checking new flags
	* srv/virsh.c: Fix three non-critical format string bugs

Fri Apr 24 15:55:56 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in libvirt.spec.in docs/*: release of 0.6.3
	* po/*: regenerated
	* src/libvirt.c src/virterror.c: fixed some function comments

Fri Apr 24 14:07:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Add virNodeDeviceCreateXML / virNodeDeviceDestroy boilerplate
	public API and remote protocol impl
	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	 src/libvirt_public.syms: Public API definition of new
	virNodeDeviceCreateXML and virNodeDeviceDestroy methods
	* qemud/remote.c: Dispatch code for new APIs
	* qemud/remote_dispatch_args.h, qemud/remote_dispatch_prototypes.h,
	qemud/remote_dispatch_ret.h, qemud/remote_dispatch_table.h:
	Re-generate stubs for dispatcher
	* qemud/remote_protocol.x: Define wire protocol for node
	device create / destroy APIs
	* qemud/remote_protocol.c, qemud/remote_protocol.h:
	Re-generate based off protocol additions
	* src/driver.h: Define internal driver API contract for
	new public APIs
	* src/libvirt.c: Wire up public API to driver API for
	virNodeDeviceCreateXML/virNodeDeviceDestroy
	* src/remote_internal.c: Client for new node device methods

Fri Apr 24 13:19:47 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_private.syms: Add virDomainHostdevDefFree needed
	by Xen driver when built as a module.

Fri Apr 24 13:17:47 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix network config in XM driver
	* src/xm_internal.c: Fix setting of bridge & script parameters
	in VIF config
	* src/xend_internal.h, src/xend_internal.c: Export the
	default bridge script name to XM driver
	* tests/xmconfigdata/*: Update to take account of script=
	setting in VIF config

Fri Apr 24 12:06:47 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: updated a could of locale, regenerated
	* docs/libvirt-api.xml docs/libvirt-refs.xml: regenerated too

Wed Apr 22 15:28:03 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/network_driver.c: Explicit check for NULL, to avoid
	compiler complaining about "assignment treated as truth value
	in conditional".

Wed Apr 22 15:27:03 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Use private /dev/pts instance for containers (needs 'newinstance'
	mount flag for devpts since 2.6.29 kernels), fallback to shared
	instance if not supported
	* src/domain_conf.h, src/domain_conf.c: Add a convenient
	routine virDomainGetRootFilesystem()
	* src/libvirt_private.sym: export virDomainGetRootFilesystem
	to drivers
	* src/util.c, src/util.h: Add virFileOpenTtyAt() to allow
	alternate path to /dev/ptmx to be given
	* src/lxc_controller.c: Attempt to setup a private /dev/pts
	instance for the container's stdio I/O
	* src/lxc_container.h, src/lxc_container.c: Pull in the
	private /dev/pts instance setup by controller, and create
	a symlink for /dev/ptmx.

Tue Apr 21 20:14:03 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Remove pidfile when domain shuts down and
	cleanup stale pidfile before domain startup.

Tue Apr 21 14:39:03 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* po/POTFILES.in: Add vbox_tmpl.c file
	* src/vbox/vbox_tmpl.c: Adjust domain IDs to start from 1
	instead of 0, refuse domain ID 0.

Tue Apr 21 20:58:50 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/network_conf.c src/network_conf.h: add dynamic bridge names
	  support, patch by Soren Hansen
	* AUTHORS: add Soren

Tue Apr 21 17:08:57 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: let xend try vcpu pinning operation even
	  if the domain is not running, patch by Takahashi Tomohiro

Tue Apr 21 15:38:29 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/drvvbox.html.in docs/drvvbox.html: tiny fixes to VirtualBox
	  docs

Tue Apr 21 14:22:03 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/drvvbox.html.in docs/hvsupport.html.in docs/drivers.html.in
	  docs/sitemap.html.in docs/*.html: VirtualBox Documentation by
	  Pritesh Kothari

Mon Apr 20 14:25:41 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/lxc_container.c src/lxc_container.h: cope with kernels
	  where CLONE_NEWUSER is not supported, patch by Serge Hallyn

Mon Apr 20 12:54:02 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* docs/virsh.pod, virsh.1: fix typo reported by Robert P. J. Day

Mon Apr 20 11:24:23 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: merge in a lot of localization updates and regenerate

Mon Apr 20 11:06:20 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/bridge.c: fix a compilation breakage raised by Anton Protopopov

Sun Apr 19 17:46:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* mingw32-libvirt.spec.in: Added new virt-xml-validate tool
	missed from previous commit

Sun Apr 19 17:36:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* autobuild.sh, mingw32-libvirt.spec.in: Disable vbox driver
	for Win32 builds

Sun Apr 19 17:36:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am: Add another vbox file to EXTRA_DIST

Sun Apr 19 16:49:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/virterror.c: Add missing 'break' in error code string
	formatter.

Sun Apr 19 16:29:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Improve error reporting for lookup failures on inactive domains
	* src/qemu_driver.c: Do all domain lookups based on UUID and
	use correct error code for missing domains.

Sun Apr 19 16:19:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix 2 domain ID handling bugs in remote driver
	* src/remote_internal.c: Add virDomainCreate(), do a lookup
	to find the ID of newly created domain. Reset ID to -1 after
	doing a destroy operation on a domain

Sun Apr 19 16:14:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Switch over todo domain lookup based
	on UUID in virDomainAssignDef

Sun Apr 19 16:14:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvirt-api.xml, docs/libvirt-refs.xml,
	docs/devhelp/libvirt-libvirt.html, docs/devhelp/libvirt-virterror.html,
	docs/html/libvirt-libvirt.html, docs/html/libvirt-virterror.html:
	Regenerate API docs to pull in latest VBox error code definitions

Sun Apr 19 16:12:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am: Add 2 missing vbox files to EXTRA_DIST

Sun Apr 19 16:00:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Add command line tool for validating XML and improve POD docs
	for virsh
	* Makefile.am, configure.in: Add tools/ sub-directory
	* docs/virsh.pod, docs/Makefile.am, virsh.1: Fix misc errors
	in POD formating, and improve licensing/copyright/bugs section
	* libvirt.spec.in: Add virt-xml-validate tool & man page
	* tools/virt-xml-validate.in, tools/Makefile.am: Add tool for
	validating XML files against schemas
	* .hgignore, tools/.gitignore, tools/.cvsignore, m4/.gitignore:
	Update to ignore more generated files

Sun Apr 19 15:44:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h: Pass in virDomainDefPtr to
	qemudBuildCommandLine, instead of virDomainObjPtr
	* src/qemu_driver.c, tests/qemuxml2argvtest.c: Update for above
	API change.

Fri Apr 17 21:10:28 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/libvirt_private.syms src/storage_backend.h
	  src/storage_backend_fs.c src/storage_conf.h src/storage_driver.c:
	  drop the pool lock when allocating fs volumes, patch by Cole Robinson

Fri Apr 17 18:05:52 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in include/libvirt/virterror.h src/Makefile.am
	  src/domain_conf.[ch] src/driver.h src/virterror.c src/vbox/README
	  src/vbox/vbox_CAPI_v2_2.h src/vbox/vbox_V2_2.c
	  src/vbox/vbox_XPCOMCGlue.[ch] src/vbox/vbox_driver.[ch]
	  src/vbox/vbox_tmpl.c: integration of the VirtualBox support
	  patches by Pritesh Kothari

Fri Apr 17 17:32:16 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: fix the doc of virNodeGetFreeMemory to say bytes
	* docs/drvlxc.html.in docs/drvlxc.html: fix command used in examples

Thu Apr 16 17:48:30 CEST 2009 Guido Günther <agx@sigxcpu.org>

	* src/qemu_driver.c (qemudMonitorCommandExtra): don't log monitor
	  output to domain log file. It's logged via the logging system
	  already.
	  (qemudDomainGetMemoryBalloon, qemudDomainSave,
	   qemudDomainChangeEjectableMedia, qemudDomainAttachPciDiskDevice,
	   qemudDomainAttachUsbMassstorageDevice, qemudDomainAttachHostDevice,
	   qemudDomainDetachPciDiskDevice, qemudDomainBlockStats,
	   qemudDomainMemoryPeek, qemudDomainMigratePerform): prefix monitor
	   debug output with vm name.

Thu Apr 16 16:48:51 CEST 2009 Guido Günther <agx@sigxcpu.org>

	* src/qemud.c (remoteReadConfigFile): don't hardcode buffer for
	  getgrnam_r to 1024 bytes and increase it on ERANGE.

Thu Apr 16 15:20:02 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_conf.c: pass "format=" to qemu -drive rather
	than "fmt="

	* tests/qemuxml2argvdata/*: fix test cases.

Thu Apr 16 14:05:28 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/lxc_container.c: syntax-check fixes

Wed Apr 15 22:40:50 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/Makefile.am docs/api.html docs/api.html.in docs/archdomain.html
	 docs/archnetwork.html docs/archnode.html docs/archstorage.html
	 docs/goals.html docs/intro.html
	 docs/libvirt-daemon-arch.fig docs/libvirt-daemon-arch.png
	 docs/libvirt-driver-arch.fig docs/libvirt-driver-arch.png
	 docs/libvirt-object-model.fig docs/libvirt-object-model.png
	 docs/page.xsl docs/sitemap.html docs/sitemap.html.in:
	 adding a new api page, extending the stylesheet to allow references
	 and including images from Dan Berrange

Wed Apr 15 22:08:12 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fix for virsh ttyconsole return value bug #495954

Wed Apr 15 21:59:09 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* drvlxc.html.in drvlxc.html: some examples from Serge Hallyn

Wed Apr 15 11:52:15 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c: fix a crash on vcpupin to inactive Xen domains,
	  as raised by Takahashi Tomohiro

Wed Apr 15 11:33:33 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/lxc_driver.c: adds the getHostname method to the lxc driver
	  patch by Dan Smith

Tue Apr 14 10:46:44 PDT 2009 Dan Smith <danms@us.ibm.com>

	* src/veth.c: Fix veth off-by-one error
	  patch by Serge Hallyn
	* src/lxc_container.c: Stop rootless containers from messing with
	  system mounts.  Also, make pivot_root code more robust.
	  patch by Serge Hallyn

Tue Apr 14 14:46:29 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: fix build on RHEL and Centos 5.x, patch
	  by Joseph Shraibman, fixes #495610

Tue Apr  7 14:48:35 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_scsi.[ch]: add SCSI storage rescan support,
	  patch by David Allan

Fri Apr  3 16:47:22 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in NEWS docs/*: release of 0.6.2
	* po/*: Gujarati and Polish updates, rebuild
	* AUTHORS: add one missing

Fri Apr  3 10:16:55 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend.c src/storage_backend_scsi.c:
	Don't lose file format info on volume refresh.

Fri Apr  3 10:15:01 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_driver.c: Refresh volume alloc/capacity when dumping XML.

Fri Apr  3 10:13:38 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Fix test driver domain restore return value.

Fri Apr  3 10:02:57 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend.c: Fix sparse volume allocation reporting.

Fri Apr  3 15:07:00 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix crash in svirt verification, and incorrect cleanup in
	VM failure paths.
	* src/domain_conf.c: Don't extract 'model' from seclabel unless
	requesting 'live' config, or if its a static label. Add missing
	error report
	* src/qemu_driver.c: Fix cleanup in auto-reconnect to running VMs.
	Fix cleanup of resources if starting a new VM fails
	* src/security.c: Fix crash if no seclabel model is defined in
	the virSecuriyDriverVerify method
	* src/security_selinux.c: Fix error message typo & fix whitespace

Fri Apr  3 15:03:00 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Add --console arg for create & start commands
	to auto-attach to console. Print info about escape key for
	console. Refuse to connect to remote consoles.

Fri Apr  3 13:41:00 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc NUMA memory fixes
	* qemud/remote.c: Fix check of error status in the helper
	remoteDispatchNodeGetCellsFreeMemory
	* src/qemu_driver.c: Report error if requested start cell
	is out of range. Fix return value if NUMA is not available
	* src/virsh.c: Convert memory to KB for freecell command.
	Check return value of virNodeGetFreeMemory

Fri Apr  3 11:55:00 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Support PCI passthrough in Xen driver
	* src/pci.c: Refactor to support Xen's pci-back.ko too
	* src/xen_unified.c: Implement node device reattach/detach
	reset APIs
	* src/xend_internal.c: Handle creation of VMs with PCI
	devices
	* src/xm_internal.c: serialization of PCI device config
	* tests/sexpr2xmltest.c, tests/xmconfigtest.c,
	tests/xml2sexprtest.c: Add tests for PCI devices
	* tests/sexpr2xmldata/sexpr2xml-pci-devs.sexpr,
	tests/sexpr2xmldata/sexpr2xml-pci-devs.xml,
	tests/xmconfigdata/test-pci-devs.cfg,
	tests/xmconfigdata/test-pci-devs.xml,
	tests/xml2sexprdata/xml2sexpr-pci-devs.sexpr,
	tests/xml2sexprdata/xml2sexpr-pci-devs.xml: Add data
	files for PCI testing


Fri Apr  3 11:55:00 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Improve error reporting/ verification of security labels
	(Dan Walsh)
	* src/domain_conf.c: Improve error reporting for parsing of
	seclabel XML
	* src/libvirt_private.syms: Export virSecurityDriverVerify
	* src/qemu_driver.c: Verify seclabel when creating or
	defining a new domain
	* src/security.c, src/security.h, src/security_linux.c: Add
	functions for verifying security labels
	* tests/.gitignore: Ignore seclabeltest
	* tests/Makefile.am, tests/seclabeltest.c: Add test for
	security driver

Thu Apr  2 19:41:00 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Mingw portability fixes
	* src/util.c: Fix virFileResolveLink for Win32 platform.
	Fix offset usage in safezero for mmap() and write() impls
	* configure.in: Add check for readlink()

Thu Apr  2 15:18:00 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/schemas/domain.rng: some missing disk bus values and cleanups

Thu Apr  2 14:00:14 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* docs/*: start cleanup/revamp of architecture docs

Thu Apr  2 11:52:59 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: updated brazilian, spanish, polish and simplified chinese
	  translations, and regenerated

Wed Apr  1 16:50:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	SCSI HBA storage pool implementation (Dave Allan)
	* configure.in: Add flag for SCSI storage pool support
	* po/POTFILES.in: Add storage_backend_scsi.c
	* src/Makefile.am: Add new SCSI storage backend
	* src/storage_backend.c: Support for SCSI pool type
	* src/storage_backend_iscsi.c: Refactor to re-use logic from
	SCSI pool backend
	* src/storage_backend_scsi.c, src/storage_backend_scsi.h:
	Generic pool for Linux SCSI HBAs (or things which look
	like SCSI HBAs)
	* src/storage_conf.c, src/storage_conf.h: Add logic for
	SCSI storage pool XML parsing options

Wed Apr  1 11:40:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Check for libsasl.so as well as libsasl2.so
	since former is used on some OS platforms that aren't Linux

Wed Apr  1 11:38:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: Clear internal reference to underlying
	virConnectPtr object after calling virConnectClose()

Wed Apr  1 11:37:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: Fix generation of networkCreateXML
	and storagePoolCreateXML to avoid clash with createXML()
	method

Wed Apr  1 11:36:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix localtime handling for new XenD
	* src/xend_internal.c: Update SEXPR for new location of
	(localtime 1) field.
	* src/xm_internal.c: Read localtime=1 param for PV guests
	too
	* tests/xml2sexprtest.c, tests/sexpr2xmltest.c: Add testing
	of new (localtime 1) handling
	* tests/sexpr2xmldata/sexpr2xml-pv-localtime.sexpr,
	tests/sexpr2xmldata/sexpr2xml-pv-localtime.xml,
	tests/xml2sexprdata/xml2sexpr-fv-localtime.sexpr,
	tests/xml2sexprdata/xml2sexpr-pv-localtime.sexpr,
	tests/xml2sexprdata/xml2sexpr-pv-localtime.xml: Data files
	for extended tests

Wed Apr  1 11:27:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc fixes uncovered from OOM testing
	* src/datatypes.c: Switch to virReportErrorHelper for error
	reporting, so source line/file/function info is correct
	* src/domain_conf.c: Check for failure in virXPathNodeSet()
	* src/noeinfo.c: Translate error strings
	* src/xend_internal.c: Check for OOM failure after generating
	SEXPR buffer
	* tests/sexpr2xmltest.c: Don't unref a NULL connection object.
	Reset error object between tests. Free capabilities on exit
	* tests/testutils.c: Fix crash in OOM testing for non-SMP
	usage
	* tests/xml2sexprtest.c: Reset error object between tests

Wed Apr  1 11:22:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Sanitise symlink resolving
	* src/libvirt_private.syms: Add virFileResolveLink
	* src/util.c, src/util.h: Add convenient virFileResolveLink
	for reading symlink destination safely
	* src/storage_backend_disk.c, src/security_selinux.c: Switch
	over to calling virFileResolveLink

Wed Apr  1 11:18:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc memory handling fixes
	* src/node_device.c: Don't strdup() a NULL parent device name
	* src/qemu_conf.c: Don't try to access() a NULL alternative
	binary name
	* src/storage_conf.c: Don't free mode string while its still
	in use

Wed Apr  1 11:16:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Add support for vifname= parameter in
	VIF config
	* tests/xmconfigtest.c: Add test for vifname= handling
	* tests/xmconfigdata/test-paravirt-net-vifname.cfg,
	tests/xmconfigdata/test-paravirt-net-vifname.xml: Data file
	for new test

Wed Apr  1 10:58:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Improve error reporting in SEXPR generation
	* src/xm_internal.c, src/xend_internal.c: Avoid overwriting
	previously set error message. Clarify message when network
	lookup fails

Wed Apr  1 10:55:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/node_device.c: Fix error message for missing node device
	during lookup by name

Wed Apr  1 10:54:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Fix URI check in migration

Wed Apr  1 10:50:22 BST 2009 Daniel P. Berrange <berrange@redhat.com>

	Add a tree view of node devices
	* src/remote_internal.c: Fix memory leak in virNodeDeviceGetParent() impl
	* src/virsh.c: Add --tree flag to nodedev-list command

Tue Mar 31 17:40:00 CEST 2009 Chris Lalancette <clalance@redhat.com>
	* src/lxc_driver.c, src/openvz_driver.c, src/qemu_driver.c,
	src/remote_internal.c, src/test.c, src/uml_driver.c, src/xen_unified.c,
	src/driver.h, src/libvirt.c, src/proxy_internal.c, src/xen_inotify.c,
	src/xen_internal.c, src/xen_unified.h, src/xend_internal.c,
	src/xm_internal.c, src/xs_internal.c: Convert all drivers to use
	old-style struct initializers; this makes a handy built-in TODO list
	for each driver.  Also rip out the internal getURI method; it was never
	used by any of the drivers, and was buggy to boot.

Tue Mar 31 14:44:16 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: better modularization of the spec file,
	  patch by Ryota Ozaki

Tue Mar 31 14:25:18 CEST 2009 Daniel Veillard <veillard@redhat.com>

	* src/util.c: fix virRun() to prevent zombies on pipe errors,
	  patch by Ryota Ozaki

Fri Mar 27 11:44:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Don't try to query balloon if guest
	isn't running

Fri Mar 27 11:44:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Support memory ballooning in QEMU
	* src/qemu_conf.c: Fix initial QEMU startup memory allocation
	to be based on 'max memory'
	* src/qemu_driver.c: Balloon down allocation to 'memory'
	setting at startup. Implement virDomainSetMemory() for running
	guests via memory balloon. Report mem current usage by querying
	memory balloon.

Tue Mar 24 11:14:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/capabilities.c, file src/capabilities.h,
	src/domain_conf.c, src/xm_internal.c: Prefer native arch
	when auto-filling guest architecture. Match on domain type
	when auto-filling architecture (Soren Hansen)

Tue Mar 24 10:51:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.maint: Include 'CHECK: ' prefix when printing
	name of each syntax-check rule that is run

Tue Mar 24 10:51:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c, src/openvz_conf.h, src/openvz_driver.c: Add
	support for a non-template filesystem root. (Florian Vichot)

Mon Mar 23 17:33:17 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fix missing authentication when command are issued
	  from the shell, patch by Matthias Bolte

Fri Mar 20 21:43:57 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/util.c: flag unused parameters, by Maximilian Wilhelm

Fri Mar 20 13:16:01 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/libvirt_private.syms src/storage_backend_fs.c src/util.c
	  src/util.h: use posix_fallocate() on supported systems to
	  allocate diskspace faster, patches by Amit Shah

Fri Mar 20 11:41:40 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix test breakage on x86_64 from previous change
	* tests/qemuxml2argvdata/qemuxml2argv-migrate.args,
	tests/qemuxml2argvdata/qemuxml2argv-migrate.xml,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v1.args,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v1.xml,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v2.args,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v2.xml: Switch
	to base 'qemu' emulator to avoid arch-dependant options
	needed by 'qemu-kvm' emulator.

Fri Mar 20 11:21:40 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Make use of emulator binaries more flexible
	* src/qemu_conf.h: Add flag for -no-kvm option
	* src/qemu_conf.c: Allow i686 on x86_64 for KVM guests using
	-cpu flag. Allow qemu-system-x86_64 to be used for 32-bit
	guests. Allow KVM binary to be used for non-KVM guests using
	-no-kvm flag

Thu Mar 19 15:25:40 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/schemas/domain.rng: extend definition for security attributes

Tue Mar 17 11:35:58 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix labelling of shared/readonly devices (Dan Walsh)
	* src/qemu_driver.c, src/security.h: Disk label commands
	take virDomainDiskDefPtr instead of virDomainDefPtr
	* src/security_selinux.c: Do not relabel shared or readonly
	disk images with MCS label.

Tue Mar 17 11:58:58 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/remote_internal.c: remove file descriptors leak

Mon Mar 16 13:17:05 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/libvirt.c: Don't allow readonly connections to dump secure xml.

Mon Mar 16 13:15:11 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Initialize security driver after config parsing

Mon Mar 16 13:12:59 EDT 2009 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Fix test driver 'save' deadlock

Mon Mar 16 13:52:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Support SASL auth for VNC server.
	* qemud/libvirtd_qemu.aug, qemud/test_libvirtd_qemu.aug: Add
	support for VNC sasl config options
	* src/qemu.conf: Example VNC sasl config options
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Add
	ability to set SASL authentication on VNC servers
	* tests/qemuxml2argvtest.c: Test for VNC SASL and TLS security
	options
	* tests/qemuxml2argvdata/qemuxml2argv-graphics-vnc-sasl.args,
	tests/qemuxml2argvdata/qemuxml2argv-graphics-vnc-sasl.xml,
	tests/qemuxml2argvdata/qemuxml2argv-graphics-vnc-tls.args,
	tests/qemuxml2argvdata/qemuxml2argv-graphics-vnc-tls.xml: Data
	files for tests

Mon Mar 16 11:44:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Avoid deadlock in virDomainSetVcpus
	driver impl

Mon Mar 16 10:55:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix subsystem lookup for older HAL releases
	* src/node_device_hal.c: Check for linux.subsystem property

Mon Mar 16 10:45:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Add ac97 to test case & RNG schema (Pritesh Kothari)
	* docs/schemas/domain.rng: Add ac97 as valid soundcard
	* tests/qemuxml2argvdata/qemuxml2argv-sound.args,
	tests/qemuxml2argvdata/qemuxml2argv-sound.xml: Extend test to
	cover ac97 soundcard.

Mon Mar 16 11:40:00 CET 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c src/cgroup.c src/uml_driver.c src/util.c: close
	  some potential FILE * leaks

Mon Mar 16 10:35:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/event.c: Fix dispatch of FD events when one or more
	handles has been marked as deleted

Mon Mar 16 10:30:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Don't allocate cpumaps arg if maplength is
	0, and fix size of cpumaps allocation

Mon Mar 16 10:30:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_driver.c: Don't free storage volume in error
	path, since it may still be referenced elsewhere

Mon Mar 16 10:29:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Avoid harmless warning message
	* src/qemu_driver.c, src/uml_driver.c: Don't try to close a
	NULL virConnectPtr object.

Thu Mar 12 21:13:40 CET 2009 Daniel Veillard <veilard@redhat.com>

	* src/storage_conf.c: fix storage pool mode parsing, and refactoring
	  patch by Ryota Ozaki

Wed Mar 11 14:42:24 CET 2009 Daniel Veillard <veilard@redhat.com>

	* src/xs_internal.c: fix xen events handling problem (Dan Berrange)

Tue Mar 10 12:03:37 CET 2009 Daniel Veillard <veilard@redhat.com>

	* src/xend_internal.c: fix an allocation problem in
	  xenDaemonDomainLookupByName_ids

Tue Mar 10 10:29:46 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fix tap vs vbd type for block detach
	(Cole Robinson / Takahashi Tomohiro)

Fri Mar  6 15:42:46 CET 2009 Daniel Veillard <veilard@redhat.com>

	* src/cgroup.c src/cgroup.h src/lxc_driver.c: allows to get
	  CPU usage of a lxc using cpuacct subsystem of cgroups, patch
	  by Ryota Ozaki

Wed Mar  4 14:11:15 CET 2009 Daniel Veillard <veilard@redhat.com>

	* NEWS configure.in libvirt.spec.in doc/* include/libvirt/libvirt.h:
	  release of 0.6.1
	* po/*: rebuilt
	* AUTHORS: updated to list new contributors

Wed Mar  4 12:37:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix misc failures in test suite & make test cases more robust
	to future changes
	* src/virsh.c: Add a new --print-xml option to pool-define-as
	and pool-create-as, to allow printing of generated XML doc.
	* tests/Makefile.am: Fix setting of CONFIG_HEADER variable
	* tests/daemon-conf: Don't diff entire of libvirtd stdout,
	just grep for the diagnostic we care about, to avoid breaking
	everytime libvirtd prints new unrelated diagnostics
	* tests/libvirtd-fail: Check status of libvirtd when run with
	bogus config file to detect failure, rather than relying on
	diff of unpredictable stdout logs
	* tests/libvirtd-net-persist: Remove test which breaks if
	QEMU driver can't be started, and conflicts with running
	session daemon
	* tests/libvirtd-pool: Use new --print-xml option to virsh
	to directly test XML generation, rather than indirectly
	checking via the QEMU driver

Tue Mar  3 19:31:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Fix return status s/-2/-1/ for virNodeGetSecurityModel
	and virDomainGetSecurityLabel()
	* src/remote_driver.c:Add missing mutex lock/unlock calls for
	virNodeGetSecurityModel and virDomainGetSecurityLabel drivers

Tue Mar  3 16:55:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Mingw32 portability fixes
	* src/pci.c: Use lseek+read/write instead of pread/pwrite
	to avoid mingw compile break
	* test/nodedevxml2xmltest.c: Don't link to QEMU driver, since
	its not required and breaks build when QEMU is turned off

Tue Mar  3 16:43:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Explicitly track static declared vs dynamically generated
	security labels for VMs
	* src/domain_conf.c, src/domain_conf.h: Add type='static|dynamic'
	for <seclabel> to determine whether to auto-generate labels
	* src/qemu_driver.c: Only generate security labels for type=dynamic

Tue Mar  3 14:58:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc sVirt bug fixes
	* src/qemu_driver.c: Don't raise error - let callee do it
	* src/security.h: Pass virCOnnectPtr when generating label
	* src/security_selinux.c: Fix STREQ logic bugs, and use
	VIR_ALLOC, and report detailed errors.

Tue Mar 3 15:58:55 +0100 2009 Jim Meyering <meyering@redhat.com>

	config: fix a typo
	* src/qemu_conf.c (CHECK_TYPE): Fix typo:
	s/security_river/security_driver/

Tue Mar  3 15:35:02 CET 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: update italian, polish and brazilian translations, regenerate

Tue Mar  3 12:01:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	QEMU security driver usage for sVirt support (James Morris, Dan Walsh
	& Daniel Berrange)
	* src/qemu.conf: Add security_driver config option
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c,
	src/util.c: Use a security driver (if available) when
	running virtual machines

Tue Mar  3 11:31:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/iptables.c, src/qemu_conf.c, src/qemu_driver.c,
	src/uuid.c: Replace qemudLogging with calls to logging.h
	APIs

Tue Mar 3 12:22:51 +0100 2009 Jim Meyering <meyering@redhat.com>

	avoid file descriptor leak when fd == 0
	* src/pci.c (pciGetDevice): Initialize dev->fd to -1, not 0.
	(pciFreeDevice): Close fd also when it is 0.

Tue Mar 3 12:22:51 +0100 2009 Jim Meyering <meyering@redhat.com>

	don't leak a file descriptor on failed pciGetDevice call
	* src/pci.c (pciIterDevices): Always close dir handle.

Tue Mar 3 12:22:51 +0100 2009 Jim Meyering <meyering@redhat.com>

	update .gitignore and .hgignore files

Tue Mar  3 10:01:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	SELinux security driver for sVirt support (James Morris, Dan Walsh & Daniel
	Berrange)
	* configure.in: Check for selinux_virtual_domain_context_path() and
	selinux_virtual_image_context_path() methods in libselinux.so
	* po/POTFILES.in: add src/security_selinux.c
	* src/Makefile.am, src/security.c, src/security_selinux.c,
	src/security_selinux.h: Add SELinux impl of security driver API

Tue Mar  3 09:55:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	virsh additions for sVirt support (James Morris & Dan Walsh)
	* src/virsh.c: Include security model / label information
	in the 'dominfo' output

Tue Mar  3 09:40:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Core internal driver stub for sVirt support (James Morris & Dan Walsh)
	* Makefile.maint: Add virSecurityReportError as a msggen
	function
	* docs/schemas/capability.rng: Add <secmodel> element
	* docs/schemas/domain.rng: Add <seclabel> element
	* include/libvirt/virterror.h, src/virterror.c: Add
	VIR_FROM_SECURITY and VIR_ERR_NO_SECURITY_MODEL
	* po/POTFILES.in: Add src/security.c
	* src/Makefile.am: Build security driver into libvirt.so
	* src/capabilities.c, src/capabilities.h: Handling of
	<secmodel> element / data
	* src/domain_conf.c, src/domain_conf.h: Handling of
	<seclabel> element / data
	* src/libvirt_private.syms: Add virXPathStringLimit and
	virSecurity* methods
	* src/security.c, src/security.h: Add internal driver
	stub impl
	* src/storage_backend.c: TODO item about seclabel
	* src/xml.c, src/xml.h: Add virXPathStringLimit

Tue Mar  3 09:25:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Remote protocol / RPC API for sVirt support (James Morris & Dan Walsh)
	* qemud/remote.c: Handle new RPC calls
	* qemud/remote_protocol.x: Add definitions for new RPC calls
	* src/remote_internal.c: Implement virDomainGetSecurityLabel()
	and virNodeGetSecurityModel() driver methods
	* qemud/remote_dispatch_args.h, qemud/remote_dispatch_prototypes.h,
	qemud/remote_dispatch_ret.h, qemud/remote_dispatch_table.h,
	qemud/remote_protocol.c, qemud/remote_protocol.h: Regenerate

Tue Mar  3 09:12:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Internal driver API for sVirt support (James Morris & Dan Walsh)
	* src/driver.h: Internal typedefs for virNodeGetSecurityModel()
	and virDomainGetSecurityLabel() driver entry points
	* src/libvirt.c: Implement entry point for new public APIs
	virNodeGetSecurityModel() and virDomainGetSecurityLabel()
	* src/lxc_driver.c, src/openvz_driver.c, src/qemu_driver.c,
	src/test.c, src/uml_driver.c: Update for new driver entry
	points
	* python/generator.py: temporarily blacklist non-generated
	virNodeGetSecurityModel() and virDomainGetSecurityLabel()

Tue Mar  3 09:10:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Public API for sVirt support (James Morris & Dan Walsh)
	* include/libvirt/libvirt.h.in, src/libvirt_public.syms: added
	virNodeGetSecurityModel() and virDomainGetSecurityLabel() APIs
	* include/libvirt/libvirt.h: Regenerated

Tue Mar  3 08:55:13 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Don't try to detach & reset PCI devices while running test
	suite for XML-> ARGV conversion.
	* src/qemu_driver.c: Add qemuPrepareHostDevices() helper to
	detach and reset PCI devices.
	* src/qemu_conf.c: Don't detach & reset PCI devices while
	building the command line argv

Tue Mar  3 09:24:13 CET 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c: fix qemu+tls handshake negotiation, patch by
	  Chris Lalancette

Mon Mar 2 20:24:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* python/.cvsignore: Ignore generated.stamp
	* examples/hellolibvirt/.cvsignore: Ignore autotools generated
	files

Mon Mar 2 20:21:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Always reset PCI devices before starting guests.
	Add todo item for non-managed PCI devs

Mon Mar 2 20:18:00 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_private.syms: Export virUnrefConnect and
	virCapabilitiesGenerateMac to drivers

Mon Mar 2 21:00:00 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: further isolate a test that runs libvirtd
	* tests/daemon-conf: Specify a non-default socket directory.
	Specify test-specific log directory and pid file, too.

Mon Mar 2 21:00:00 +0100 2009 Jim Meyering <meyering@redhat.com>

	add two tests
	* tests/libvirtd-pool: New file.
	Exercise the new unix_sock_dir option
	* tests/libvirtd-fail: New file.
	* tests/Makefile.am (test_scripts): Add libvirtd-fail and libvirtd-pool.

Mon Mar 2 20:01:55 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: fix an error that made us skip the daemon-conf test
	* tests/Makefile.am (CONFIG_HEADER): Correct definition.

Mon Mar 2 19:32:18 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: test for a recent fix
	* tests/libvirtd-net-persist: New file.  Test for today's
	"Mark 'defined' networks as persistent" fix.
	* tests/Makefile.am (test_scripts): Add it.

Mon Mar 2 19:32:18 +0100 2009 Jim Meyering <meyering@redhat.com>

	virsh: tweak a format string to avoid emitting trailing space
	* src/virsh.c (cmdNetworkList): Change format not to right-pad
	with spaces, as that would have required a trailing blank in
	an expected output file.

Mon Mar 2 12:52:16 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/network_conf.c: Fix bridge generation loop counter.

Mon Mar 2 12:38:08 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/node_device_hal.c: Recognize ejectable media in hostdev hal driver.

Mon Mar 2 12:37:04 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/libvirt_private.syms
	  src/qemu_driver.c:
	  Better error reporting from qemu AttachDevice

Mon Mar 2 12:34:25 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/bridge.c src/bridge.h src/libvirt_private.syms src/network_conf.c
	  src/network_conf.h src/network_driver.c:
	  Generate network bridge names if none passed at define/create time.

Mon Mar 2 12:30:08 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/qemu_driver.c:
	Remove redundant monitor watch variable (s/monitor_watch/monitorWatch/)

Mon Mar 2 12:25:58 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/network_driver.c src/network_conf.c: Mark 'defined' networks
	  as persistent.

Mon Mar  2 17:35:09 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/schemas/domain.rng src/domain_conf.c src/domain_conf.h
	  src/qemu_conf.c
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-pci-address.xml
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-address.xml
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-product.xml:
	  adds a new <hostdev managed='(yes|no)'> property
	  to host devices indicating whether or not we should
	  automatically dettach/reset, patch by Mark McLoughlin

Mon Mar  2 17:31:48 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: add qemu dettach/reattach/reset implementation
	  patch by Mark McLoughlin.

Mon Mar  2 17:28:42 CET 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/remote.c qemud/remote_dispatch_args.h
	  qemud/remote_dispatch_prototypes.h qemud/remote_dispatch_table.h
	  qemud/remote_protocol.c qemud/remote_protocol.h
	  qemud/remote_protocol.x src/remote_internal.c: Implement
	  attach/reattach/reset in the remote driver, patch by Mark
	  McLoughlin.

Mon Mar  2 17:26:48 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: add 3 new commands for node device detach,
	  reattach and reset, patch by Mark McLoughlin.

Mon Mar  2 17:19:23 CET 2009 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/driver.h src/libvirt.c src/libvirt_public.syms
	  src/lxc_driver.c src/openvz_driver.c src/qemu_driver.c
	  src/test.c src/uml_driver.c: add the public APIs for
	  virNodeDeviceDettach virNodeDeviceReAttach and virNodeDeviceReset
	  and extends the driver structure accordingly, patch by Mark
	  McLoughlin.

Mon Mar  2 17:07:44 CET 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in po/POTFILES.in src/Makefile.am src/libvirt_private.syms
	  src/pci.c src/pci.h: Add implementations of dettach, reattach and
	  reset for PCI devices, patch by Mark McLoughlin

Mon Mar  2 12:12:11 CET 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c src/node_device_hal.c: activate DBus multithreading
	  to avoid random crashes in the daemon, patch by Daniel Berrange

Mon Mar 2 10:16:04 +0100 2009 Jim Meyering <meyering@redhat.com>

	correct a typo in a diagnostic
	* src/storage_conf.c (virStorageVolDefParsePerms): Correct a typo:
	s/owner/group/.  Patch by Ryota Ozaki.

	plug two config-parsing leaks
	* src/storage_conf.c (virStoragePoolDefParsePerms): Free mode string.
	(virStorageVolDefParsePerms): Likewise.
	Patch by Ryota Ozaki.
	* AUTHORS: Update.

	don't dereference uninitialized pointer
	* src/storage_conf.c (virStoragePoolDefParsePerms): Initialize
	"ptr" to NULL.

Fri Feb 27 17:15:00 CET 2009 Chris Lalancette <clalance@redhat.com>

	* src/qemu_driver.c: If there is a failure during offline migrate,
	make sure to resume the guest.

Fri Feb 27 15:27:31 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/libvirt-api.xml docs/libvirt-refs.xml
	  docs/devhelp/libvirt-virterror.html docs/html/libvirt-virterror.html:
	  regenerated the APIs and documentation.
	* po/*: updated the polish translation, regenerated.

Thu Feb 26 16:01:04 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_private.syms, src/util.c, src/util.h: Add new
	virExecWithHook function to allow passing of a callback to run
	between fork() & exec()

Thu Feb 26 17:13:09 CET 2009 Daniel Veillard <veillard@redhat.com>

	* Makefile.am configure.in examples/hellolibvirt/Makefile.am
	  examples/hellolibvirt/hellolibvirt.c: new trivial example program
	  by David Allan

Thu Feb 26 16:05:04 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/remote_internal.c: fix autostart of session daemon, patch
	  by Dan Berrange

Thu Feb 26 15:35:40 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_fs.c: fix compile-error when configured without
	qemu-img

Thu Feb 26 14:43:48 CET 2009 Daniel Veillard <veillard@redhat.com>

	* python/Makefile.am: avoid a parallel make issue #472702
	  provided by Michael Marineau

Wed Feb 25 21:00:46 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/formatnetwork.html docs/formatnetwork.html.in: patch from
	  Charles Duffy documenting static host IP assignments.

Tue Feb 24 14:55:28 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* tests/nodedevxml2xmltest.c: Add a test to check node
	device XML parsing by first parsing the XML, then
	re-formatting as XML and finally comparing the resulting
	XML to the original XML.

	* tests/nodedevschemadata/*.xml: strip trailing newlines.

	* tests/Makefile.am, tests/.*ignore: adminstrivia

Tue Feb 24 14:54:05 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	*  src/libvirt_private.syms, src/node_device_conf.[ch]:
	Add virNodeDeviceDefParseString(), a function for
	parsing node device XML descriptions.

Tue Feb 24 14:52:58 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/xml.[ch]: Add virXPathULongLong()

Tue Feb 24 14:52:44 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/xml.[ch]: Add virXPathLongHex() and virXPathULongHex()

Tue Feb 24 14:51:32 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* docs/formatdomain.html: fix a typo in hostdev docs

Sun Feb 22 11:18:20 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/network_driver.c: networkEnableIpForwarding() now
	returns zero for success

Sun Feb 22 11:06:39 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* docs/formatdomain.html: commit auto-generated change as
	a result of earlier s/clock sync/clock offset/

Thu Feb 19 09:14:56 CET 2009 Guido Günther <agx@sigxcpu.org>

	* src/qemu_driver.c (qemudReadMonitorOutput, qemudReadLogOutput):
	(s)size_t type cleanup

Tue Feb 17 20:40:51 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Remove the _actually_ incorrect
	ATTRIBUTE_UNUSED (Patch by Maximilian Wilhelm)

Tue Feb 17 15:44:38 +0100 2009 Jim Meyering <meyering@redhat.com>

	fix build failure due to invalid generated Makefile
	* qemud/Makefile.am (libvirtd_LDADD): Unindent "if HAVE_*" directives.
	Reported by Daniel Schwager.

Tue Feb 17 09:49:49 EST 2009 Cole Robinson <crobinso@redhat.com>

	* qemud/qemud.c : Fix daemon TCP listen cleanup

Tue Feb 17 09:47:05 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c : Remove incorrect ATTRIBUTE_UNUSED usage.

Tue Feb 17 11:41:10 +0100 2009 Maximilian Wilhelm <max@rfc2324.org>

	Build fix for 'driver.c' when building with loadable modules
	The 'asprintf' -> 'virAsprintf' transition made in
	[9e5d9950] "use virAsprintf instead of asprintf" introducted
	a build error for 'driver.c' as 'util.h' has to be included.

	Signed-off-by: Maximilian Wilhelm <max@rfc2324.org>

Tue Feb 17 11:32:01 +0100 2009 Jim Meyering <meyering@redhat.com>

	Avoid link failure when configured --with-driver-modules
	* qemud/Makefile.am (WITH_DRIVER_MODULES): Link with libvirt_driver.la
	and libvirt_util.la.  Indent for readability.

Tue Feb 17 11:30:23 +0100 2009 Maximilian Wilhelm <max@rfc2324.org>

	Work around 'virGetVersion' build problem
	The 'getVer' fix introducted in 02a72b42 [Allow remote://hostname/
	style URIs for automatic driver probe...] breaks compiling libvirt
	with loadable module support.  Work around this to get it building again.

Tue Feb 17 11:25:22 +0100 2009 Jim Meyering <meyering@redhat.com>

	avoid compiler warning about unused parameter
	* src/bridge.c (brProbeVnetHdr)
	[IFF_VNET_HDR && TUNGETFEATURES && TUNGETIFF]: Use a "(void)" case
	to mark the parameter as unused.  Reported by Maximilian Wilhelm in
	http://thread.gmane.org/gmane.comp.emulators.libvirt/11918/focus=11917

Tue Feb 17 11:21:00 +0100 2009 Jim Meyering <meyering@redhat.com>

	don't fail daemon-conf test when configured --without-qemu
	* tests/Makefile.am (TESTS_ENVIRONMENT): Define CONFIG_HEADER.
	* tests/daemon-conf: Use test-lib.sh.
	Skip this test when configured --without-qemu.

Tue Feb 17 11:21:00 +0100 2009 Jim Meyering <meyering@redhat.com>

	accommodate configuring --without-lxc --without-qemu
	* configure.in: Enable internal WITH_BRIDGE support not just for LXC or
	QEMU, but also for --with-network.  Russell Haering reported that
	compilation failed when configured with --without-lxc --without-qemu.
	Details: http://thread.gmane.org/gmane.comp.emulators.libvirt/11928
	* src/bridge.h: Use #if WITH_BRIDGE, rather than currently-equivalent
	"#if defined(WITH_QEMU) || defined(WITH_LXC)"

Tue Feb 17 11:18:39 +0100 2009 Jim Meyering <meyering@redhat.com>

	doc: fix typo in formatdomain's clock offset specification
	* docs/formatdomain.html.in: s/clock sync/clock offset/
	Patch by Jesse Lauren Farinacci <jieryn@gmail.com>.

Tue Feb 10 11:14:07 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix I/O errors in libvirtd daemon, and hang/crash in remote
	client upon I/O error.
	* qemud/event.c: Treat POLLNVAL as VIR_EVENT_HANDLE_ERROR
	* src/domain_conf.c: Initialize monitor FD to -1
	* src/remote_internal.c: Remove call object from waitDispatch
	queue upon I/O failure, since call is about to free it.

Mon Feb 16 17:59:04 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/virsh.c, src/Makefile.am: Don't pass flags to DumpXML
	in *-edit virsh commands

Mon Feb 16 17:55:50 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_logical.c: Remove erroneous lvm volume
	format check for backing store.

Mon Feb 16 17:53:24 EST 2009 Cole Robinson <crobinso@redhat.com>

	* python/generator.py: Skip bindings for virSaveLastError and
	virFreeError

Fri Feb 13 19:04:57 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/libvirt_private.syms, src/util.[ch]: add
	virFileWriteStr()

	* src/network_driver.c: use it here

Fri Feb 13 19:04:45 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/xml.c: fix some error strings

Fri Feb 13 19:04:22 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/xml.h: kill some non-existent functions

Fri Feb 13 19:03:58 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* docs/virsh.pod: update bugzilla link

Fri Feb 13 19:03:30 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: fix gcc-4.4 warnings

Fri Feb 13 19:03:25 GMT 2009 Mark McLoughlin <markmc@redhat.com>

	* src/bridge.c: fix gcc-4.4 warnings

Fri Feb 13 16:50:35 GMT 2009 John Levon <john.levon@sun.com>

	* src/xend_internal.c: xend in 3.3 grew a couple of new options
	for the migration method. As they're ignored on older xend
	versions, always pass them.

Fri Feb 13 19:09:54 +0100 2009 Jim Meyering <meyering@redhat.com>

	test:///default driver: don't dereference NULL "def"
	* src/test.c (testNetworkCreate, testNetworkDefine): Since "def" is
	set to NULL immediately after any vir*AssignDef call (to indicate we
	no longer own it and to ensure no clean-up path mistakenly frees it),
	dereference via net->def->, not def->.

Fri Feb 13 12:31:03 CET 2009 Guido Günther <agx@sigxcpu.org>

	usleep to wait for domain logfile to fill up
	* src/qemu_driver.c (qemudReadLogOutput): New function to read from
	domain log file.
	(qemudWaitForMonitor): Use it.
	(qemudOpenMonitor): Pass timout in seconds.
	(qemudReadMonitorOutput): Convert timout to milliseconds.

Wed Feb 11 21:30:47 CET 2009 Guido Günther <agx@sigxcpu.org>

	* src/qemu_driver.c (qemudStartVMDaemon): fix return status when
	domain didn't show up

Mon Feb 9 17:26:07 +0100 2009 Jim Meyering <meyering@redhat.com>

	libvirtd: new config-file option: unix_sock_dir
	Before this change, the unix socket directory was hard-coded
	to be e.g., /var/run/libvirt for euid==0 and ~/.libvirt otherwise.
	With this change, you may now specify that directory in libvirtd's
	config file via a line like this: unix_sock_dir = "/var/run/libvirt".
	This is essential for running tests that do not impinge on any
	existing libvirtd process, and in running tests in parallel.
	* qemud/libvirtd.conf (unix_sock_dir): Add comment and example.
	* qemud/qemud.h (struct qemud_server) [logDir]: Change type
	from char[PATH_MAX] to char*.
	* qemud/qemud.c (unix_sock_dir): New global
	(remoteReadConfigFile): Set the global.
	(qemudInitPaths): Use the global, unix_sock_dir, if non-NULL.
	One minor improvement: unlink both sockets or none, never
	just one of them.
	(qemudCleanup): Free logDir.
	(main): Use the new global rather than hard-coding "/run/libvirt".
	* qemud/libvirtd.aug (sock_acl_entry): Add "unix_sock_dir".

Mon Feb 9 10:13:28 +0100 2009 Jim Meyering <meyering@redhat.com>

	don't print uninitialized in debug diagnostic
	* qemud/mdns.c (libvirtd_mdns_timeout_new): Don't use local, t,
	uninitialized.

Mon Feb 9 16:25:52 +0100 2009 Jim Meyering <meyering@redhat.com>

	avoid two test failures induced by today's error-reporting changes
	* tests/cpuset: Adjust expected diagnostic to match new behavior.
	* tests/undefine: Likewise.

Mon Feb  9 14:19:02 GMT 2009 John Levon <john.levon@sun.com>

	* src/virsh.c: rather than verbosely printing every error, save
	the last error and report that only if the entire command fails.

Mon Feb  9 14:07:51 GMT 2009 John Levon <john.levon@sun.com>

	* include/libvirt/virterror.h:
	* src/libvirt_public.syms:
	* src/virterror.c: introduce virSaveLastError(), virFreeError()

Mon Feb  9 10:21:33 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Limit readonly history to 500 to avoid unbounded
	growth in memory usage (Jim Paris)

Sat Feb  7 21:46:06 CET 2009 Guido Günther <agx@sigxcpu.org>

	* src/qemu_driver.c (qemudStartVMDaemon, qemudDomainSuspend,
	qemudDomainResume, qemudDomainAttachDevice, qemudDomainDetachDevice):
	Don't ignore errors to save domain status.
	(qemudShutdownVMDaemon): Warn if we fail to remove the status file.

Fri Feb  6 14:43:10 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix 100% CPU bound loop when libvirtd --timeout is used
	* qemud/event.c: Don't assume pthread_t is equivalent to an
	int, explicitly track whether event loop is active with a
	flag independantly of the threadLeader variable
	* qemud/qemud.c: Don't register/unregister shutdown timer
	on each loop. Register once, and activate/deactivate when
	required

Thu Feb  5 19:28:10 GMT 2009 John Levon <john.levon@sun.com>

	* src/domain_conf.c: Check the last error, not the last
	connection error, which may not have been set.

Thu Feb  5 18:08:39 GMT 2009 John Levon <john.levon@sun.com>

	* src/xs_internal.c: Use virMacAddrCompare() for
	case-insensitive comparison

Thu Feb  5 17:19:24 GMT 2009 John Levon <john.levon@sun.com>

	* src/xend_internal.c: report error for some xend operations on
	shutdown domain

Thu Feb  5 16:53:37 GMT 2009 John Levon <john.levon@sun.com>

	* src/xend_internal.c: robustify sexpr parser for NICs

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	syntax-check: enable prohibit_nonreentrant
	* .x-sc_prohibit_nonreentrant: Add src/console.c and virterror.c.
	* Makefile.cfg (local-checks-to-skip): Don't exempt
	sc_prohibit_nonreentrant.
	* Makefile.nonreentrant: Don't exempt strerror.

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	remove remainder of offending strerror uses
	* qemud/qemud.c (GET_CONF_STR): Use virStrerror, not strerror.
	* qemud/remote.c (remoteDispatchDomainBlockPeek): Likewise.
	(remoteDispatchDomainMemoryPeek, remoteDispatchAuthSaslInit): Likewise.
	(remoteDispatchAuthPolkit): Likewise.
	* src/lxc_container.c (lxcContainerAvailable): Likewise.
	* src/network_driver.c (networkStartNetworkDaemon): Likewise.
	(networkShutdownNetworkDaemon): Likewise.
	* src/qemu_conf.c (qemudExtractVersion, qemudNetworkIfaceConnect):
	* src/storage_conf.c (virStoragePoolLoadAllConfigs): Likewise.
	* src/storage_driver.c (storagePoolUndefine): Likewise.
	* src/uml_driver.c (umlStartup, umlStartVMDaemon): Likewise.
	* src/util.c (virFileReadAll): Likewise.
	* src/uuid.c (virUUIDGenerate): Likewise.
	* src/xen_internal.c (get_cpu_flags): Likewise.

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	don't include raw errno in diagnostics
	* src/uml_driver.c (umlStartVMDaemon): Don't print raw errno value.
	* qemud/remote.c (remoteDispatchAuthSaslInit): Likewise.

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	qemud.c: use virStrerror, not strerror

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	iptables.c: Use virStrerror, not strerror.
	* src/iptables.c: Include "virterror_internal.h".
	Use virStrerror, not strerror.
	* src/iptables.c (notifyRulesUpdated): Use %s rather than
	string-concatenation that made sc_unmarked_diagnostics report
	a false-positive.

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	use virReportOOMError rather than more verbose equivalent
	* src/qemu_driver.c (qemudDomainSave, qemudDomainRestore)
	(qemudDomainAttachPciDiskDevice)
	(qemudDomainAttachUsbMassstorageDevice):

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	qemu_driver.c: s/strerror/virStrerror.../
	Perform most changs automatically, with this:
	perl -pi -e 's/\bstrerror *\((.+?)\)/virStrerror($1, ebuf, sizeof ebuf)/'
	Then, declare ebuf, as needed

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	remove duplicate *SetCloseExec and *SetNonBlock functions
	* src/qemu_driver.c: Use virSetCloseExec and virSetNonBlock,
	rather than qemuSet* functions.  Suggested by Daniel P. Berrange.
	* src/util.c (virSetCloseExec): Publicize.
	* src/util.h (virSetCloseExec): Declare
	* src/libvirt_private.syms: Add virSetCloseExec.

Thu Feb 5 17:03:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	qemu_driver.c: use virReportSystemError in place of some qemudLog uses
	...thus eliminating many uses of strerror.
	(kvmGetMaxVCPUs): Rather than merely warning, diagnose an error
	and return -1 upon failure to open KVM_DEVICE.  Suggested by
	Daniel P. Berrange.

Thu Feb 5 17:03:34 +0100 2009 Jim Meyering <meyering@redhat.com>

	publicize virStrerror
	* src/virterror.c (virStrerror): Remove "static".
	* src/virterror_internal.h (virStrerror): Declare it.
	* src/libvirt_private.syms: Add virStrerror;

Thu Feb 5 17:00:17 +0100 2009 Jim Meyering <meyering@redhat.com>

	remove useless code
	* src/bridge.c (brAddTap): Remove redundant errno=ENOMEM assignment
	after failed strdup.
	* src/cgroup.c (virCgroupFree): Remove redundant *group=NULL assignment
	after VIR_FREE(*group).
	* src/lxc_driver.c (lxcShutdown): Likewise.
	* src/xen_unified.c (xenUnifiedClose): Likewise.
	* src/xm_internal.c (xenXMDomainConfigFormat): Rewrite disk-
	and net-config-setting code to be clearer.

Wed Feb 4 22:22:34 +0100 2009 Jim Meyering <meyering@redhat.com>

	lxc_container: Don't dereference NULL upon failure
	* src/lxc_container.c (lxcContainerPivotRoot): Free and zero
	oldroot *after* printing the diagnostic, both for virFileMakePath
	and pivot_root failure.

Tue Feb  3 14:06:06 +0100 2009 Jim Meyering <meyering@redhat.com>

	avoid a format-related warning
	* src/qemu_driver.c (qemudStartVMDaemon): Use "%s".

Tue Feb  3 14:06:06 +0100 2009 Jim Meyering <meyering@redhat.com>

	build: enable redundant-const check
	* Makefile.cfg (local-checks-to-skip): Remove sc_redundant_const.
	* src/lxc_controller.c: Remove redundant "const"(s).
	* src/storage_backend_fs.c: Likewise.
	* src/util.h: Likewise.
	* src/xen_internal.c: Likewise.
	* tests/qparamtest.c: Likewise.

Tue Feb  3 14:06:06 +0100 2009 Jim Meyering <meyering@redhat.com>

	syntax-check: enable more checks
	* Makefile.cfg (local-checks-to-skip): Don't skip sc_m4_quote_check.
	Don't skip sc_prohibit_nonreentrant.
	* Makefile.nonreentrant (NON_REENTRANT): Comment out until we've
	remove all remaining uses of strerror.

Tue Feb  3 14:06:05 +0100 2009 Jim Meyering <meyering@redhat.com>

	cleanup: remove useless if-before-VIR_FREE
	* Makefile.cfg (useless_free_options): Also check for VIR_FREE.
	* src/iptables.c (iptRulesFree): Remove useless if-before-VIR_FREE.
	* src/remote_internal.c (remoteAuthSASL): Likewise.
	* src/test.c (testOpenFromFile): Likewise.

Mon Feb  2 21:33:57 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: diagnose more open failures
	* tests/qemuxml2argvtest.c: Revert the change,
	"tests: diagnose open failure" of 2009-01-30.
	* tests/testutils.c (virtTestLoadFile): Diagnose failure here.

Mon Feb  2 18:33:19 GMT 2009 John Levon <john.levon@sun.com>

	* src/libvirt.c: fix more printf("%s", NULL) cases

Sat Jan 31 14:45:58 CET 2009 Guido Günther<agx@sigxcpu.org>

	* src/remote_internal.c (doRemoteOpen): Don't hardcode ssh port 22,
	use VIR_FREE, initialize pointers to NULL not 0.

Sat Jan 31 11:43:21 CET 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in docs/* NEWS: release of 0.6.0
	* po/*: regenerated and updated brazilian and polish localizations

Sat Jan 31 10:09:08 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/news.html*: update with infos for 0.6.0
	* docs/*: regenerated some data too

Fri Jan 30 22:57:34 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: diagnose open failure
	* tests/qemuxml2argvtest.c (testCompareXMLToArgvFiles): Diagnose
	failure to open an input file.

Fri Jan 30 21:50:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Fix empty decl in enum declaration

Fri Jan 30 21:44:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* tests/qemuxml2argvdata/qemuxml2argv-disk-drive-shared.args,
	tests/qemuxml2argvdata/qemuxml2argv-disk-drive-shared.xml: Added
	two missing test data files from previous commit

Fri Jan 30 20:55:57 +0100 2009 Jim Meyering <meyering@redhat.com>

	fix qemud version reporting when qemu is not installed
	* src/qemu_conf.c (uname_normalize): New function, factored out of...
	(qemudBuildCommandLine): ...here.  Use the new function.
	(qemudExtractVersion): Use it here, rather than hard-coding "i686".

Fri Jan 30 17:16:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Fix ifname= handling for type=ethernet
	networking config to avoid literal (null)
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c,
	tests/qemuxml2argvdata/: Add test case for ethernet
	interface config

Fri Jan 30 17:12:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Support <driver cache='none|writeback|writethrough'/> cache
	control options
	* src/domain_conf.c, src/domain_conf.h: Add supported for
	disk caching mode options
	* src/qemu_conf.c, src/qemu_conf.h: Detect supported cache
	mode options for -drive and use them when launching QEMU
	* docs/schemas/domain.rng: Document cache mode options
	* tests/qemuxml2argvtest.c: Validate cache mode processing
	* tests/qemuxml2argvdata/: Data files for cache mode options

Fri Jan 30 17:12:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix crash when using bogus arch type
	* src/capabilities.c, src/capabilities.h: Add method to query
	for supported arch+ostype combo
	* src/domain_conf.c: Validate requested arch+ostype against
	supported capabilities
	* src/qemu_conf.c: Sanity check to avoid deferencing NULL
	machine type

Fri Jan 30 16:58:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc QEMU driver startup fixes
	* src/domain_conf.c: Add initialization of monitor_watch
	* src/qemud_driver.c: Fix infinite loop when QEMU quits on
	startup. Fix watch removal if watch isn't added. Fix use
	of VNC password from global driver config. Avoid zombies
	from daemonizing QEMU. Fix memory leak in monitorpath

Fri Jan 30 16:51:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_driver.c: Avoid probing for LXC until we know we're
	going to try opening the connection. Disable when using valgrind

Fri Jan 30 16:48:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_conf.c: Fix leak of volume objects when free'ing
	pool object

Fri Jan 30 16:46:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Fix memory leak after sending a libvirt
	error message back to client

Fri Jan 30 15:34:42 GMT 2009 John Levon <john.levon@sun.com>

	* src/libvirt.c: Fix yet another printf("%s", NULL) case

	* src/util.c: Fix getpwuid_r() usage

	* src/virsh.c: Fix virsh migrateuri handling

Thu Jan 29 23:01:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc Xen driver crash/bug fixes
	* src/remote_internal.c: Re-factor startup of secondary driver
	activation to fix missing initialization & crash.  Fix memory
	leak in error reporting
	* src/xen_unified.c: Don't activate inotify driver if non-root
	* src/xend_internal.c: Don't report errors when probing for
	XenD TCP port if unprivileged, allow caller to do it. Fix bad
	return values in open method
	* src/xs_internal.c: Fix double free

Thu Jan 29 17:22:53 GMT 2009 John Levon <john.levon@sun.com>

	* src/xend_internal.c: Fix xend XML generation when CPU pinning
	is used

Thu Jan 29 19:05:00 +0100 2009 Jim Meyering <meyering@redhat.com>

	maint: sync from coreutils
	* .x-sc_prohibit_have_config_h: Renamed from...
	* .x-sc_no_have_config_h: ... this.
	* .x-sc_prohibit_HAVE_MBRTOWC: New file.

Thu Jan 29 17:40:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Support VNC password setting for QEMU driver
	* qemud/Makefile.am: Add missing test of libvirt_qemud.aug file
	* qemud/libvirtd_qemu.aug: Add suport for VNC password config
	* qemud/test_libvirtd.aug: Add logging params test
	* qemud/test_libvirtd_qemu.aug: Remove bogus logging params,
	and add VNC password test
	* src/qemu.conf: Include example VNC password config
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Support
	setting a VNC password on a per-VM basis, or from QEMU driver
	global config file.
	* src/uml_driver.c: Fix initialization of inotifyWatch param
	to avoid bogus watch unregister later
	* src/virsh.c: Add --security-info and --inative flags to
	dumpxml command. Ensure edit command uses SECURE & INACTIVE
	flags when changing config


Thu Jan 29 17:24:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Fix save/restore for new KVM releases
	* src/domain_conf.h, src/lxc_driver.c, src/uml_driver.c:
	Remove unused stdin_fd field from virDomainObjPtr
	* src/qemu_conf.c, src/qemu_driver.c: Support new
	migration options for save & restore, and fix deadlock
	in save code.
	* src/qemu_conf.h: Add more QEMU argv flags to various
	migration options & describe existing flags
	* src/util.c: Close original stdin file handle after
	duping it onto STDIN_FILENO
	* tests/qemuxml2argvtest.c: Test for various migrate
	syntax options
	* tests/qemuxml2argvdata/qemuxml2argv-migrate.args,
	tests/qemuxml2argvdata/qemuxml2argv-migrate.xml,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v1.args,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v1.xml,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v2.args,
	tests/qemuxml2argvdata/qemuxml2argv-restore-v2.xml: Data
	files for testing migrate syntax options

Thu Jan 29 17:15:18 GMT 2009 John Levon <john.levon@sun.com>

	* src/libvirt.c: fix another printf("%s", NULL) case

Thu Jan 29 09:03:17 PST 2009 John Levon <john.levon@sun.com>

	* src/xend_internal.c: correctly enable floppies for HVM guests.
	Refuse to directly attach disks that won't work via
	device_create.

Thu Jan 29 16:41:07 GMT 2009 John Levon <john.levon@sun.com>

	* src/util.c: allow strtol replacements for libvirt proxy

	* src/xend_internal.c: fix VNC port reporting when vncunused
	is set

	* tests/sexpr2xmldata/sexpr2xml-fv-autoport.sexpr:
	* tests/sexpr2xmldata/sexpr2xml-fv-autoport.xml:
	* tests/sexpr2xmltest.c: add a test

Thu Jan 29 13:07:05 +0100 2009 Jim Meyering <meyering@redhat.com>

	* Makefile.cfg: disable some new checks

Thu Jan 29 13:07:05 +0100 2009 Jim Meyering <meyering@redhat.com>

	* Makefile.maint: sync from coreutils

Thu Jan 29 13:07:05 +0100 2009 Jim Meyering <meyering@redhat.com>

	prohibit new uses of VIR_ERR_NO_MEMORY
	* Makefile.maint (sc_prohibit_VIR_ERR_NO_MEMORY): New rule.
	* .x-sc_prohibit_VIR_ERR_NO_MEMORY: New file: exceptions.

Thu Jan 29 13:06:51 +0100 2009 Jim Meyering <meyering@redhat.com>

	error-reporting calls using VIR_ERR_NO_MEMORY: use virReportOOMError instead
	* src/uml_conf.c (VIR_FROM_THIS): Define to VIR_FROM_UML.
	* src/xs_internal.c (VIR_FROM_THIS): Define to VIR_FROM_XEN.
	* src/xml.c (VIR_FROM_THIS): Define to VIR_FROM_XML.
	* src/stats_linux.c (VIR_FROM_THIS): Define to VIR_FROM_STATS_LINUX.
	* src/datatypes.c (VIR_FROM_THIS): Define to VIR_FROM_NONE.
	* src/lxc_conf.c (VIR_FROM_THIS): Define to VIR_FROM_LXC.
	* src/libvirt.c (VIR_FROM_THIS): Define to VIR_FROM_NONE.
	* src/node_device_conf.c (VIR_FROM_THIS): Define to VIR_FROM_NODEDEV.
	* src/openvz_conf.c (VIR_FROM_THIS): Define to VIR_FROM_OPENVZ.
	* src/openvz_driver.c (VIR_FROM_THIS): Define to VIR_FROM_OPENVZ.
	* src/conf.c (VIR_FROM_THIS): Define to VIR_FROM_CONF.
	Note: this loses config_filename:config_lineno diagnostics,
	but that's ok.
	* src/node_device.c (VIR_FROM_THIS): Define to VIR_FROM_NODEDEV.
	* src/sexpr.c (VIR_FROM_THIS): Define to VIR_FROM_SEXPR.
	* po/POTFILES.in: remove src/sexpr.c and src/lxc_conf.c

Thu Jan 29 12:44:15 CET 2009 Guido Günther <agx@sigxcpu.org>

	* src/virsh.c (main): don't abort when setlocale() fails

Wed Jan 28 22:05:11 GMT 2009 Daniel P.Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix typo, and tweak variable decl

Wed Jan 28 21:55:11 GMT 2009 Daniel P.Berrange <berrange@redhat.com>

	* src/remote_internal.c: Stop reading data off wire once
	a single complete message is available.

Wed Jan 28 21:53:11 GMT 2009 Daniel P.Berrange <berrange@redhat.com>

	Fix bogus valgrind memory leak warnings
	* tests/testutils.c: Clear global error upon exit
	* tests/.valgrind.supp: Ignore memory from thread local
	error storage

Wed Jan 28 21:33:11 GMT 2009 Daniel P.Berrange <berrange@redhat.com>

	Fix RPC portability to Solaris
	* configure.in: s/RPCGEN/HAVE_RPCGEN/ for automake
	conditional
	* qemud/Makefile.am: Move rpcgen rules into explicit
	rpcgen target to be manually invoked
	* qemud/remote_protocol.c, qemud/remote_protocol.h: Update
	with portability fixes
	* qemud/rpcgen_fix.pl: Replace quad_t types / functions
	with uint64_t ones and avoid GET_LONG in favour of GET_INT32

Wed Jan 28 15:45:11 +0100 2009 Jim Meyering <meyering@redhat.com>

	remote_internal.c: fix typo that would mistakenly report OOM
	* src/remote_internal.c (addrToString): Report VIR_ERR_UNKNOWN_HOST,
	not VIR_ERR_NO_MEMORY.

Wed Jan 28 15:45:11 +0100 2009 Jim Meyering <meyering@redhat.com>

	qparams.c: Use virReportOOMError(NULL), not qparam_report_oom()
	* src/qparams.c (VIR_FROM_THIS): Define to VIR_FROM_NONE.
	(qparam_report_oom): Remove definition.
	Replace all uses.

Wed Jan 28 14:24:45 GMT 2009 John Levon <john.levon@sun.com>

	* src/xend_internal.c: fix mis-use of PF_UNIX as a protocol

Wed Jan 28 14:27:11 +0100 2009 Jim Meyering <meyering@redhat.com>

	libvirt_proxy: avoid potential buffer overflow
	* proxy/libvirt_proxy.c (proxyReadClientSocket): Ensure that
	we've read an entire virProxyPacket before dereferencing "req".
	Analysis and patch by "Rasputin" <rasputin@email.ru>.  Details in
	<http://thread.gmane.org/gmane.comp.emulators.libvirt/11459>.

Wed Jan 28 14:53:37 +0100 2009 Jim Meyering <meyering@redhat.com>

	* po/POTFILES.in: Add src/lxc_conf.c

Wed Jan 28 13:31:12 GMT 2009 John Levon <john.levon@sun.com>

	* docs/examples/index.py: remove reference to non-existent *.res
	* docs/examples/Makefile.am: regenerate

Wed Jan 28 12:08:26 +0100 2009 Jim Meyering <meyering@redhat.com>

	avoid printf format-mismatch warnings
	* qemud/qemud.c (qemudClientReadBuf, qemudClientWriteBuf):
	Use %lld and a (long long int) cast to print a ssize_t value.

Tue Jan 27 18:17:07 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Support Copy-on-Write storage volumes
	* docs/formatstorage.html.in: Add notes about backingStore
	XML for storage volumes wanting copy-on-write (eg qcow,
	LVM snapshots).
	* src/libvirt_private.syms: Add virStorageVolFormatFileSystemTypeFromString
	* src/storage_backend.c, src/storage_backend.h: Refactor the
	virStorageBackendUpdateVolInfo* methods to allow re-use for
	backingStore files
	* src/storage_backend_fs.c: Extract backing store data out of
	Cow, QCow, QCow2, and VMDK file formats. Allow creation of volumes
	with a backing store
	* src/storage_backend_logical.c: Extract information about master
	volume for snapshots, and allow creation of snapshots.
	* src/storage_backend_iscsi.c: Adapt to storage_backend.h changes
	* src/storage_conf.h, src/storage_conf.c: Support new backingStore
	XML element for COW file data

Tue Jan 27 16:27:07 +0100 2009 Jim Meyering <meyering@redhat.com>

	* POTFILES.in: update: remove src/lxc_conf.c; Add src/bridge.c.

Tue Jan 27 15:18:16 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Add RNG schemas for all XML file formats used in API.
	* configure.in: Add docs/schema/Makefile.in to output files
	* libvirt.spec.in, mingw32-libvirt.spec.in: Package RNG schemas
	from $datadir/libvirt/schemas
	* docs/Makefile.am, docs/libvirt.rng, docs/network.rng: Remove
	RNGs schemas
	* docs/schemas/Makefile.am: Install RNG schemas to $datadir/libvirt
	* docs/schemas/capability.rng: Schema for host capability XML
	* docs/schemas/domain.rng: Schema for host capability XML
	* docs/schemas/network.rng: Schema for guest domain XML
	* docs/schemas/nodedev.rng: Schema for virtual network XML
	* docs/schemas/storagepool.rng: Schema for storage pool XML
	* docs/schemas/storagevol.rng: Schema for storage volume XML
	* tests/Makefile.am, capabilityschematest, networkschematest,
	nodedevschematest, storagepoolschematest, storagevolschematest:
	New test cases to validate example XML files against schemeas.
	* tests/capabilityschemadata/*.xml, tests/nodedevschemadata/*.xml,
	tests/storagepoolschemadata/*.xml, tests/storagevolschemadata/*.xml:
	New datafiles for schema validation tests.

Tue Jan 27 14:28:16 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* docs/index.html.in: Add link to libvirt-qpid & UML driver info
	* docs/drvopenvz.html.in, docs/drvqemu.html.in, docs/drvtest.html.in,
	docs/drvuml.html.in docs/drvxen.html.in: Add examples of local and
	remote URI formats. Also re-generate equiv .html files

Tue Jan 27 13:25:16 +0100 2009 Jim Meyering <meyering@redhat.com>

	virterror.c: don't read beyond end of buffer upon OOM
	* src/virterror.c (virReportSystemErrorFull): Fix typo in
	my previous change.  Patch by Daniel P. Berrange.

Tue Jan 27 10:48:12 IST 2009 Mark McLoughlin <markmc@redhat.com>

	kvm/virtio: Set IFF_VNET_HDR when setting up tap fds

	IFF_VNET_HDR is a tun/tap flag that allows you to send and receive
	large (i.e. GSO) packets and packets with partial checksums. Setting
	the flag means that every packet is proceeded by the same header which
	virtio uses to communicate GSO/csum metadata.

	By enabling this flag on the tap fds we create, we greatly increase
	the achievable throughput with virtio_net.

	However, we need to be careful to only set the flag when a) QEMU has
	support for this ABI and b) the value of the flag is queryable using
	the TUNGETIFF ioctl.

	It's nearly five months since kvm-74 - the first KVM release with this
	feature - was released. Up until now, we've not added libvirt support
	because there is no clean way to detect support for this in QEMU at
	runtime. A brief attempt to add a "info capabilities" monitor command
	to QEMU floundered. Perfect is the enemy of good enough. Probing the
	KVM version will suffice for now.

	* src/qemu_conf.[ch] (qemudExtractVersionInfo): detect the KVM version,
	set QEMUD_CMD_FLAG_VNET_HDR if we have kvm-74 or newer
	(qemudBuildCommandLine): if qemu support VNET_HDR and this is a
	virtio interface, then use it

	* src/bridge.[ch] (brProbeVnetHdr): only enable IFF_VNET_HDR if
	the kernel bits are available
	(brAddTap): add a @vnet_hdr arg, set IFF_VNET_HDR

Tue Jan 27 11:53:32 +0100 2009 Jim Meyering <meyering@redhat.com>
	and Daniel P. Berrange <berrange@redhat.com>

	fix errors in virReportSystemErrorFull
	* src/virterror.c (virStrerror): New function.
	(virReportSystemErrorFull): Don't leak "combined".
	In fact, don't even attempt allocation.
	Do include the result of formatted print in final diagnostic.

Tue Jan 27 10:38:09 +0100 2009 Jim Meyering <meyering@redhat.com>

	use gnulib's stpcpy module
	* bootstrap (modules): Add stpcpy, and pull in gnulib bits:
	* gnulib/lib/stpcpy.c: New file.
	* gnulib/m4/stpcpy.m4: New file.
	* gnulib/lib/Makefile.am: Update.
	* gnulib/m4/gnulib-cache.m4: Update.
	* gnulib/m4/gnulib-comp.m4: Update.

Tue Jan 27 10:38:09 +0100 2009 Jim Meyering <meyering@redhat.com>

	update from gnulib

Mon Jan 26 20:40:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	build: avoid format warnings
	* src/proxy_internal.c (xenProxyCommand): Mark a diagnostic.
	* src/xen_unified.c (xenUnifiedOpen, xenUnifiedAddDomainInfo):
	Fix unmarked diagnostics by removing the diagnostic altogether:
	replace each xenUnifiedError(...,VIR_ERR_NO_MEMORY call with a
	call to virReportOOMError.

Mon Jan 26 14:44:22 +0100 2009 Jim Meyering <meyering@redhat.com>

	* src/virterror.c (virErrorMsg): Correct indentation.

Fri Jan 23 11:07:42 PST 2009 John Levon <john.levon@sun.com>

	* src/xs_internal.c: fix recursive lock hang

Fri Jan 23 16:20:03 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Support driver format for setting disk
	file types
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c,
	tests/qemuxml2argvdata/qemuxml2argv-disk-drive-fmt-qcow.args,
	tests/qemuxml2argvdata/qemuxml2argv-disk-drive-fmt-qcow.xml:
	Add tests for <driver name='qemu' type='qcow2'/>

Fri Jan 23 17:13:47 +0100 2009 Jim Meyering <meyering@redhat.com>

	.cvsignore: Add explicit list of generated files.
	* .hgignore: Regenerate.
	* m4/.gitignore: Regenerate.

Fri Jan 23 14:22:03 +0100 2009 Jim Meyering <meyering@redhat.com>

	fix comment typo: s/contains/continues/
	* src/libvirt.c (virStorageVolFree): Correct typo in comment.

	qemud: don't dereference NULL on failed virGetUserDirectory
	* qemud/qemud.c (qemudInitPaths): Return right away,
	upon virGetUserDirectory failure.

Fri Jan 23 14:30:59 +0100 2009 Jim Meyering <meyering@redhat.com>

	m4: update from gnulib to avoid warnings from cutting-edge autoconf
	* gnulib/m4/errno_h.m4
	* gnulib/m4/gnulib-comp.m4
	* gnulib/m4/multiarch.m4

Fri Jan 23 14:30:59 +0100 2009 Jim Meyering <meyering@redhat.com>

	correct and tighten up .*ignore files
	* .cvsignore: Don't ignore *.orig or *.rej.  They're not build products.
	Don't ignore the entire m4 directory.
	* Makefile.maint (sync-vcs-ignore-files): Correct quoting.
	Use sed rather than a for loop.
	Search only version-controled files (for reproducibility)
	* gnulib/lib/netinet/.cvsignore: Append missing newline-at-EOF,
	so that the use of sed doesn't mistakenly concatenate lines.
	* gnulib/lib/sys/.cvsignore: Likewise.
	* m4/.cvsignore: Ignore acinclude.m4 and aclocal.m4, not *.m4.
	* .hgignore: Regenerate.
	* all .gitignore files: Regenerate.

Fri Jan 23 12:44:44 +0100 2009 Jim Meyering <meyering@redhat.com>

	maint: update list of error function names and adapt
	* Makefile.maint (msg_gen_function): Update list.
	Remove some now-unused names, add some new ones.
	* src/hash.c (virHashError): Remove unused definition.
	* src/openvz_conf.h (openvzLog): Likewise.
	* src/xen_unified.c: Mark newly-exposed diagnostics for translation.

Thu Jan 22 17:42:37 PST 2009 John Levon <john.levon@sun.com>

	* src/domain_conf.c, src/domain_conf.h, src/xend_internal.c,
	src/xm_internal.c: parse IP address for bridge interfaces

	* tests/sexpr2xmltest.c, tests/xml2sexprtest.c,
	tests/sexpr2xmldata/sexpr2xml-bridge-ipaddr.sexpr,
	tests/sexpr2xmldata/sexpr2xml-bridge-ipaddr.xml,
	tests/xml2sexprdata/xml2sexpr-bridge-ipaddr.sexpr,
	tests/xml2sexprdata/xml2sexpr-bridge-ipaddr.xml: add tests

Thu Jan 21 19:44:12 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Use the GNULIB random_r function
	* Makefile.maint: print 4 lines of context when complaining
	about prohibited POSIX apis
	* src/libvirt.c: Initialize random number generator
	* src/util.c, src/util.h: Generate API for random number gen
	* src/uuid.: Use generic random number generator API

Thu Jan 21 19:41:12 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Remove use of non-reentrant POSIX api calls
	* configure.in: Check for  strtok_r getmntent_r getgrnam_r getpwuid_r
	* proxy/libvirt_proxy.c: Remove initialize of obsolete fields
	* qemud/qemud.c: Use virGetUserDirectory instead of getpwuid()
	* src/libvirt_private.syms, src/util.c, src/util.h: Add a generic
	virGetUserDirectory call around getpwuid()
	* src/lxc_container.c, src/storage_backend_fs.c: Use getmntent_r()
	* src/network_driver.c, src/qemu_driver.c, src/storage_driver.c,
	src/remote_internal.c, src/uml_driver.c: Use virGetUserDirectory()
	* src/openvz_driver.c: Use strtok_r()
	* src/xen_unified.c, src/xen_unified.h, src/xend_internal.c:
	Replace gethostname() with getaddrinfo()

Thu Jan 22 20:17:35 +0100 2009 Jim Meyering <meyering@redhat.com>

	xm_internal.c: fix locking bug: s/Lock/Unlock/
	* src/xm_internal.c (xenXMDomainDefineXML): Release lock, (don't
	try to acquire it) upon failure, just before returning.

Thu Jan 22 10:35:03 PST 2009 John Levon <john.levon@sun.com>

	* gnulib/tests/.cvsignore: add test-random_r
	* Makefile.maint: generate .hgignore

	* gnulib/tests/.gitignore, .hgignore, m4/.gitignore: regenerate

Thu Jan 22 10:30:21 PST 2009 John Levon <john.levon@sun.com>

	* src/libvirt_private.syms: Remove non-existent
	virNetworkSaveConfigXML from linker script

Thu Jan 22 09:51:29 PST 2009 John Levon <john.levon@sun.com>

	* src/domain_conf.h, src/domain_conf.c, src/xend_internal.c,
	src/xm_internal.c: Support script for bridge interface type

	* tests/sexpr2xmldata/sexpr2xml-curmem.xml,
	tests/sexpr2xmldata/sexpr2xml-disk-block-shareable.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-localtime.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-parallel-tcp.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-file.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-null.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-pipe.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-pty.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-stdio.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-tcp-telnet.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-tcp.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-udp.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-serial-unix.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-sound-all.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-sound.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-usbmouse.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-usbtablet.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-utc.xml,
	tests/sexpr2xmldata/sexpr2xml-fv-v2.xml,
	tests/sexpr2xmldata/sexpr2xml-fv.xml,
	tests/sexpr2xmldata/sexpr2xml-net-bridged.xml,
	tests/sexpr2xmldata/sexpr2xml-net-e1000.xml: update tests

Thu Jan 22 18:18:12 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Missing test case fix up from Xen threadsafety changes
	* tests/sexpr2xmltest.c, tests/Makefile.am: Pass a real
	connection object into the xenDaemonParseSxprString()
	method, since it needs to use the priv object.

Thu Jan 22 09:23:53 PST 2009 John Levon <john.levon@sun.com>

	Least privilege support for Solaris
	* qemud/qemud.c: init privs and refuse non-privileged
	connections
	* src/remote_internal.c: don't attempt user daemon instance on
	Solaris
	* src/xen_internal.c, src/xen_internal.h, src/xen_unified.c,
	src/xend_internal.c, src/xs_internal.c: replace UID checks
	with privilege checks. Refuse to load the Xen driver unless
	we're libvirtd

Wed Jan 21 18:10:12 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Make Xen driver threadsafe
	* src/proxy_internal.c, src/xen_inotify.c, src/xen_internal.c,
	src/xen_unified.c, src/xen_unified.h, src/xend_internal.c,
	src/xm_internal.c, src/xs_internal.c, src/xs_internal.h: Add
	mutex locking of shared state

Wed Jan 21 10:48:12 IST 2009 Mark McLoughlin <markmc@redhat.com>

	If you un-install libvirt and re-install it, you get a warning
	from the post-install script:

	  Installing     : libvirt
	  ln: creating symbolic link `/etc/libvirt/qemu/networks/autostart/default.xml': File exists

	See https://bugzilla.redhat.com/462011

	* libvirt.spec.in: don't create networks/default.xml if it
	already exists.

Tue Jan 20 22:39:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Properly handle daemon restarts with storage driver
	* src/storage_backend_iscsi.c: Detect if already logged into
	an iSCSI target
	* src/storage_driver.c: Don't shutdown storage when daemon
	shuts down

Tue Jan 20 22:25:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Allow virtual networks to survive a daemon restart
	* libvirt.spec.in: Add conditional to allow disabling of network
	and remove mkdir of state directories now created in Makefile.am
	rules
	* src/bridge.c, src/bridge.h: Add a brHasBridge() method
	* src/libvirt_bridge.syms: Add brHasBridge
	* src/libvirt_private.syms: Add virNetworkConfigFile and
	virNetworkSaveConfigXML
	* src/network_conf.c, src/network_conf.h, src/network_driver.c:
	Write out state file containing live XML. Allow dnsmasq to
	store a PID file. Put dnsmasq in background. Remove obsolete
	dhcp-leasefile option which was a no-op

Tue Jan 20 22:12:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c, src/domain_conf.h: Support ac97 soundcard
	model
	* src/xend_internal.c: Remove unused APis and restrict the
	'all' device conversion to just sb16 + es1370
	* tests/sexpr2xmldata/sexpr2xml-fv-sound-all.xml: Revert earlier
	mistaken change which added pcspk device

Tue Jan 20 22:06:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* python/libvir.c, python/libvir.py: Use global thread
	local error variable for all exceptions.

Tue Jan 20 13:35:36 PST 2009 John Levon <john.levon@sun.com>

	* qemud/qemud.c: respect LIBVIRT_DEBUG when logging to syslog

Tue Jan 20 22:32:44 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/logging.c: fix openlog() ident lifetime for Solaris

Tue Jan 20 21:02:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Refresh GNULIB, adding new random_r module
	* bootstrap: Add random_r module
	* gnulib/lib/random_r.c, gnulib/m4/random_r.m4,
	gnulib/tests/test-random_r.c: New random_r module
	* gnulib/lib/.cvsignore, gnulib/lib/.gitignore, gnulib/lib/Makefile.am,
	gnulib/lib/arpa_inet.in.h, gnulib/lib/fseeko.c, gnulib/lib/gettimeofday.c,
	gnulib/lib/ioctl.c, gnulib/lib/poll.c, gnulib/lib/stdint.in.h,
	gnulib/lib/stdio.in.h, gnulib/lib/strerror.c, gnulib/lib/sys_stat.in.h,
	gnulib/lib/unistd.in.h, gnulib/lib/wchar.in.h: Refresh source
	* gnulib/m4/alloca.m4, gnulib/m4/codeset.m4, gnulib/m4/errno_h.m4,
	gnulib/m4/getaddrinfo.m4, gnulib/m4/gethostname.m4, gnulib/m4/getline.m4,
	gnulib/m4/getpass.m4, gnulib/m4/gettext.m4, gnulib/m4/gettimeofday.m4,
	gnulib/m4/gnulib-cache.m4, gnulib/m4/gnulib-common.m4,
	gnulib/m4/gnulib-comp.m4, gnulib/m4/iconv.m4, gnulib/m4/inet_ntop.m4,
	gnulib/m4/inet_pton.m4,	 gnulib/m4/intldir.m4, gnulib/m4/intlmacosx.m4,
	gnulib/m4/intmax.m4, gnulib/m4/intmax_t.m4, gnulib/m4/inttypes-pri.m4,
	gnulib/m4/inttypes_h.m4, gnulib/m4/lcmessage.m4, gnulib/m4/lib-ld.m4,
	gnulib/m4/lib-link.m4, gnulib/m4/lock.m4, gnulib/m4/longlong.m4,
	gnulib/m4/lstat.m4, gnulib/m4/malloc.m4, gnulib/m4/nls.m4,
	gnulib/m4/physmem.m4, gnulib/m4/po.m4, gnulib/m4/poll.m4,
	gnulib/m4/printf-posix.m4, gnulib/m4/printf.m4, gnulib/m4/progtest.m4,
	gnulib/m4/realloc.m4, gnulib/m4/sockets.m4, gnulib/m4/sockpfaf.m4,
	gnulib/m4/stdbool.m4, gnulib/m4/stdint.m4, gnulib/m4/stdint_h.m4,
	gnulib/m4/stdio_h.m4, gnulib/m4/strdup.m4, gnulib/m4/strndup.m4,
	gnulib/m4/strnlen.m4, gnulib/m4/strsep.m4, gnulib/m4/threadlib.m4,
	gnulib/m4/uintmax_t.m4, gnulib/m4/unistd_h.m4, gnulib/m4/vasnprintf.m4,
	gnulib/m4/wchar_t.m4, gnulib/m4/wint_t.m4, gnulib/tests/Makefile.am,
	 gnulib/tests/test-unistd.c: Refresh macros

Tue Jan 20 20:22:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Support domain events in test driver
	* tests/read-bufsiz: Set $srcdir & $abs_srcdir if running
	standalone

Tue Jan 20 19:49:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* .x-sc_prohibit_nonreentrant: Blacklist some places where
	use of non-threadsafe APIs are not neccessary to check
	* Makefile.am, Makefile.maint, Makefile.nonreentrant: Add
	check for non-reentrant safe API calls
	* Makefile.cfg: Temporarily disable non-reentrant check

Tue Jan 20 20:28:07 +0100 2009 Jim Meyering <meyering@redhat.com>

	don't ignore write failure
	* src/network_driver.c (networkEnableIpForwarding): This function
	would always return 1 (success).  Now it returns 0 upon write or
	close failure, being careful to preserve any errno from a write failure.
	Add comments.

Tue Jan 20 19:26:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c, qemud/qemud.h: Dynamic spawn/cleanup threads
	for processing RPC calls as number of clients changes

Tue Jan 20 19:24:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c, qemud/qemud.h, qemud/remote.c: Allow the
	processing of multiple concurrent RPC calls per client
	connection.
	* qemud/libvirtd.conf, qemud/libvirtd.aug,
	qemud/test_libvirtd.aug: Add config param for controlling
	number of requests per client.

Tue Jan 20 18:16:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Fix 2 misleading comments & potential
	NULL deference

Tue Jan 20 17:46:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Remove a use of strerror() in error
	reporting missed earlier

Tue Jan 20 17:33:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_inotify.c, src/xen_unified.c, src/xen_unified.h,
	src/xm_internal.c, src/xm_internal.h: Move statically
	declared data from XM driver into xenUnifiedPrivatePtr

Tue Jan 20 18:26:24 CET 2009 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: try to autodetect when rhel5 option should be
	  passed to configure

Tue Jan 20 17:15:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_inotify.c, src/xen_unified.h, src/xs_internal.c:
	Move statically declared data into xenUnifiedPrivatePtr
	struct

Tue Jan 20 16:59:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Make error reporting threadsafe by avoiding strerror()
	* autobuild.sh: Set mingw compile warnings to fail compile
	* configure.in: Check for strerror_r
	* po/POTFILES.in: Add src/xen_unified.c
	* src/virterror.c, src/virterror_internal.h,
	src/libvirt_private.syms: Add virReportSystemErrorFull and
	virReportOOMErrorFull convenience functions
	* src/domain_conf.c, src/lxc_container.c, src/lxc_controller.c,
	src/lxc_driver.c, src/network_conf.c, src/network_driver.c,
	src/nodeinfo.c, src/qemu_driver.c, src/remote_internal.c,
	src/storage_backend.c, src/storage_backend_disk.c,
	src/storage_backend_fs.c, src/storage_backend_iscsi.c,
	src/storage_backend_logical.c, src/storage_conf.c,
	src/storage_driver.c, src/test.c, src/uml_driver.c,
	src/util.c, src/xen_inotify.c, src/xen_internal.c,
	src/xen_unified.c, src/xend_internal.c, src/xm_internal.c:
	Remove use of strerror when reporting errors, in favour
	of virReportSystemError() and virReportOOMError()

Tue Jan 20 17:17:11 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: remove a warning when printing a file offset

Tue Jan 20 16:36:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Make RPC call dispatch threaded
	* src/libvirt_private.syms, src/util.h, src/util.c: Add
	a general virSetNonBlock() helper with portability to
	Win32
	* src/remote_internal.c: Re-factor I/O to allow RPC calls
	from multiple threads to be handled concurrently.

Tue Jan 20 17:08:20 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.h src/lxc_driver.c src/uml_driver.c: virDomainObj
	  doesn't need stdout and stderr fields anymore, patch from
	  Guido Günther

Tue Jan 20 16:48:00 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.h src/qemu_driver.c: use monitor fd for QEmu/KVM
	  domain shutdown and read saved vm status on libvirtd startup,
	  last 2 patches from Guido Günther finishing up the surviving the
	  libvirt daemon restart

Tue Jan 20 16:35:24 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/apibuild.py: fix the parser with another Win32 keyword
	* po/*: updated a couple of translations and regenerated

Tue Jan 20 14:50:58 CET 2009 Jim Meyering <meyering@redhat.com>

	fix "make syntax-check" failures
	* ChangeLog: Start with TAB, not 8 spaces.
	* src/virterror.c: Remove trailing spaces.

Tue Jan 20 12:25:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* configure.ac: Fix alignment of configuration summary output

Tue Jan 20 12:08:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	src/libvirt.c, src/libvirt_public.syms: Add new ref counting
	APIs for public objects: virConnectRef, virDomainRef,
	virNetworkRef, virStoragePoolRef, virStorageVolRef,
	virNodeDeviceRef

Tue Jan 20 12:03:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* tests/cpuset, tests/read-bufsiz, tests/start, tests/undefine,
	tests/vcpupin: Switch order of expected vs actual data in diff
	comparison, so output on failure makes sense.

Tue Jan 20 12:01:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Thread local error handling
	* src/datatypes.c: Don't reference global error object directly
	now that it is thread-local. Avoid passing 'conn' arg to error
	routines if we just determined that the pointer is invalid
	* src/datatypes.h: Add note about rules for locking when using
	virConnectPtr members
	* src/libvirt.c: Initialize error handling routines at startup.
	Adapt driver API methods to reset last error upon entry, and
	copy the global thread local error to the per-connection error
	upon exit
	* src/virterror.c, src/virterror_internal.h: Store the global
	error object in a thread local variable. Provide a API to copy
	the global error into a per-connection error object. Add an
	initialization routine to setup the thread local

Tue Jan 20 11:43:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Disable event watch when doing an
	RPC call to avoid bogus event loop wakeups which would
	block on a lock

Tue Jan 20 11:28:53 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Add locking to all public API entry
	points

Mon Jan 19 22:50:53 CET 2009 Guido Günther <agx@sigxcpu.org>

	daemonize qemu processes
	* src/qemu_driver.c (qemudStartVMDaemon): virExec qemu/kvm via
	  VIR_EXEC_DAEMON
	  (qemudShutdownVMDaemon): use virKillProcess, don't waitpid

Mon Jan 19 21:54:25 CET 2009 Guido Günther <agx@sigxcpu.org>

	save domstate as string in status file
	* src/domain_conf.c (virDomainState): add VIR_ENUM_IMPL
	* src/domain_conf.h (virDomainState): add VIR_ENUM_DECL
	* src/qemu_conf.c (qemudDomainStatusParseFile): parse state as string
	  (qemudDomainStatusFormat): write as string
	* src/libvirt_private.syms (virDomainStateTypeToString,
	  virDomainStateTypeFromString): add sympbols

Mon Jan 19 20:58:34 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c src/xend_internal.c: Relax NUMA checking
	  for RHEL-5 and change the detection stategy for default Xen
	  accesses, patch by Markus Armbruster

Mon Jan 19 20:47:18 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xm_internal.c: fix paravirt framebuffer
	  handling since it was backoprted for RHEL-5, patch by Markus
	  Armbruster

Mon Jan 19 19:10:08 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xm_internal.c: fix fully virt network
	  device configuration for Xen on RHEL-5, patch by Markus Armbruster

Mon Jan 19 18:31:56 CET 2009 Daniel Veillard <veillard@redhat.com>

	* configure.in: add a --with-rhel5-api configure option
	  for the Xen specific version of RHEL-5, patch by Markus Armbruster

Mon Jan 19 16:18:46 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c: two bug fixes coming from RHEL package
	  posted by Markus Armbruster
	* AUTHORS: adding Markus

Fri Jan 16 18:44:08 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: virsh-all and virsh-synopsis were not being run
	* tests/Makefile.am (test_scripts): Add two missing backslashes.

	tests: exercise a bug that could make virsh and libvirtd segfault
	* tests/define-dev-segfault: New file.
	* tests/Makefile.am (test_scripts): Add define-dev-segfault.

Fri Jan 16 11:48:41 EST 2009 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c: Fix segfault with console device back compat.

Thu Jan 15 20:12:19 GMT 2009  Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix bug when fork isn't available (Win32)

Thu Jan 15 20:06:19 GMT 2009  Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Reduce number of exit paths in APIs

Thu Jan 15 20:03:19 GMT 2009  Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Remove use of macros for accessing
	private data fields

Thu Jan 15 20:02:19 GMT 2009  Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix private data field access in
	several methods

Thu Jan 15 19:54:19 GMT 2009  Daniel P. Berrange <berrange@redhat.com>

	Provide a generic internal API for threads support
	* src/Makefile.am, src/threads.c, src/threads.h: Generic internal API for threads
	* src/threads-pthread.c, src/threads-pthread.h: UNIX pthreads impl
	* src/threads-win32.c, src/threads-win32.h: Win32 threads impl
	* src/internal.h: Remove unnneccessary pthreads macros
	* src/libvirt_private.syms: Add symbols for internal threads API
	* po/POTFILES.in: Add node_device_conf.c
	* proxy/Makefile.am: Add threads.c to build
	* qemud/qemud.c, qemud/qemud.h, qemud/remote.c, src/datatypes.c,
	src/datatypes.h, src/domain_conf.c, src/domain_conf.h,
	src/libvirt.c, src/logging.c, src/lxc_conf.h, src/lxc_driver.c,
	src/network_conf.c, src/network_conf.h, src/network_driver.c,
	src/node_device.c, src/node_device_conf.c, src/node_device_conf.h,
	src/node_device_devkit.c, src/node_device_hal.c, src/openvz_conf.c,
	src/openvz_conf.h, src/openvz_driver.c, src/qemu_conf.h,
	src/qemu_driver.c, src/storage_conf.c, src/storage_conf.h,
	src/storage_driver.c, src/test.c, src/uml_conf.h, src/uml_driver.c:
	Switch over to internal threads API instead of pthreads

Thu Jan 15 19:39:19 GMT 2009  Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: Implement virKill() for Win32 platform

Thu Jan 15 17:29:19 GMT 2009  John Levon  <levon@movementarian.org>

	* src/internal.h:
	* src/libvirt.c: Avoid passing NULL to printf %s specifier

Thu Jan 15 15:11:35 GMT 2009  John Levon  <levon@movementarian.org>

	* src/xend_internal.c: Improve xend_get error message

Thu Jan 15 01:31:45 GMT 2009  John Levon  <levon@movementarian.org>

	* src/xen_internal.c: implement capabilities parsing for Solaris

Thu Jan 15 01:22:32 GMT 2009  John Levon  <levon@movementarian.org>

	* src/xs_internal.c: Fix xs_unwatch() to correctly pass the
	token

Thu Jan 15 01:19:02 GMT 2009  John Levon  <levon@movementarian.org>

	* src/xen_unified.c:
	* src/xs_internal.c: Fix activeDomainList handling

Thu Jan 15 01:16:05 GMT 2009  John Levon  <levon@movementarian.org>

	* src/xen_unified.c: Fix ref-counting for Xen driver event
	registration

Wed Jan 14 17:30:54 GMT 2009  John Levon  <levon@movementarian.org>

	* docs/devhelp/Makefile.am: Fix devhelp build dependencies

Wed Jan 14 17:25:38 GMT 2009  John Levon  <levon@movementarian.org>

	* docs/devhelp/Makefile.am: Let devhelp build in a separate objdir.

Wed Jan 14 16:21:47 GMT 2009  John Levon  <levon@movementarian.org>

	* docs/Makefile.am:
	* docs/examples/Makefile.am:
	* docs/examples/index.py: remove references to non-existent
	files

Wed Jan 14 16:17:20 GMT 2009  John Levon  <levon@movementarian.org>

	* src/xend_internal.c: Add a ':cdrom' marker for PV as well as
	HVM devices.

Wed Jan 14 15:13:17 GMT 2009  John Levon  <levon@movementarian.org>

	* acinclude.m4:
	* m4/compiler-flags.m4: Some compilers (including GCC) don't set
	the return value consistently if an erroneous option is passed on
	the command line. Account for that.

Tue Jan 13 13:21:13 +0100 2009 Jim Meyering <meyering@redhat.com>

	qemud.c: fix error in yesterday's change: s/X_OK/R_OK/
	* qemud/qemud.c (main): Fix error s/X_OK/R_OK/ reported by
	Daniel Berrange.

Tue Jan 13 11:44:32 +0100 2009 Jim Meyering <meyering@redhat.com>

	* HACKING: Clarify "bool" vs. XDR/wire-format.

Mon Jan 12 22:07:57 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/index.html docs/index.html.in docs/relatedlinks.html
	  docs/relatedlinks.html.in: fix the QEmu links

Mon Jan 12 19:16:00 +0000 2009 Richard W.M. Jones <rjones@redhat.com>

	Fix invocation of rpcgen.
	* qemud/Makefile.am: Fix invocation of rpcgen, and make sure
	we run the right one.

Mon Jan 12 18:55:16 +0100 2009 Jim Meyering <meyering@redhat.com>

	tests: quiet virsh-all
	* tests/virsh-all: For now, ignore diagnostics and exit status,
	when running all virsh commands.

Mon Jan 12 18:55:16 +0100 2009 Jim Meyering <meyering@redhat.com>

	diagnose "libvirtd --config=no-such-file"
	* qemud/qemud.c (remoteReadConfigFile): Don't return 0 (success)
	when the config file is unreadable or nonexistent
	Return -1, not 0, upon virConfReadFile failure.
	(main): If remote_config_file is not specified via --config(-f),
	use the default config file only if it exists.  Otherwise,
	use /dev/null.
	* src/conf.c (virConfReadFile): Don't diagnose virFileReadAll
	failure, since it already does that.

Mon Jan 12 18:55:15 +0100 2009 Jim Meyering <meyering@redhat.com>

	fix non-srcdir build failure
	* qemud/Makefile.am (check-local): Prefix use of test_libvirtd.aug
	with $(srcdir)/.  Add quotes around $(AUGPARSE), in case it expands
	to something unusual.

Mon Jan 12 16:07:32 CET 2009 Daniel Veillard <veillard@redhat.com>

	* docs/formatdomain.html.in docs/libvirt.rng docs/formatdomain.html:
	  document the new PCI passthrough format
	* tests/qemuxml2argvtest.c tests/qemuxml2xmltest.c
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-pci-address.args
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-pci-address.xml:
	  and add a regression test for it.

Sun Jan 11 12:18:38 CET 2009 Guido Günther<agx@sigxcpu.org>

	* src/qemu_driver.c (qemudLogFD): use snprintf instead of emulating it

Sun Jan 11 12:16:44 CET 2009 Guido Günther <agx@sigxcpu.org>

	split out opening of the qemu logfile
	* src/qemu_driver.c (qemudLogFD): new function
	  (qemudStartVMDaemon): call qemudLogFD

Fri Jan  9 18:29:11 GMT 2009  John Levon  <levon@movementarian.org>

	* src/logging.h: fix non-debug compile

Thu Jan  8 20:28:06 GMT 2009  John Levon  <levon@movementarian.org>

	Fixups after gnulib refresh
	* configure.in: search -lnsl for xdr functions
	* qemud/Makefile.am: link in $(LIBSOCKET)
	* tests/Makefile.am: link in $(LIBSOCKET)

Thu Jan  8 20:47:26 CET 2009 Guido Günther <agx@sigxcpu.org>

	add missing flags argument
	* src/xend_internal.c (xenDaemonAttachDevice, xenDaemonDetachDevice):
	  Add missing flags argument
	* src/xm_internal.c (xenXMDomainDefineXML, xenXMDomainAttachDevice,
	  xenXMDomainDetachDevice): Likewise
	* tests/xmconfigtest.c (testCompareParseXML): Likewise
	* tests/xml2sexprtest.c (testCompareFiles): Likewise

Thu Jan  8 14:41:55 CET 2009 Guido Günther <agx@sigxcpu.org>

	pass flags argument to all virDomain*DefParse* functions
	* src/domain_conf.c (virDomainDiskDefParseXML,
	  virDomainFSDefParseXML, virDomainNetDefParseXML,
	  virDomainChrDefParseXML, virDomainSoundDefParseXML,
	  virDomainHostdevSubsysUsbDefParseXML, virDomainHostdevDefParseXML,
	  virDomainDefParseString): Add and pass on flags argument
	* src/domain_conf.h (virDomainDeviceDefParse,
	  virDomainDefParseString): Add flags argument
	* src/lxc_driver.c (lxcDomainDefine): Pass VIR_DOMAIN_XML_INACTIVE
	* src/openvz_driver.c (openvzDomainDefineXML): Likewise
	* src/qemu_driver.c (qemudDomainCreate, qemudDomainRestore,
	  qemudDomainDefine, qemudDomainAttachDevice): Likewise
	* src/test.c (testOpenDefault, testDomainCreateXML, testDomainRestore,
	  testDomainDefineXML): Likewise
	* src/uml_driver.c (umlDomainCreate, umlDomainDefine): Likewise
	* src/xend_internal.c (xenDaemonCreateXML, xenDaemonDomainCreateXML):
	  Likewise
	* tests/qemuxml2xmltest.c (testCompareXMLToXMLFiles): Likewise

Thu Jan  8 09:48:04 CET 2009 Daniel P. Berrange <berrange@redhat.com>

	poll: don't return uninitialized
	* gnulib/lib/poll.c (poll) [WIN32_NATIVE]: Initialize "rc".
	[sync from gnulib also adjusts cpp indentation to reflect nesting.]

Wed Jan  7 17:12:33 +0100 2009 Jim Meyering <meyering@redhat.com>

	add more files pulled in via yesterday's gnulib upgrade
	* gnulib/m4/multiarch.m4: New file.
	* gnulib/m4/hostent.m4: New file.
	* gnulib/m4/servent.m4: New file.
	* .x-sc_prohibit_gethostby: Exempt all gnulib/m4/* files, so
	hostent.m4's uses of gethostbyname and gethostbyaddr do not
	trigger a "make syntax-check" failure.

	bootstrap: pull in gnulib's ioctl module
	* bootstrap: Invoke gnulib-tool with its --no-vc-files
	option, since we version-control the files it imports.
	This tells it not to mark imported files as cvs-ignored.
	(modules): Add ioctl.
	* gnulib/lib/ioctl.c: New file.
	* gnulib/lib/sys_ioctl.in.h: New file.
	* gnulib/tests/sys_ioctl.in.h: Removed.
	* gnulib/tests/ioctl.c: Removed.
	* gnulib/lib/Makefile.am: Update.
	* gnulib/m4/gnulib-cache.m4: Likewise.
	* gnulib/m4/gnulib-comp.m4: Likewise.
	* gnulib/tests/Makefile.am: Likewise.
	* gnulib/lib/.cvsignore: Ignore sys_ioctl.h.
	* gnulib/lib/.gitignore: Regenerate.

	ignore generated libvirtd.logrotate.
	* qemud/.cvsignore: Add libvirtd.logrotate.
	* qemud/.gitignore: Regenerate.

Wed Jan  7 13:54:05 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c src/qemu_conf.c: implement PCI passthrough
	  for recent KVM versions in a similar way to USB, patch by
	  Jason Krieg. Some cleanups and reformating too.

Wed Jan  7 11:54:06 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/openvz_driver.c: fix the mac addresses generation for
	  OpenVZ veth devices, patch by Evgeniy Sokolov

Wed Jan  7 11:38:04 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/libvirt_private.syms src/qemu_driver.c src/test.c
	  src/uml_driver.c src/util.c src/util.h src/xen_unified.c:
	  unify hostname lookup using virGetHostname convenience function,
	  patch by David Lutterkort

Tue Jan  6 20:38:23 +0100 2009 Jim Meyering <meyering@redhat.com>

	update from gnulib; use its time_r module for localtime_r on mingw
	* bootstrap (modules): Add time_r.
	* gnulib/m4/time_h.m4: New file.
	* gnulib/m4/time_r.m4: New file.
	* gnulib/lib/time_r.c: New file.
	* gnulib/tests/test-time.c: New file.
	* gnulib/lib/time.in.h: New file.
	* gnulib/lib/Makefile.am: Update.
	* gnulib/lib/fseeko.c: Likewise.
	* gnulib/lib/lstat.c: Likewise.
	* gnulib/lib/netdb.in.h: Likewise.
	* gnulib/lib/stdint.in.h: Likewise.
	* gnulib/lib/stdlib.in.h: Likewise.
	* gnulib/lib/sys_select.in.h: Likewise.
	* gnulib/lib/sys_stat.in.h: Likewise.
	* gnulib/lib/sys_time.in.h: Likewise.
	* gnulib/lib/unistd.in.h: Likewise.
	* gnulib/lib/wchar.in.h: Likewise.
	* gnulib/m4/codeset.m4: Likewise.
	* gnulib/m4/errno_h.m4: Likewise.
	* gnulib/m4/extensions.m4: Likewise.
	* gnulib/m4/getaddrinfo.m4: Likewise.
	* gnulib/m4/gettext.m4: Likewise.
	* gnulib/m4/glibc2.m4: Likewise.
	* gnulib/m4/glibc21.m4: Likewise.
	* gnulib/m4/gnulib-cache.m4: Likewise.
	* gnulib/m4/gnulib-comp.m4: Likewise.
	* gnulib/m4/iconv.m4: Likewise.
	* gnulib/m4/include_next.m4: Likewise.
	* gnulib/m4/intdiv0.m4: Likewise.
	* gnulib/m4/intlmacosx.m4: Likewise.
	* gnulib/m4/intmax.m4: Likewise.
	* gnulib/m4/inttypes-pri.m4: Likewise.
	* gnulib/m4/inttypes_h.m4: Likewise.
	* gnulib/m4/lcmessage.m4: Likewise.
	* gnulib/m4/lib-link.m4: Likewise.
	* gnulib/m4/lstat.m4: Likewise.
	* gnulib/m4/netdb_h.m4: Likewise.
	* gnulib/m4/nls.m4: Likewise.
	* gnulib/m4/po.m4: Likewise.
	* gnulib/m4/printf-posix.m4: Likewise.
	* gnulib/m4/printf.m4: Likewise.
	* gnulib/m4/progtest.m4: Likewise.
	* gnulib/m4/size_max.m4: Likewise.
	* gnulib/m4/sockets.m4: Likewise.
	* gnulib/m4/stdint.m4: Likewise.
	* gnulib/m4/stdint_h.m4: Likewise.
	* gnulib/m4/sys_ioctl_h.m4: Likewise.
	* gnulib/m4/threadlib.m4: Likewise.
	* gnulib/m4/uintmax_t.m4: Likewise.
	* gnulib/m4/visibility.m4: Likewise.
	* gnulib/m4/wchar.m4: Likewise.
	* gnulib/m4/wchar_t.m4: Likewise.
	* gnulib/m4/wint_t.m4: Likewise.
	* gnulib/m4/xsize.m4: Likewise.
	* gnulib/tests/Makefile.am: Likewise.
	* gnulib/tests/sockets.h: Likewise.
	* gnulib/tests/.cvsignore: Likewise.
	* gnulib/tests/.gitignore: Likewise.
	* tests/.gitignore: Likewise.
	* docs/examples/.gitignore: Likewise.
	* gnulib/lib/.cvsignore: Likewise.
	* gnulib/lib/.gitignore: Likewise.

	remove files associated with obsolete strpbrk module
	* gnulib/lib/strpbrk.c: Remove file.
	* gnulib/m4/strpbrk.m4: Remove file.

Tue Jan  6 17:52:22 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	Misc windows / mingw portability fixes
	* src/logging.c: Add include of unistd.h for close() prototype
	* src/logging.h: Add a VIR_ prefix on logging macros to
	avoid clash with Windows.h symbols for ERROR()
	* tests/nodeinfotest.c: Annotate unused attribute
	* src/test.c: Annotate unused attributes when missing
	pthreads
	* qemud/remote.c, qemud/qemud.c: Use VIR_ prefix on
	logging macro calls
	* qemud/remote_protocol.c, qemud/rpcgen_fix.pl: Add cast
	to workaround odd portablexdr XDR_INLINE return type

Tue Jan  6 18:44:34 CET 2009 Guido Günther <agx@sigxcpu.org>

	add virKillProcess
	* src/util.[ch] (virKillProcess): new function
	* src/libvirt_private.syms: add symbol

Tue Jan  6 18:14:31 CET 2009 Guido Günther <agx@sigxcpu.org>

	trivial cleanups
	* src/qemu_driver.c (qemudGetMaxVCPUs): we have kvmGetMaxVCPUs(), so
	  the comment can go
	* src/qemu_driver.c (qemudDomainDetachDevice): fix error message
	* AUTHORS: fix spelling and suggest UTF-8 encoding
	* docs/apps.html.in: minor typo

Tue Jan  6 18:12:38 CET 2009 Guido Günther <agx@sigxcpu.org>

	* .gitignore: ignore generated TAGS files

Tue Jan  6 17:18:10 CET 2009 Daniel Veillard <veillard@redhat.com>

	* AUTHORS: John Levon is now a commiter

Tue Jan  6 16:21:24 CET 2009 Jim Meyering <meyering@redhat.com>

	fix "make dist" (from scratch) failure
	* src/Makefile.am (EXTRA_DIST): Don't distribute libvirt_sym.version,
	now that it's been removed.  Spotted by Daniel Veillard.

	dist: distribute all libvirt_*.syms files, ...
	* src/Makefile.am (EXTRA_DIST): Distribute all libvirt_*.syms files,
	not just those that happen to be selected at configure time.

Tue Jan  6 10:47:33 CET 2009 Jim Meyering <meyering@redhat.com>

	avoid syntax-check (po-check) failure due to FP match on gettext.m4
	* Makefile.maint (po-check): Exclude .m4 files.

Tue Jan  6 10:45:04 CET 2009 Daniel Veillard <veillard@redhat.com>

	* qemud/remote.c: fix compilation without SASL, patch by John Levon

Tue Jan  6 09:46:43 CET 2009 Daniel Veillard <veillard@redhat.com>

	* po/*: updated polish and brazilian translations, regenerated
	  files, pushed new pot to translators

Tue Jan  6 09:42:34 CET 2009 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_fs.c: Make mntent.h specific to the FS storage
	  backend, patch by John Levon

Mon Jan  5 2009 14:53:48 CET John Levon <john.levon@sun.com>

	split up linker script, as described below and in
	  http://thread.gmane.org/gmane.comp.emulators.libvirt/10728

	split version script into multiple files
	* src/Makefile.am (PRIVSYMFILES): Define.
	(EXTRA_DIST): Append $(PRIVSYMFILES).
	(libvirt.syms): New rule.
	Reflect renaming: s/libvirt_sym.version/libvirt.syms/.
	(BUILT_SOURCES): Depend on libvirt.syms.
	* configure.in: Define ENABLE_DEBUG as an automake conditional.
	(AC_OUTPUT): Remove src/libvirt_sym.version.
	* src/.cvsignore: s/libvirt_sym.version/libvirt.syms/.
	* src/.gitignore: Regenerate.
	* src/libvirt_public.syms: Renamed from src/libvirt_sym.version.in.
	* src/libvirt_debug.syms: New file.
	* src/libvirt_private.syms: New file.

	Move --with-driver-modules symbols into a separate sym file
	* src/Makefile.am (PRIVSYMFILES): Append libvirt_driver_modules.syms.
	* src/libvirt_private.syms: Move virDriverLoadModule into...
	* src/libvirt_driver_modules.syms: ... this new file.

	Move bridge symbols into a separate syms file
	* configure.in: Provide a new --with-bridge option.
	* src/Makefile.am (PRIVSYMFILES) [WITH_BRIDGE]: Append
	libvirt_bridge.syms.
	* src/bridge.c: Test WITH_BRIDGE rather than particular drivers.
	* src/libvirt_private.syms: Move bridge-related symbols into...
	* src/libvirt_bridge.syms: ...this new file.

	migrate linux-specific symbol names into their own sym file
	* configure.in (WITH_LINUX): New automake conditional.
	* src/Makefile.am (PRIVSYMFILES) [WITH_LINUX]: Append libvirt_linux.syms.
	* src/libvirt_private.syms: Move two symbol names into...
	* src/libvirt_linux.syms: ...this new file.

	Remove storage backend symbols from version script
	* src/libvirt_private.syms: Remove virStorageBackend* symbol names.
	They're linked into qemud, not libvirt.
	Author: John Levon

Mon Jan  5 14:22:06 CET 2009 Jim Meyering <meyering@redhat.com>

	avoid xgettext warning aboug bug-reporting address
	* po/Makevars (MSGID_BUGS_ADDRESS): Set, to avoid xgettext warning.
	* po/libvirt.pot: Set bug-reporting address.

	avoid bogus descriptions due to use of gettext with the empty string
	* src/virsh.c: Use `""', not `gettext_noop("")', in numerous
	vshCmdInfo definitions.  The latter provokes a warning from gettext.

	Makefile.maint: sync from coreutils

Mon Jan  5 12:54:21 GMT 2009 Daniel P. Berrange <berrange@redhat.com>

	* src/nodeinfo.c: s/uint64_t/unsigned long/ for the
	numa_node_to_cpus() API call.

Mon Jan  5 09:11:21 CET 2009 Jim Meyering <meyering@redhat.com>

	* Makefile.maint (msg_gen_function): Add to the list.

	mark a few diagnostics for translation
	* src/xen_inotify.c (xenInotifyXendDomainsDirLookup): Mark a diagnostic.
	(xenInotifyXendDomainsDirRemoveEntry, xenInotifyOpen): Likewise.

	HACKING: mention bool and other scalar types, const-correctness

Fri Dec 26 14:22:04 CET 2008 Guido Günther <agx@sigxcpu.org>

	document vnc's keymap attribute
	* docs/formatdomain.html.in: document keymap attribute
	* docs/drvqemu.html.in: add keymap attribute to example

Tue Dec 23 14:44:41 CET 2008 Daniel Veillard <veillard@redhat.com>

	* docs/logging.html docs/logging.html.in: new page documenting
	  the logging system
	* docs/auth.html docs/deployment.html docs/remote.html
	  docs/sitemap.html docs/sitemap.html.in docs/uri.html
	  docs/windows.html: integration in the existing set

Tue Dec 23 14:38:30 CET 2008 Guido Günther <agx@sigxcpu.org>

	* .x-sc_prohibit_asprintf: new file

Tue Dec 23 13:39:48 CET 2008 Guido Günther <agx@sigxcpu.org>

	use virAsprintf instead of asprintf
	* .x-sc_prohibit_asprintf, Makefile.maint (sc_prohibit_asprintf): new
	rule
	* src/cgroup.c, src/domain_conf.c, src/driver.c, src/libvirt.c,
	src/logging.c, src/lxc_container.c, src/lxc_controller.c,
	src/lxc_driver.c, src/network_conf.c, src/network_driver.c,
	src/openvz_conf.c, src/qemu_conf.c, src/qemu_driver.c,
	src/remote_internal.c, src/stats_linux.c, src/storage_backend_iscsi.c,
	src/storage_driver.c, src/uml_conf.c, src/uml_driver.c, src/util.c,
	src/veth.c, src/virsh.c, src/xm_internal.c: use virAsprintf instead of
	asprintf

Mon Dec 22 11:33:16 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/storage_driver.c: Fix storage driver null dereference.

Mon Dec 22 11:27:52 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/virsh.c: Merge xml building for virsh pool-*-as

Mon Dec 22 17:13:42 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c qemud/test_libvirtd_qemu.aug tests/Makefile.am
	  tests/daemon-conf: fix make check with the new logging support
	  the messages now carry a timestamp which need to be removed,
	  the daemon needs to exit if the log configuration informations
	  are wrong and we also look at the LIBVIRT_DEBUG environment
	  variable

Mon Dec 22 14:07:29 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/mdns.c: fix a compilation problem in the switch

Mon Dec 22 13:56:13 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/libvirtd.aug qemud/libvirtd.conf: document the new
	  options in the config file and augment the Augeas description

Mon Dec 22 13:54:30 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/event.c qemud/mdns.c qemud/remote.c: switch other pieces
	  of the daemon to the new logging infrastructure

Mon Dec 22 13:51:48 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c qemud/qemud.h: replace the daemon old logging
	  infrastructure with the new one and parse configuration options

Mon Dec 22 11:51:29 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/uml_conf.c: another logging conversion

Mon Dec 22 11:47:44 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/node_device_devkit.c src/uml_driver.c src/virterror.c:
	  convert old logging to the new API

Mon Dec 22 11:45:07 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: convert entry points to new logging

Mon Dec 22 11:43:04 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/logging.h src/logging.c: commited the more recent version
	  with function name and line number

Mon Dec 22 11:33:07 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/logging.h src/logging.c: add the infrastructure and internal
	  APIs for logging, some of those APIs should be made public later
	* src/libvirt_sym.version.in: flag the internal APIs as such

Mon Dec 22 11:31:08 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.h: remove tabs to fix make synatx-check
	  and fix the indentation

Sun Dec 21 19:50:16 +0100 2008 Jim Meyering <meyering@redhat.com>

	make NUMA-initialization code more portable and more robust
	qemudCapsInitNUMA and umlCapsInitNUMA were identical, so this change
	factors them into a new function, virCapsInitNUMA, and puts it in
	nodeinfo.c.

	In addition to factoring out the duplicates, this change also
	adjusts that function definition (along with its macros) so
	that it works with Fedora 9's numactl version 1, and makes it
	so the code will work even if someone builds the kernel with
	CONFIG_NR_CPUS > 4096.

	Finally, also perform this NUMA initialization for the lxc
	and openvz drivers.

	* src/nodeinfo.c: Include <stdint.h>, <numa.h> and "memory.h".
	(virCapsInitNUMA): Rename from qemudCapsInitNUMA and umlCapsInitNUMA.
	(NUMA_MAX_N_CPUS): Define depending on NUMA API version.
	(n_bits, MASK_CPU_ISSET): Define, adjust, use uint64 rather than long.
	* src/nodeinfo.h: Include "capabilities.h".
	(virCapsInitNUMA): Declare it.
	* examples/domain-events/events-c/Makefile.am:
	* src/Makefile.am: Add $(NUMACTL_CFLAGS) and $(NUMACTL_LIBS) to various
	compile/link-related variables.
	* src/qemu_conf.c: Include "nodeinfo.h".
	(qemudCapsInitNUMA): Remove duplicate code.  Adjust caller.
	* src/uml_conf.c (umlCapsInitNUMA): Likewise.
	Include "nodeinfo.h".
	* src/lxc_conf.c: Include "nodeinfo.h".
	(lxcCapsInit): Perform NUMA initialization here, too.
	* src/openvz_conf.c (openvzCapsInit): And here.
	Include "nodeinfo.h".
	* src/libvirt_sym.version.in: Add virCapsInitNUMA so that libvirtd
	can link to this function.

Sun Dec 21 19:46:35 +0100 2008 Jim Meyering <meyering@redhat.com>

	* src/node_device_hal.c: Include <config.h> before everything else.

Sun Dec 21 00:20:51 CET 2008 Guido Günther <agx@sigxcpu.org>

	avoid "make check" failures due to localized error messages
	* tests/Makefile.am (TESTS_ENVIRONMENT): set LC_ALL=C

Sat Dec 20 14:10:09 CET 2008 Guido Günther <agx@sigxcpu.org>

	save and remove kvm/qemu domain status
	* src/qemu_driver.c (qemdRemoveDomainStatus): new function
	  (qemudOpenMonitor): save monitor path
	  (qemudStartVMDaemon, qemudDomainSuspend, qemudDomainResume,
	   qemudDomainAttachDevice, qemudDomainDetachDevice): save status
	  (qemudShutdownVMDaemon): remove status

Sat Dec 20 13:53:14 CET 2008 Guido Günther <agx@sigxcpu.org>

	add XML parsing for qemu/kvm status files
	* src/domain_conf.c, src/domain_conf.h (virDomainSaveXML): new function
	* src/domain_conf.c (virDomainSaveConfig): split out XML writing into
	  virDomainSaveXML
	* src/qemu_conf.c (qemudDomainStatusParseFile): new function to parse
	  status XML
	  (qemudDomainStatusFormat): new function to format status XML
	  (qemudSaveDomainStatus): new function to write status XML, uses
	  virDomainSaveXML
	* src/libvirt_sym.version.in: add virBufferEscapeString, virDomainSaveXML,
	  virXPathNode symbols

Fri Dec 19 10:41:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	* docs/formatdomain.html.in: Fix documentation typo
	  (aozturk in #virt).

Thu Dec 18 17:46:06 CET 2008 Guido Günther <agx@sigxcpu.org>

	* src/qemu_driver.c (qemudDomainAttachDevice): only
	  free dev on failure

Thu Dec 18 16:13:56 CET 2008 Guido Günther <agx@sigxcpu.org>

	Let qemu/kvm instances write a pid file
	* src/utilc, src/util.h (virFilePid): declare and define
	  (virFileWritePid, virFileReadPid, virFileDeletePid): use virFilePid
	* src/libvirt_symver.in: export virFilePid symbol
	* src/qemu_conf.c (qemudBuildCommandLine): pass -pidfile to qemu
	  (qemudStartup): create stateDir
	* tests/qemuxml2argvtest.c: initialize driver.stateDir
	* tests/qemuxml2argvdata/qemuxml2argv-*.args: add -pidfile argument

Thu Dec 18 12:18:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* examples/domain-events/events-c/event-test.c,
	python/types.c: Replace __FUNCTION__ with __func__ for
	better portability (John Levon)

Thu Dec 18 12:18:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix gcc-ism in python build (John Levon)
	* acinclude.m4: Add -Wno-redundant-decls check for compiler
	* python/Makefile.am: Remove hardcoded -Wno-redundant-decls

Thu Dec 18 12:11:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Don't free event after queueing it
	unless error occurred (David Lively)

Thu Dec 18 12:07:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Fix error return value
	* tests/nodeinfotest.c: Disable code compile completely on
	non-linux (John Levon)

Thu Dec 18 11:59:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Fix unused variable compile warning when polkit
	is disabled (John Levon)

Thu Dec 18 11:56:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Use pid_t for all PID tracking variables (John Levon)
	* src/openvz_driver.c, src/proxy_internal.h, src/remote_internal.c,
	src/storage_backend.c, src/uml_driver.c, src/util.c, src/util.h:
	s/int/pid_t/

Thu Dec 18 11:54:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Don't munge default network XML if
	uuidgen is not present (John Levon)

Thu Dec 18 11:50:58 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Misc daemon bug fixes (John Levon)
	* qemud/qemud.c: Fix conditional for node devices
	* qemud/remote.c: Remove unneccessary path.h include

Thu Dec 18 07:47:58 +0100 2008 Jim Meyering <meyering@redhat.com>

	docs/virsh.pod: typo fix

Thu Dec 18 07:44:07 +0100 2008 Jim Meyering <meyering@redhat.com>

	Makefile.maint: use $(srcdir), not $(top_srcdir)

Wed Dec 17 21:49:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix unreachable return statement
	(John Levon)

Wed Dec 17 21:45:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Use correct type for domain events callbacks args (John Levon)
	* src/driver.h, src/qemu_driver.c, src/remote_internal.c,
	src/xen_unified.c: s/void */virConnectDomainEventCallback/
	for domain events callbacks

Wed Dec 17 21:41:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_sym.version.in: Remove non-existant symbols
	(John Levon)

Wed Dec 17 21:35:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Portability of ELF version script to Solaris (John Levon)
	* configure.ac: Check linker flag used to set versioning
	script for ELF
	* src/Makefile.am: Use platform specific linker flag for
	version script as per configure test
	* src/libvirt_sym.version.in: Switch to '#' for comments

Wed Dec 17 21:30:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix conditional checks for Solaris platform (John Levon)
	* src/xen_internal.c, src/xen_unified.c, src/xs_internal.c:
	s/__sun__/__sun/

Wed Dec 17 21:17:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix Xen sub-drivers' 'open' method return type (John Levon)
	* src/proxy_internal.c, src/remote_internal.c, src/test.c,
	src/xen_inotify.c, src/xen_inotify.h, src/xen_internal.c,
	src/xen_internal.h, src/xen_unified.c, src/xend_internal.c,
	src/xend_internal.h, src/xm_internal.c, src/xm_internal.h,
	src/xs_internal.c, src/xs_internal.h: s/int/virDrvOpenStatus/

Wed Dec 17 21:10:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Mutex / crash fixes to openvz driver (Anton Protopopov)
	* src/openvz_driver.c: Fix crash with setting CPU value
	during define
	* src/openvz_conf.c: Initialize the domain mutex when
	loading config files

Wed Dec 17 20:53:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c, src/node_device_conf.c, src/node_device_conf.h,
	src/storage_conf.c, src/storage_conf.h: Remove trailing semi-colon
	causing empty statement compile warnings on solaris (John
	Levon).

Wed Dec 17 18:10:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Anonymous union fixes for non-GCC compilers (John Levon)
	* src/domain_conf.c, src/qemu_conf.c, src/qemu_driver.c: Remove use
	of anonymous union
	* src/domain_conf.h: Give a name to the anonymous union for
	host devices. Add 'dummy' field to avoid empty struct
	* src/remote_internal.c: Remove gcc-ism in empty "x ? : y"

Wed Dec 17 19:06:53 +0100 2008 Jim Meyering <meyering@redhat.com>

	portability: don't include <endian.h> or <byteswap.h>
	* src/storage_backend_fs.c: Don't include <endian.h> or <byteswap.h>.
	(LV_BIG_ENDIAN, LV_LITTLE_ENDIAN): Define.
	Use those instead of __BIG_ENDIAN and __LITTLE_ENDIAN.

Wed Dec 17 18:03:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c, src/util.c, tests/testutils.c: Remove use
	of _PATH_DEVNULL in favour of "/dev/null" for portability
	(John Levon)

Wed Dec 17 18:10:51 +0100 2008 Jim Meyering <meyering@redhat.com>

	enforce the "include <config.h> first" rule
	* qemud/Makefile.am: Ensure that the generated remote_protocol.c
	includes <config.h> first.
	* Makefile.maint (sc_require_config_h_first): New rule, so that
	"make syntax-check" enforces this.
	* .x-sc_require_config_h_first: New file.
	* Makefile.am (.x-sc_require_config_h_first): Add it.
	* qemud/remote_protocol.x: Don't include <config.h> here.
	* qemud/remote_protocol.c: Regenerate.

Wed Dec 17 18:10:51 +0100 2008 Jim Meyering <meyering@redhat.com>

	let gcc's -Wformat do its job; avoid "make syntax-check" failure
	* src/util.c (virAsprintf): Remove trailing space.
	* src/util.h (virAsprintf): Use ATTRIBUTE_FORMAT.
	* HACKING (Printf-style functions): New section.

Wed Dec 17 16:43:39 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Add missing checks for read-only connection
	flag (CVE-2008-5086)

Wed Dec 17 17:07:39 CET 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in: detect syslog.h

Wed Dec 17 09:28:15 CET 2008 Guido Günther <agx@sigxcpu.org>

	* Makefile.maint: use $(top_srcdir) for m4/ and $(VC_LIST)

Wed Dec 17 08:02:01 +0100 2008 Jim Meyering <meyering@redhat.com>

	fix numa-related (and kernel-dependent) test failures
	This change is required on some kernels due to the way a change in
	the kernel's CONFIG_NR_CPUS propagates through the numa library.
	* src/qemu_conf.c (qemudCapsInitNUMA): Pass numa_all_cpus_ptr->size/8
	as the buffer-length-in-bytes in the call to numa_node_to_cpus, since
	that's what is required on second and subseqent calls.
	* src/uml_conf.c (umlCapsInitNUMA): Likewise.

Tue Dec 16 17:26:49 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Sanitize qemu monitor reads.

Mon Dec 15 21:05:56 CET 2008 Guido Günther <agx@sigxcpu.org>

	Add virAsprintf as safer asprintf helper
	* src/util.c, src/util.h (virAsprintf): new function
	* src/libvirt_symver.in: export symbol

Mon Dec 15 16:33:25 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_driver.c: fix a segfault, patch by Miloslav TrmaC

Mon Dec 15 10:59:19 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Unlock domain object after fetching
	it to avoid deadlock when re-loading configs

Fri Dec 12 17:41:19 +0100 2008 Jim Meyering <meyering@redhat.com>

	remove redundant optname arguments
	This is the second part of the change mentioned here:

	  http://thread.gmane.org/gmane.comp.emulators.libvirt/10331

	It removes the essentially redundant "optname" parameter
	from each of the vshCommandOptNetworkBy and vshCommandOptDomainBy
	functions as well as the correspond macros (without "By" suffix).
	Now, instead of always passing the optname, "domain", to
	vshCommandOptDomainBy, that function requires that its command
	argument refer to an opts array containing a "domain" option.

	This normalization makes one more help-related change:
	it renames the net-start "name" argument to the more
	sensible and consistent "network".
	* src/virsh.c (VSH_BYNAME, vshCommandOptDomain)
	(cmd_has_option): New function, used in vshCommandOptDomainBy
	and vshCommandOptNetworkBy.
	(vshCommandOptDomainBy, vshCommandOptNetworkBy): Remove the optname
	parameter, it's always "domain" ("network").  Update all callers.
	Call cmd_has_option.
	(vshCommandOptNetwork, cmdAutostart, cmdConsole, cmdDomstate)
	(cmdDomblkstat, cmdDomIfstat, cmdSuspend, cmdUndefine, cmdStart)
	(cmdSave, cmdSchedinfo, cmdDump, cmdResume, cmdShutdown)
	(cmdReboot, cmdDestroy, cmdDominfo, cmdVcpuinfo, cmdVcpupin)
	(cmdSetvcpus, cmdSetmem, cmdSetmaxmem, cmdDumpXML, cmdDomname)
	(cmdDomid, cmdDomuuid, cmdMigrate, cmdNetworkAutostart)
	(cmdNetworkDestroy, cmdNetworkDumpXML, cmdNetworkName)
	(opts_network_start, cmdNetworkStart, cmdNetworkUndefine)
	(cmdNetworkUuid, cmdVNCDisplay, cmdTTYConsole, cmdAttachDevice)
	(cmdDetachDevice, cmdAttachInterface, cmdDetachInterface)
	(cmdAttachDisk, cmdDetachDisk, cmdEdit)
	* src/Makefile.am (virsh-pool-edit.c): This code is generated
	from cmdEdit, and cmdEdit uses the vshCommandOptDomain macro which
	now, with the changes above, has only 3 (was 4) arguments, yet the
	macro use is mapped to vshCommandOptPool, which still requires 4
	arguments.  So this change adjusts the sed code to reinsert the
	just-removed argument -- we're not changing pool-related code right
	now, because it's not as straight-forward.

Fri Dec 12 18:50:20 +0100 2008 Jim Meyering <meyering@redhat.com>

	syntax-check: enforce the no-cvs-keywords prohibition
	* Makefile.maint (sc_prohibit_cvs_keyword): New rule.
	Suggested by Daniel Veillard.
	The new test exposed two uses of $\Date$.
	* docs/Goals: Don't use $\Date$.
	* python/TODO: Likewise.

Fri Dec 12 17:08:08 +0100 2008 Jim Meyering <meyering@redhat.com>

	avoid a spurious test failure on non-numa systems
	* tests/daemon-conf: Ignore a spurious libnuma warning.
	Reported by Daniel Veillard.

Fri Dec 12 14:57:17 CET 2008 Daniel Veillard <veillard@redhat.com>

	* Makefile.maint: fix tabs in C source error message based on
	  Dave Allan feedback

Fri Dec 12 13:41:31 +0100 2008 Jim Meyering <meyering@redhat.com>

	remove cvs $\Id$ strings
	* po/id.po: Likewise.
	* qemud/remote_generate_stubs.pl: Likewise.
	* src/virsh.c: Likewise.
	* tests/testutils.c: Likewise.
	* tests/testutils.h: Likewise.
	* RENAMES: Likewise.

Fri Dec 12 13:16:05 +0100 2008 Jim Meyering <meyering@redhat.com>

	libvirtd: plug a nominal leak
	* qemud/qemud.c (qemudRunLoop): Free server->workers.

Fri Dec 12 12:19:56 +0100 2008 Jim Meyering <meyering@redhat.com>

	remove unused xmlrpc-related files
	* src/xmlrpc.h: Remove file.
	* src/xmlrpc.c: Likewise.
	* tests/test_xmlrpc.sh: Likewise.
	* tests/xmlrpctest.c: Likewise.
	* tests/xmlrpcserver.py: Likewise.
	* tests/Makefile.am (EXTRA_DIST): Remove xmlserver.py.
	(noinst_PROGRAMS): Remove xmlrpctest, along with associated variables.
	* po/POTFILES.in: Remove src/xmlrpc.c.
	* tests/.cvsignore: Remove xmlrpctest.

Fri Dec 12 11:37:16 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c src/uml_conf.c: fix a couple of places where
	  we were requesting 8 times the required amount of memory,
	  patch by Dave Allan

Fri Dec 12 10:45:17 CET 2008 Guido Günther <agx@sigxcpu.org>

	* docs/devhelp/Makefile.am: look for devhelp.xsl in $(srcdir)

Fri Dec 12 10:28:41 CET 2008 Guido Günther <agx@sigxcpu.org>

	Fix serial/parallel virtual devices over tcp, unix and telnet
	* src/qemu_conf.c (qemudBuildCommandLineChrDevStr): use
	"server,nowait" instead of "listen" for tcp and unix sockets. Use
	"nowait" for telnet too.
	* tests/qemuxml2argvdata/qemuxml2argv-parallel-tcp.args: adjust
	testcase accordingly.
	* tests/qemuxml2argvdata/qemuxml2argv-serial-tcp-telnet.args:
	likewise.

Fri Dec 12 08:54:40 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c: add --version support to libvirtd, patch by
	  Dave Allan
	* AUTHORS: add Dave Allan

Fri Dec 12 08:34:47 CET 2008 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: fix a conditional bug in spec file #460510,
	  patch by Dave Allan

Fri Dec 12 08:27:44 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/util.c: retry poll() in EINTR failures, patch by Dave Allan

Thu Dec 11 19:10:46 +0100 2008 Jim Meyering <meyering@redhat.com>

	build: avoid libvirtd link failure with CFLAGS=-g
	* qemud/Makefile.am (libvirtd_LDADD): Add gnulib's libgnu.la last.
	Otherwise, building with -g (no inlining) would fail due to a use
	of c_isspace in libvirt_driver_qemu.a, which used to followed
	libgnu.a in the link command.

Thu Dec 11 16:13:08 +0100 2008 Jim Meyering <meyering@redhat.com>

	syntax-check: prohibit all new uses of gethostby* functions
	* Makefile.maint (sc_prohibit_gethostby): New rule.
	* .x-sc_prohibit_gethostby: Exempt the few existing uses.

Thu Dec 11 10:03:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Fix locking issue in test driver VolLookupByPath

Thu Dec 11 10:00:54 EST 2008 Cole Robinson <crobinso@redhat.com>

	* libvirt.spec.in: Fix rpm build by installing logrotate config

Thu Dec 11 09:58:49 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/storage_driver.c : Fix a locking issue in PoolGetAutostart

Thu Dec 11 09:55:23 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/network_driver.c src/qemu_conf.c: Fix segfault if virtual
	network does not have a bridge name.

Thu Dec 11 12:39:20 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/qemu_conf.c
	  tests/qemuxml2argvtest.c tests/qemuxml2xmltest.c
	  tests/qemuxml2argvdata/qemuxml2argv-graphics-sdl-fullscreen.args
	  tests/qemuxml2argvdata/qemuxml2argv-graphics-sdl-fullscreen.xml:
	  slightly modified patch for SDL fullscreen from Itamar Heim
	* docs/formatdomain.html docs/formatdomain.html.in docs/libvirt.rng:
	  update the schemas and docs about the sdl graphic element attributes
	* AUTHORS: add Itamar Heim

Wed Dec 10 20:18:36 +0100 2008 Jim Meyering <meyering@redhat.com>

	avoid a new "make distcheck" failure
	Distribute the new file, libvirtd.logrotate.in, and make
	distclean remove the build product, libvirtd.logrotate.
	* qemud/Makefile.am (EXTRA_DIST): Add libvirtd.logrotate.in.
	(DISTCLEANFILES): Initialize, and append libvirtd.logrotate.in.

Wed Dec 10 17:33:49 +0100 2008 Jim Meyering <meyering@redhat.com>

	avoid format string warnings
	* src/openvz_conf.c (openvzGetNodeCPUs): Add "%s" arg before _(...).
	* src/uml_driver.c (umlDomainBlockPeek): Likewise.

Tue Dec  9 2008 22:35:43 +0100 Jim Meyering <meyering@redhat.com>

	fix just-broken "virsh start" and "virsh pool-start" commands
	* src/virsh.c (cmdPoolStart, cmdStart): Change hard-coded
	vshCommandOptDomainBy string argument to match just-changed
	option name.  Cole Robinson reported that "virsh start" was
	broken and provided that part of the fix.
	Bug introduced by yesterday's "virsh.c: tweak options to produce
	more accurate help".
	* tests/start: New file.  Test for the above fix.
	* tests/Makefile.am (test_scripts): Add start.

Tue 9 Dez 2008 21:08:43 CET Guido Günther <agx@sigxcpu.org>

	logrotate qemu monitor logs
	* src/qemu_driver.c: open logfile O_APPEND instead of O_TRUNC when
	running as root
	* qemud/Makefile.am: install logrotate configuration (by Harald Sraub)
	and create logdir

Mon Dec  8 13:22:06 +0100 2008 Jim Meyering <meyering@redhat.com>

	virsh.c: tweak options to produce more accurate help
	* src/virsh.c: Adjust some vshCmdOptDef command option flags
	to improve auto-generated help command syntax.

	virsh.c: remove all "syntax" vshCmdInfo entries.
	* src/virsh.c: ... now that info is generated.

	virsh.c: add missing (yet empty) "desc" strings
	* src/virsh.c: Now, every command must have a "desc" string,
	even if it has zero length.  Mark these, so they'll be filled in.

	virsh.c: generate each "virsh help COMMAND"s synopsis
	* src/virsh.c: Also, diagnose extra arguments after --help (-h).

Mon Dec  8 12:00:53 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Fix mixup between _LDFLAGS & _LDADD
	variables to make compilation work in certain configs.

Mon Dec  8 11:28:53 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_conf.c: Workaround missing ULLONG_MAX in
	Debian etch's limits.h

Mon Dec  8 11:17:53 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c, src/uml_driver.c: Fix guest autostart
	to have a virConnect object available to allow query of
	virtual networks

Sun Dec  7 20:44:53 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Fix integer long long overflow. Fix NULL defernce

Sun Dec  7 20:20:53 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Remove bogus refresh call causing deadlock

Sun Dec  7 14:03:53 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Fix return value in testStoragePoolBuild

Fri Dec  5 16:03:53 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/node_device_hal.c configure.in: fix a compilation problem
	  with old dbus versions

Thu Dec  5 10:10:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Disable a few more functions for proxy
	build which should not be used

Thu Dec  4 22:20:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Remove unused driver argument from
	all monitor handling APIs.

Thu Dec  4 22:18:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Read number of threads for RPC dispatch
	from config. Allow a limit on total client connection
	count.
	* qemud/libvirtd.conf: Add max_clients and max_workers
	and min_workers config vars
	* qemud/libvirtd.aug, qemud/test_libvirtd.aug: Augeas
	support for new config params

Thu Dec  4 22:16:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Make daemon use a thread pool for handling RPC calls
	from multiple clients.
	* qemud/THREADING.txt: Describe threading rules
	* qemud/qemud.h, qemud/qemud.c, src/remote.c: Add a pool
	of threads for handling RPC call processing. Use main
	thread only for event loop
	* qemud/remote_generate_stubs.pl: Pass virConnectPtr object
	into dispatch stubs to avoid need to access client struct
	* qemud/remote_dispatch_prototypes.h: Re-generated

Thu Dec  4 22:14:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/event.c, src/event.h: Make all event handling thread
	safe and re-entrant safe, and allow poll() to be woken up
	by other threads.
	* src/qemud.c, src/qemud.h: Initialize event loop explicitly

Thu Dec  4 22:12:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c, qemud/qemud.h, qemud/remote.c: Make all
	error reporting the responsibility of the RPC handler
	methods
	* qemud/remote_generate_stubs.pl: Add remote_error *
	arg to all RPC handlers
	* qemud/remote_dispatch_prototypes.h: Re-generated

Thu Dec  4 22:09:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.h, qemud/qemud.c: Change client linked list into
	an array for easier thread safety

Thu Dec  4 22:01:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Change from a giant switch() on RPC number
	into a simple array lookup of RPC handler function
	* qemud/Makefile.am, qemud/remote_generate_stubs.pl: Change
	generator to produce a union of data types for O(1) dispatch
	* qemud/remote_dispatch_*: Re-generate files

Thu Dec  4 21:49:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Per object locking implementation
	* src/domain_conf.c, src/domain_conf.h, src/network_conf.c,
	src/network_conf.h, src/node_device_conf.c,
	src/node_device_conf.h, src/storage_conf.c
	src/storage_conf.h: Add implementation of locking APIs,
	and make object lookup / creation methods return locked
	objects

Thu Dec  4 21:48:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_sym.version.in, src/node_device.c,
	src/node_device.h, src/node_device_conf.h,
	src/node_device_devkit.c, src/node_device_hal.c: Add
	locking for thread safety of driver APIs

Thu Dec  4 21:46:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c, src/datatypes.h, src/datatypes.c: Cache
	device parent string to workaround need to keep public
	virNodeDeviceGetParent API returning a const string
	* src/node_device.c: Merge all return paths from node
	device driver APIs

Thu Dec  4 21:43:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.h: Add driver lock
	* src/openvz_driver.c: Add locking for thread safety

Thu Dec  4 21:41:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_driver.c: Merge all return paths from openvz
	driver APIs

Thu Dec  4 21:40:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_conf.h: Add driver lock
	* src/storage_driver.c: Add locking for thread safety

Thu Dec  4 21:39:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_driver.c: Merge all return paths from storage
	driver APIs

Thu Dec  4 21:38:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/network_driver.c: Add locking for thread safety

Thu Dec  4 21:37:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/network_driver.c: Merge all return paths from driver APIs

Thu Dec  4 21:14:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/uml_conf.h: Add driver lock variable
	* src/uml_driver.c: Add locking for thread safety

Thu Dec  4 21:13:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* Makefile.maint: Add umlError function
	* src/uml_driver.c: Merge all return paths from driver APIs

Thu Dec  4 21:11:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_conf.h: Add driver lock variable
	* src/lxc_driver.c: Add locking for thread safety

Thu Dec  4 21:10:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_driver.c: Merge all return paths from driver APIs

Thu Dec  4 21:09:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	QEMU domain events thread safety
	* src/domain_event.c, src/domain_event.h: Add convenient
	methods for dispatching a list of events, and a single
	event to a list of callbacks. Change signature of push
	method to take a pre-allocated virDomainEventPtr object
	* src/libvirt_sym.version.in: Export new event methods
	to daemon code / drivers
	* src/qemu_conf.h, src/qemu_driver.c: Make event dispatch
	threadsafe by doing asynchronously
	* src/remote_internal.c, src/xen_inotify.c, src/xen_unified.c,
	src/xen_unified.h, src/xs_internal.c: Update for changes in
	domain event APIs

Thu Dec  4 21:05:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.h: Add a driver lock variable
	* src/qemu_driver.c: Add locking for thread safety

Thu Dec  4 21:01:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Merge all return paths from driver APIs

Thu Dec  4 21:00:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Stub out node device APIs to avoid activating
	the daemon

Thu Dec  4 20:58:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Add locking for thread safety
	* tests/virsh-all: Set variables to allow direct invocation
	of test

Thu Dec  4 20:57:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Merge all return paths from driver APIs

Thu Dec  4 20:55:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Remove macros for accessing internal state

Thu Dec  4 20:47:41 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Thread locking API stubs
	* src/domain_conf.c, src/domain_conf.h, src/libvirt_sym.version.in,
	 src/network_conf.c, src/network_conf.h, src/node_device_conf.c,
	 src/node_device_conf.h, src/storage_conf.c, src/storage_conf.h:
	Define API stubs for locking and unlocking objects

Thu Dec  4 16:51:41 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt_sym.version.in configure.in NEWS docs/*: release
	  of 0.5.1
	* po/*: updated and regenerated

Thu Dec  4 16:20:20 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_conf.c: fix crash and regression when defining
	  a storage volume without a format (Cole Robinson)

Thu Dec  4 09:45:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* docs/formatstorage.html.in docs/storage.html.in : Fix some
	documentation copy and paste errors.
	* src/virsh.c : Fix a typo

Thu Dec  4 09:42:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Increase timeout for initial monitor poll

Thu Dec  4 15:36:42 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/bridge.c: patch setting MTU on tap interface to be the same
	  as the value for the bridge (Eduardo Habkost)

Thu 4 Dec 2008 12:46:01 CET Guido Günther <agx@sigxcpu.org>

	Differentiate between active and inactive configs by honoring the
	VIR_DOMAIN_XML_INACTIVE flag.
	* src/domain_conf.c (virDomainDefParseXML): add and pass on flags arg
	(virDomainDefParseFile): Likewise
	(virDomainDefParseNode): Likewise
	(virDomainGraphicsDefParseXML): Likewise
	* src/domain_conf.c (virDomainDefParseXML): only restore domain id if
	!VIR_DOMAIN_XML_INACTIVE
	* src/domain_conf. (virDomainGraphicsDefParseXML): only restore vnc
	port if !VIR_DOMAIN_XML_INACTIVE
	* src/lxc_driver.c (lxcStartup): pass 0 flag since we restore life
	config
	* src/lxc_controller.c: pass VIR_DOMAIN_XML_INACTIVE
	* src/test.c: pass VIR_DOMAIN_XML_INACTIVE
	* tests/qemuxml2argvtest.c: pass VIR_DOMAIN_XML_INACTIVE

Thu 4 Dec 2008 11:41:12 CET Guido Günther <agx@sigxcpu.org>

	* src/qemu_driver.c: also look for /usr/bin/kvm

Tue 2 Dec 2008 16:58:16 +0100 Jim Meyering <meyering@redhat.com>

	fix inadequate initialization in storage and test drivers
	* src/storage_driver.c (storageListPools): Set all "names" entries to 0.
	(storageListDefinedPools, storagePoolListVolumes): Likewise.
	* src/test.c (testStoragePoolListVolumes): Likewise.

Tue Dec 2 13:45:00 CET 2008 Chris Lalancette <clalance@redhat.com>
	* configure.in, src/storage_backend.c: Older distributions (i.e.
	RHEL-5) don't have udevadm at all, but they do have udevsettle.  So
	change our tests to prefer udevadm if it exists, but to fall back to
	udevsettle if it does not.

Tue Dec 2 11:34:22 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Registering network, storage & nodedev drivers
	before any domain drivers, so domain autostart can rely on
	network/storage autostarted objects. Patch from Gerd von Egidy

Tue Dec 2 11:21:22 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/uml_driver.c: Fix recording of watch number to make
	inotify actually work.

Mon Dec 1 16:01:54 +0100 2008 Jim Meyering <meyering@redhat.com>

	tests: daemon-conf: accommodate numeric-valued config params
	This test would hang when failing to perturb the soon-to-be-
	added numeric (and non-boolean) valued parameters, max_clients,
	max_workers, min_workers.
	* tests/daemon-conf: Require that all commented-out settings
	in libvirtd.conf have the same form.  Before, two parameters
	were not being tested, since a space had snuck between the
	leading "#" and the "param = value" parts.
	Apply each RHS-value-perturbing transformation
	separately, not in series.
	Let VERBOSE=yes turn on debugging.
	Be more verbose by default, since this is a relatively
	long-running test.
	* qemud/libvirtd.conf: Normalize the spacing around each setting
	that is to be perturbed by tests/daemon-conf.

Mon Dec 1 10:30:10 +0100 2008 Jim Meyering <meyering@redhat.com>

	uml: don't free an uninitialized variable
	* src/uml_driver.c (umlDomainShutdown): Initialize "info".
	Patch and bug report from Ron Yorston <rmy@tigress.co.uk>.

Sun Nov 30 18:36:33 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_inotify.c: Close directory handle once done
	processing files

Fri Nov 28 16:16:54 CET 2008 Guido Günther <agx@sigxcpu.org>

	Prefer xenstore driver for listDomains, since xen HV reports ghost ids
	of already shutdown domains in some xen versions
	* src/proxy_internal.c, src/proxy_internal.h: declare
	xenProxyListDomains non static
	* src/xend_internal.c, src/xend_internal.h: declare
	xenDaemonListDomains non static
	* src/xen_unified.c: prefer xenStoreListDomains over
	xenHypervisorListDomains for xenUnifiedListDomains

Fri Nov 28 11:58:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Allow generic remote://hostname/ URI for automatic probe
	of hypervisor driver.
	* docs/uri.html, docs/uri.html.in: Document remote://hostname/ style
	URI syntax
	* src/driver.h: Remove version field
	* src/libvirt.c: Directly impl virGetVersion() instead of calling out
	to individual drivers
	* src/lxc_driver.c, src/openvz_driver.c, src/qemu_driver.c,
	src/remote_internal.h, src/test.c, src/uml_driver.c,
	src/xen_unified.c, src/xen_unified.h: Remove version from
	driver tables.
	* src/remote_internal.c: Allow 'remote' as a URI scheme for
	automatically probing on remote server

Fri Nov 28 11:21:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix XM driver disk parsing with no source CDROMs
	* src/domain_conf.c: Translate "" into NULL for disk source
	path to deal with broken apps
	* src/xm_internal.c: Fix disk source parsing to work with
	no-source disk definitions (eg CDROM without media)
	* tests/xmconfigdata/test-no-source-cdrom.cfg,
	tests/xmconfigdata/test-no-source-cdrom.xml,
	tests/xmconfigtest.c: Add test case for no-src CDROM

Fri Nov 28 11:17:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Add missing numa-ctl BuildRequires
	* qemud/Makefile.am: Fix libvirtd_DEPENDANCIES to include all libs
	* src/qemu_conf.c, src/qemu_driver.c, src/uml_conf.c,
	src/uml_driver.c: Define NUMA_VERSION1_COMPATIBILITY and
	fix size of array used to get node mapping

Fri Nov 28 08:40:00 CET 2008 Chris Lalancette <clalance@redhat.com>
	* src/storage_backend.c: Wait up to 5 seconds for
	/dev/disk/by-{id,path} to exist in virStorageBackendStablePath

Thu Nov 27 17:15:10 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_unified.c: use preferably xend method to update
	  the maximum memory of a xen guest (Jim Fehlig)

Wed Nov 26 15:46:07 CET 2008 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: cleanups and missing dep for hal

Tue Nov 25 16:29:09 CET 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in docs/* NEWS: release of 0.5.0
	* po/*: updated from the translators and merged
	* docs/apibuild.py src/libvirt.c: avoid some warnings at doc
	  generation time

Tue Nov 25 16:34:10 +0100 2008 Jim Meyering <meyering@redhat.com>

	* configure.in: avoid the following diagnostic when running ../configure
	cp: cannot stat `COPYING.LIB': No such file or directory

	don't silently skip a test
	* tests/Makefile.am (EXTRA_DIST): Distribute domainschemadata/.
	* tests/domainschematest: Fail the test if find invocation fails.

Tue Nov 25 11:27:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* mingw32-libvirt.spec.in: Disable UML driver for mingw build

Tue Nov 25 11:17:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Add missing _(...) calls to diagnostics

Tue Nov 25 10:49:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am: Remove unneccessary $(builddir) usage which
	breaks on older automake. Remove duplicate CFLAGS from merge
	error
	* src/xen_unified.c: Wire up XM driver for autostart
	* src/xm_internal.h, src/xm_internal.c: Implement domain
	autostart functions for /etc/xen/auto

Tue Nov 25 10:43:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	Xen domain lifecycle events (Ben Guthro & Daniel Berrange)
	* configure.in: Probe for inotify availability
	* examples/domain-events/events-c/event-test.c: Default to NULL
	connection URI to allow probing
	* include/libvirt/virterror.h, src/virterror.c: Add error code
	for xen inotify driver
	* po/POTFILES.in: Add xen_inotify.c
	* python/libvir.c: Add bogus const cast for python2.4 brokeness
	* src/Makefile.am: Add xen_inotify.c
	* src/util.c: Fix file descriptor leak in virRun
	* src/xen_inotify.c, src/xen_inotify.h: Monitor /etc/xen and
	/var/lib/xen/domains for new/old configs
	* src/xen_unified.c, src/xen_unified.h: Wire in inotify driver
	for events
	* src/xm_internal.c, src/xm_internal.h: Refactor to allow inotify
	monitoring of config files
	* src/xs_internal.c, src/xs_internal.h: Use xenstore watch to
	check for domain start/destroy events

Tue Nov 25 10:36:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/node_device_conf.c, src/node_device_conf.h,
	src/node_device_devkit.c, src/node_device_hal.c: Change
	'interface' to 'ifname' in struct to avoid clash with
	symbols in MinGW/Win32 headers

Tue Nov 25 11:29:19 +0100 2008 Jim Meyering <meyering@redhat.com>

	* src/virterror.c (virReportErrorHelper): Sync doc to code.

	libvirt.c: document the virState* functions
	* src/libvirt.c (virStateActive, virStateCleanup, virStateReload):
	(virStateActive): Add per-function comments.

Mon Nov 24 19:32:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c, src/openvz_conf.h, src/openvz_driver.c:
	Default vCPUs to equal host pCPU count if not set in config
	(patch from Evgeniy Sokolov)

Mon Nov 24 19:27:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* examples/domain-events/events-python/event-test.py,
	python/libvir.c, python/libvir.py, python/libvirt_wrap.h,
	python/types.c, python/virConnect.py: Fixes to python
	bindings for changes in public event API (David Lively)

Mon Nov 24 19:22:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am, tests/sexpr2xmltest.c,
	tests/testutilsxen.c, tests/xencapstest.c,
	tests/xmconfigtest.c, tests/xml2sexprtest.c: Disable all
	Xen tests when Xen driver build is disabled. Remove unneccessary
	WITH_XEN conditionals from source, since the entire build
	is disabled in Makefile.am

Mon Nov 24 16:49:40 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* autobuild.sh: Disable UML driver on mingw32 biuld

Mon Nov 24 16:01:40 CET 2008 Guido Günther <agx@sigxcpu.org>

	* src/Makefile.am: look for libvirt_sym.version in builddir

Mon Nov 24 08:10:49 +0100 2008 Jim Meyering <meyering@redhat.com>

	tests: new test: virsh-synopsis
	* tests/virsh-synopsis: new file
	* tests/Makefile.am (test_scripts): Add virsh-synopsis.
	* src/virsh.c: Correct help SYNOPSIS for each of seven commands.

	tests: virsh-all: new script
	* tests/virsh-all: New script.
	* tests/Makefile.am (test_scripts): Add virsh-all.

	Move the expected output data from virshdata/*.txt into virshtest.c.
	* tests/virshtest.c: Embed literal, expected output here, rather than
	using virshdata/*.txt file names.
	Factor out some common constructs.
	(testCompareOutputLit): New function.
	(testCompareOutput): #ifdef-out, not that it's unused.
	* tests/Makefile.am (SUBDIRS): Remove virshdata/ and all files in it.
	* docs/testnode.xml: Fix typo in a comment.
	* configure.in (AC_OUTPUT): Remove tests/virshdata/Makefile.

Fri Nov 21 23:51:19 +0100 2008 Jim Meyering <meyering@redhat.com>

	* gnulib/tests/test-EOVERFLOW: Remove.
	* gnulib/tests/.cvsignore: Add test-EOVERFLOW, then...
	Run "make sync-vcs-ignore-files" to Update .gitignore files.

Fri Nov 21 12:54:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/*.html: Re-generate website docs for sitemap change
	with UML driver. Fix syntax error in HTML for news.html.in

Fri Nov 21 12:51:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* libvirt-api.xml, libvirt-refs.xml, html/libvirt-libvirt.html,
	html/libvirt-virterror.html: Regenerate for new APIs

Fri Nov 21 12:46:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Misc tweaks to node device impl
	* src/libvirt.c: Log registration of new node device driver impls
	* src/node_device_conf.h, src/node_device.c: Merge block capability
	into storage. Print vendor/product IDs in hex
	* src/node_device_devkit.c: Change block to storage
	* src/node_device_hal.c: Merge block cap into storage. Skip
	devices without any capabilities listed
	* src/virsh.c: Sort device list alphabetically

Fri Nov 21 12:40:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Python binding for node device APIs (David Lively)
	* python/generator.py, python/libvir.c, python/libvirt-python-api.xml,
	python/libvirt_wrap.h, python/types.c: Bindings for node device APis

Fri Nov 21 12:38:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Node device support in virsh (David Lively)
	* src/virsh.c: Add nodedev-list and nodedev-dumpxml commands

Fri Nov 21 12:30:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Remote protocol support for node devices (David Lively)
	* src/remote_internal.c: driver impl for node device APIs
	* qemud/remote_protocol.x: Define wire protocol for node device
	APIs
	* qemud/remote_dispatch*, qemud/remote_protocol.{c,h}: Update
	for new APIs
	* qemud/remote.c: server dispatch functions for node device
	APIs

Fri Nov 21 12:23:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Primary internal driver for node devices with HAL (default)
	and DeviceKit (optional, unfinished) (David Lively)
	* configure.in: Probe for HAL & DeviceKit libraries
	* po/POTFILES.in: Add new source files
	* qemud/Makefile.am: Link to node device driver
	* qemud/qemud.c: Load node device driver implementation
	* src/Makefile.am: Buid node device drivers
	* src/libvirt_sym.version.in: Export internal symbols needed
	by node device driver
	* src/node_device.c, src/node_device.h: Common driver
	routines
	* src/node_device_hal.c: HAL specific device routines
	* src/node_device_devkit.c: DeviceKit specific routines
	* src/node_device_conf.h: Add dbusWatch handle field

Fri Nov 21 12:20:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am, src/node_device_conf.c, src/node_device_conf.h:
	Internal APIs for handling node device XML configuration
	(David Lively)

Fri Nov 21 12:19:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Public API for node device enumeration (David Lively)
	* include/libvirt/libvirt.h.in, include/libvirt/virterror.h:
	New public APIs for node device enumeration
	* src/datatypes.c, src/datatypes.h: Internal impl of public
	data types for node devices
	* src/driver.h, src/libvirt.c: Stubs for node device APIs
	* src/libvirt_sym.version.in: Export new node device API
	symbols
	* src/virterror.c: Error codes for node device drivers

Fri Nov 21 12:03:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Optional (disabled by default) dlopen support
	* configure.in: Probe for dlopen
	* qemud/Makefile.am: Don't link to drivers when dlopen is used
	* qemud/qemud.c: Load external driver modules at startup
	* src/Makefile.am: Don't link to drivers when dlopen is used
	* src/driver.c, src/driver.h: Add API for dlopen'ing modules
	* src/libvirt.c: Load external driver modules at startup
	* src/libvirt_sym.version.in: Export more internal symbols
	needed for external driver modules
	* src/qemud_driver.c, src/qemu_driver.h, src/xen_unified.c,
	src/xen_unified.h: Sanitize driver registration methodname
	to match module name
	* tests/Makefile.am: Set LIBVIRT_DRIVER_DIR when running
	tests with dlopen enabled. Link to driver modules in Xen
	test cases
	* tests/testutils.c: Set LIBVIRT_DRIVER_DIR when running
	external programs
	* tests/xmconfigtest.c: Don't open test driver during xen
	tests.

Fri Nov 21 11:43:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_sym.version.in: Add export of domain event
	API virDomainEventCallbackListRemoveConn missed from earlier
	commit

Fri Nov 21 11:37:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Fix two memory leaks in virDomainLoadConfig
	* src/lxc_driver.c: Fix leak of capabilities object in driver
	shutdown code

Fri Nov 21 10:20:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Return VIR_NO_SUPPORT if requested
	to register event callbacks when no eventloop is present.
	Deal with failure to register handles/timers correctly.
	(David Lively)

Fri Nov 21 10:14:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix crash due to failure to unregister event callbacks on
	connection close (David Lively)
	* src/domain_event.c, src/domain_event.h: Helper for unregistering
	all callbacks
	* src/qemu_driver.c: Unregister all callbacks on connection close

Fri Nov 21 10:10:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am: Include Xen compile flags for libvirt_driver.la
	build for stats_linux.c code.

Fri Nov 21 10:07:14 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Add conditional to allow UML driver to be
	disabled (Ben Guthro)

Fri Nov 21 11:05:14 CET 2008 Daniel Veillard <veillard@redhat.com>

	* po/POTFILES.in src/uml_conf.h src/uml_driver.c: fixes syntax
	  check errors, reported by Ben Guthro

Thu Nov 20 14:31:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	* src/remote_internal.c: Avoid crash on NULL URI scheme

Wed Nov 19 16:51:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Add User Mode Linux driver
	* src/uml_driver.c, src/uml_driver.h, src/uml_conf.c,
	src/uml_conf.h: Core UML driver code
	* src/domain_conf.c, src/domain_conf.h: Add UML disk
	bus type. Fix paravirt console handling for non-HVM domains
	* src/driver.h: Add UML driver number
	* src/virterror.h: Add error code for UML driver
	* src/qemu_conf.c: Add disk bus enum entry for UML
	* src/Makefile.am: Build UML driver
	* qemud/qemud.c: Initialize UML driver
	* qemud/Makefile.am: Link to UML driver library
	* docs/drvuml.html.in: Basic docs for the UML driver
	* configure.in: Flag for enabling UML driver
	* include/libvirt/virterror.h: Add constant for UML driver

Wed Nov 19 16:22:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Add virFreeCallback to event loop APIs.
	* include/libvirt/libvirt.h.in: Add a virFreeCallback arg
	to the virEventAddHandle and virEventAddTimeout methods.
	* qemud/event.c: Invoke the virFreeCallback when releasing
	a handle/timer event
	* qemud/event.h, qemud/qemud.c, qemud/mdns.c,
	src/event.h, src/event.c, src/lxc_driver.c,
	src/qemu_driver.c, src/remote_internal.c: Update to pass
	around the virFreeCallback where needed

Wed Nov 19 16:15:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	* include/libvirt/libvirt.h.in: Change semantics of AddHandle
	to allow for same FD to be registered more than once with
	varying flags.
	* qemud/event.c, qemud/event.h, qemud/mdns.c, qemud/qemud.c,
	qemud/qemud.h, src/domain_conf.h, src/event.c, src/event.h,
	src/lxc_driver.c, src/qemu_driver.c, src/remote_internal.c:
	Update to track file handle events via the watch number
	as per new public API contract

Wed Nov 19 15:25:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Add a callback for freeing the user data for callbacks
	(patch from David Lively)
	* include/libvirt/libvirt.h.in: Add a virFreeCallback type
	and add it to virDomainEventRegister
	* qemud/remote.c, src/domain_event.h, src/domain_event.c,
	src/driver.h, src/qemu_driver.c, src/remote_internal.c,
	python/libvirt.c: Update to call the virFreeCallback where
	needed
	* examples/domain-events/events-c/event-test.c: use the
	virFreeCallback for releasing data

Mon Nov 18 12:24:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	* src/Makefile.am: Fix build on MinGW where linker flags
	must be listed in LDFLAGS variable
	* tests/Makefile.am: Fix build when QEMU is disabled, by
	skipping QEMU tests

Mon Nov 17 16:45:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Generate domain events for QEMU driver config files
	* src/qemu_driver.c: Generate events when config is defined
	and undefined
	* src/domain_conf.c, src/domain_conf.h: Add a callback for
	notifications of each loaded config file
	* src/lxc_driver.c: Pass NULL for config file notification
	callback parameter

Mon Nov 17 16:42:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Include an event 'detail' field providing the cause of
	each emitted domain event.
	* docs/ Re-generate API refernece
	* examples/domain-events/events-c/event-test.c: Print out
	event detail info
	* include/libvirt/libvirt.h.in: Rename ADDED/REMOVED events
	to DEFINED/UNDEFINED. Remove SAVED/RESTORED events replaced
	by event detail info. Add enums providing details for each
	domain event type.
	* python/libvir.c: Pass through event detail to python layer
	* qemud/remote_protocol.x: Add event detail field for domain
	events.
	* qemud/remote_protocol.c, qemud/remote_protocol.h: Regenerate
	* qemud/remote.c: Pass event detail value onto the wire
	* src/domain_event.h, src/domain_event.c: Store event detail
	* src/remote_internal.c: De-serialize event detail off the
	wire
	* src/qemu_driver.c: Generate event detail information, and
	fix migration API to honour VIR_MIGRATE_LIVE flag, pausing
	the VM if it isn't set

Mon Nov 17 11:57:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Push stateful driver code into daemon binary
	* src/Makefile.am: Don't build QEMU, LXC, Network & Storage
	drivers into libvirt.so
	* src/libvirt.c: Don't call into QEMU, LXC, network & storage
	driver register methods
	* src/libvirt_sym.version.in: Export a bunch of internal
	symbols to libvirtd for use by drivers
	* tests/Makefile.am: Link to driver modules which are not
	in libvirt.so
	* qemud/Makefile.am: Directly link to QEMU, LXC, network
	and storage drivers
	* qemud/qemud.c: Initialize QEMU, LXC, network & storage
	drivers at startup

Mon Nov 17 11:40:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Push URI probing down into individual drivers' open methods
	* qemud/remote.c: Implement virConnectGetURI dispatcher
	* qemud/remote_protocol.x: Add API definition for virConnectGetURI
	* qemud/remote_dispatch_localvars.h, qemud/remote_dispatch_proc_switch.h,
	qemud/remote_dispatch_prototypes.h, qemud/remote_protocol.c,
	qemud/remote_protocol.h: Re-generate from protocol definition
	* src/datatypes.c, src/datatypes.h: Store connection name as a
	xmlURIPtr object instead of char *
	* src/driver.h: Remove explicit URI parameter to open function
	* src/libvirt.c: Delegrate URI probing into drivers
	* src/lxc_driver.c, src/network_driver.c, src/openvz_driver.c,
	src/proxy_internal.c, src/qemu_driver.c, src/remote_internal.c,
	src/storage_driver.c, src/test.c, src/xen_internal.c,
	src/xen_internal.h, src/xen_unified.c, src/xend_internal.c,
	src/xend_internal.h, src/xm_internal.c, src/xm_internal.h,
	src/xs_internal.c, src/xs_internal.h: Refactor open driver
	methods to deal with automatic URI probing as required
	* proxy/libvirt_proxy.c: Remove extra args to xs/xen driver
	open calls

Mon Nov 17 11:19:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Refactor storage backend to remove dependancy from
	storage config parser.
	* src/Makefile.am: Build storage_backend as part of storage
	driver instead of general config
	* src/storage_backend.c, src/storage_backend.h,
	src/storage_backend_disk.c, src/storage_backend_fs.c,
	src/storage_backend_iscsi.c, src/storage_backend_logical.c,
	src/storage_conf.c, src/storage_conf.h, src/storage_driver.c:
	Move per-pool type parser options & format enums into the
	main storage_conf.c file, so parser is independant of the
	backend impl code.

Mon Nov 17 10:50:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	Switch to fully versioned linker script for exported ABI
	* configure.in: Generate src/libvirt_sym.version
	* qemud/Makefile.am: Remove use of util-lib.c
	* qemud/remote.c: Remove underscore in migrate API calls
	* src/.cvsignore: Ignore generated libvirt_sym.version
	* src/Makefile.am: Remove util-lib.c and util-lib.h
	* src/buf.c, src/buf.h, src/conf.c, src/conf.h, src/console.c,
	src/datatypes.c, src/datatypes.h, src/driver.h, src/libvirt.c,
	src/libvirt_internal.h, src/memory.c, src/memory.h, src/virsh.c:
	Remove use of __ prefix on all exported methods
	* src/util.c, src/util.h: Re-add saferead/write APIs
	* src/util-lib.c, src/util-lib.h: Remove obsolete files
	* src/libvirt_sym.version: Remove obsolete file
	* src/libvirt_sym.version.in: Master template for symbol
	versioning data

Mon Nov 17 10:43:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	* src/Makefile.am: Build drivers as libtool convenience libs

Mon Nov 17 10:23:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	* docs/libvirt-api.xml: Re-generate
	* include/libvirt/libvirt.h.in: Set explicit values for
	domain events enums to avoid API generator bug
	* python/libvir.c: Add missing python thread safety calls
	to domain events APIs

Mon Nov 17 09:55:00 GMT 2008 Daniel Berrange <berrange@redhat.com>

	* src/openvz_conf.c: Fix updating of config file params
	(Evgeniy Sokolov)

Fri Nov 14 09:40:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/storage_backend_logical.c: Use different separator for lvs
	command to unbreak parsing for encrypted devices.

Fri Nov 14 13:22:36 +0100 2008 Jim Meyering <meyering@redhat.com>

	avoid format string warnings
	* src/openvz_driver.c (ADD_ARG_LIT): Add "%s" arg before _(...).
	* src/qemu_driver.c (PCI_ATTACH_OK_MSG): Likewise.
	* src/util.c (virExec, virRun): Likewise.

Fri Nov 14 09:38:22 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/remote.c qemud/remote_dispatch_localvars.h
	  qemud/remote_dispatch_proc_switch.h qemud/remote_dispatch_prototypes.h
	  qemud/remote_protocol.c qemud/remote_protocol.h
	  qemud/remote_protocol.x src/driver.h src/libvirt.c
	  src/libvirt_internal.h src/libvirt_sym.version src/lxc_driver.c
	  src/openvz_driver.c src/qemu_conf.h src/qemu_driver.c
	  src/remote_internal.c src/test.c src/virsh.c: large patch to
	  add migration support for KVM/QEmu, based on the work of Rich Jones
	  and Chris Lalancette. This introduce a new version of the prepare
	  and finish steps of the migration, so changes the driver API and
	  a lot of code.

Wed Nov 12 16:33:42 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/drvopenvz.html, docs/drvopenvz.html.in: Introductory
	docs for openvz driver
	* src/openvz_conf.c, src/openvz_conf.h, src/openvz_driver.c:
	Support bridged network configuration for containers

Wed Nov 12 16:13:42 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_backend.c, src/storage_backend.h, src/storage_driver.c:
	Revert previous patch which breaks "test" driver's storage APIs.

Tue Nov 11 15:51:42 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_backend.c, src/storage_backend.h, src/storage_driver.c:
	Decouple backend impls from generic backend code, by making driver
	register backends at startup

Mon Nov 10 12:05:42 GMT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c: Read filesytem template name from config
	files. Increase buffer size when parsing vzctl version number

Thu Nov  6 20:45:42 CET 2008 Jim Meyering <meyering@redhat.com>

	tweak lstat.c to avoid mingw link failure
	* gnulib/lib/lstat.c: Include <sys/stat.h> *before* the use of stat in
	orig_stat.  Otherwise, on mingw (which lacks lstat), any program using
	the lstat module would not get the redefinition-to-stat provided by
	gnulib's sys/stat.h.  Reported by Daniel P. Berrange.

	mark a few diagnostics for translation
	* src/lxc_conf.c (lxcLoadDriverConfig): Mark a diagnostic.
	* src/lxc_driver.c (lxcDomainStart): Likewise.
	* po/POTFILES.in: Add src/lxc_conf.c.
	* Makefile.maint (msg_gen_function): Add virReportErrorHelper
	and lxcError.

	always compile iptables.c
	Avoid a build error when configuring --without-xen --without-qemu.
	* src/iptables.c [WITH_QEMU]: Don't #ifdef-out.
	* src/iptables.h [WITH_QEMU]: Don't #ifdef-out.
	* src/util.c (virRun) [__MINGW32__]: Define a stub that always fails.

Thu Nov  6 17:33:34 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/logging.c src/logging.h proxy/Makefile.am proxy/libvirt_proxy.c
	  src/Makefile.am src/cgroup.c src/datatypes.c src/domain_event.c
	  src/internal.h src/libvirt.c src/lxc_container.c src/lxc_controller.c
	  src/lxc_driver.c src/proxy_internal.c src/qemu_driver.c
	  src/remote_internal.c src/storage_backend_disk.c src/util.c
	  src/veth.c src/xen_internal.c src/xen_unified.c src/xend_internal.c:
	  add new logging module, and move existing definitions there

Wed Nov  5 13:56:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/util.c: Log stdout and stderr in virRun

Wed Nov  5 13:39:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/util.c: Log the argv passed to virExec and virRun

Wed Nov  5 13:19:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/iptables.c, src/util.c, src/util.h: Move local argvToString to
	virArgvToString.

Wed Nov  5 15:22:12 CET 2008 Jim Meyering <meyering@redhat.com>

	plug two leaks and fix a diagnostic
	* src/qemu_conf.c (qemudLoadDriverConfig): Don't leak ->vncListen.
	Fix an erroneous copy-and-pasted diagnostic.
	* src/qemu_driver.c (qemudShutdown): Don't leak another ->vncListen.

Wed Nov  5 12:41:00 CET 2008 Chris Lalancette <clalance@redhat.com>

	* configure.in, src/storage_backend_logical.c: Call vgscan before
	attempting to scan logical volumes.  This makes sure we've "touched"
	any logical volumes, so they appear in the subsequent "pvs" call.

Tue Nov  4 23:33:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Set WITH_XXXX conditionals for drivers in
	config.h instead of compiler args, and auto-disable stateful
	drivers if daemon is disabled
	* src/libvirt.c: Remove now redundant WITH_LIBVIRTD condition
	* tests/Makefile.am, src/Makefile.am, qemud/Makefile.am: Remove
	LIBVIRT_FEATURES args, now set via config.h instead. Add
	explicit XEN_LIBS/CFLAGS instead of relying on setting via
	global flags.

Tue Nov  4 23:33:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	Move domain events helpers into domain_events.c
	* qemud/event.c: Remove __ prefix on poll event
	convertors
	* qemud/event.h: Add virEventHandleTypeToPollEvent and
	virPollEventToEventHandleType declarations
	* src/Makefile.am, src/domain_event.c, src/domain_event.h:
	Add dedicated file for internal domain events helpers
	* src/internal.h, src/libvirt.c: Remove domain events
	helpers
	* src/qemu_conf.h, src/remote_internal.c: Add includs
	of domain_event.h

Tue Nov  4 23:08:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	Move internal API declarations from generic internal.h file
	* src/Makefile.am, src/datatypes.c, src/datatypes.h: Add
	internal struct definitions for public objects, and helper
	methods.
	* src/hash.c: Remove helper methods for public objects
	* src/libvirt_internal.h: Add definition of semi-secret
	public APIs for migration & stateful drivers.
	* src/internal.h: Remove internal API declarations for
	migration & stateful drivers.
	* po/POTFILES.in, proxy/libvirt_proxy.c, qemud/qemud.c,
	qemud/remote.c, src/domain_conf.c, src/domain_conf.h,
	src/driver.h, src/libvirt.c, src/lxc_driver.c,
	src/network_conf.c, src/network_conf.h, src/network_driver.c,
	src/openvz_driver.c, src/proxy_internal.c,
	src/proxy_internal.h, src/qemu_driver.c, src/qparams.c,
	src/remote_internal.c, src/stats_linux.c, src/storage_conf.c,
	src/storage_conf.h, src/storage_driver.c, src/test.c,
	src/uuid.c, src/veth.c, src/virterror.c, src/xen_internal.c,
	src/xen_internal.h, src/xen_unified.c, src/xen_unified.h,
	src/xend_internal.c, src/xend_internal.h, src/xm_internal.c,
	src/xs_internal.c, tests/xmconfigtest.c: Add includes for
	libvirt_internal.h and datatypes.h where required

Tue Nov  4 22:52:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c, src/driver.h, src/internal.h, src/libvirt.c
	src/network_driver.c: Remove unused virStateSigDispatcher()
	internal API

Tue Nov  4 22:20:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	Move internal error API declarations into their own file
	* src/Makefile.am, src/virterror_internal.h: Add file for
	internal error reporting APIs.
	* src/internal.c: Remove virRaiseError/virReportError API
	declarations
	* src/conf.c, src/domain_conf.c, src/hash.c,
	src/libvirt.c, src/lxc_conf.c, src/lxc_conf.h,
	src/lxc_container.c, src/lxc_controller.c, src/lxc_driver.c,
	src/network_conf.c, src/network_driver.c, src/nodeinfo.c,
	src/openvz_conf.c, src/openvz_conf.h, src/openvz_driver.c,
	src/proxy_internal.c, src/qemu_conf.c, src/qemu_conf.h,
	src/qemu_driver.c, src/qparams.c, src/remote_internal.c,
	src/sexpr.c, src/stats_linux.c, src/storage_backend.c,
	src/storage_backend_disk.c, src/storage_backend_fs.c,
	src/storage_backend_iscsi.c, src/storage_backend_logical.c,
	src/storage_conf.c, src/storage_conf.h, src/storage_driver.c,
	src/test.c, src/util.c, src/virterror.c, src/xen_internal.c,
	src/xen_unified.c, src/xend_internal.c, src/xm_internal.c,
	src/xml.c, src/xmlrpc.c, src/xs_internal.c: Add includes
	of new virterror_internal.h file where required, and remove
	leading __ from virRaiseError api calls

Tue Nov  4 22:14:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	Support passing UUID and ID to qemu/xenner
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Detect
	availability of -uuid and -domid args in QEMU, and use them if
	available
	* tests/qemuxml2argvtest.c,
	tests/qemuxml2argvdata/qemuxml2argv-misc-uuid.args,
	tests/qemuxml2argvdata/qemuxml2argv-misc-uuid.xml: Add test
	case for -uuid and -domid args

Tue Nov  4 21:50:31 UTC 2008 Daniel P. Berrange <berrange@redhat.com>

	Remove use of virStringList
	* src/internal.h, src/libvirt.c: Remove virStringList code
	* src/storage_backend_fs.c: Replace use of virStringList
	with virStoragePoolSourceList
	* src/storage_backend_logical.c: Set format to LVM2 and
	source type to LOGICAL
	* src/storage_conf.c: Refactor pool source XML formating
	into virStoragePoolSourceFormat and make both users call
	the common code
	* src/storage_conf.h:  Include pool source type in
	virStoragePoolSourceList struct

Tue Nov  4 14:58:31 CET 2008 Jim Meyering <meyering@redhat.com>

	don't print an uninitialized integer in a diagnostic
	* src/virterror.c (__virErrorMsg) [VIR_ERR_XEN_CALL]:
	Use a format with only one % directive.

Tue Nov  4 14:58:30 CET 2008 Jim Meyering <meyering@redhat.com>

	add a test for today's fix
	* tests/cpuset: New script.  Test for today's fix.
	* tests/Makefile.am (test_scripts): Add cpuset.

Mon Nov  3 17:12:21 CET 2008 Daniel Veillard <veillard@redhat.com>

	* AUTHORS: added Guido Günther as new commiter, Dan Smith was missing
	  too

Mon Nov  3 16:54:39 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c: switch off cache if disk is shared and not read-only
	  patch by Charles Duffy

Mon Nov  3 16:52:12 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: oops trailing blanks

Mon Nov 03 12:37:00 CET 2008 Chris Lalancette <clalance@redhat.com>
	* src/storage_backend.c src/storage_backend.h
	src/storage_backend_disk.c src/storage_backend_iscsi.c
	src/storage_driver.c: Give iSCSI and disk storage backend drivers the
	ability to resolve any kind of volume path to the pool target volume
	path.  For instance, if the pool was defined with a
	<target><path>/dev/disk/by-id</path></target> section, and one of the
	volumes is /dev/disk/by-id/scsi-S_beaf11, then you would be able to
	call virStorageVolLookupByPath("/dev/sdc"), and get the correct volume
	back.

Fri Oct 31 14:55:46 CET 2008 Daniel Veillard <veillard@redhat.com>

	* python/virConnect.py: needed for events from the python bindings
	  by Ben Guthro

Fri Oct 31 14:04:52 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c: add minimum domain memory size check for Xen
	  patch by Shigeki Sakamoto
	* AUTHORS: add Shigeki Sakamoto

Fri Oct 31 11:11:30 CET 2008 Daniel Veillard <veillard@redhat.com>

	* python/Makefile.am python/generator.py python/libvir.c
	  python/libvir.py python/libvirt_wrap.h python/types.c:
	  adds support for events from the python bindings, also
	  improves the generator allowing to embbed per function
	  definition files, patch by Ben Guthro
	* examples/domain-events/events-python/event-test.py: also
	  adds a programming example

Thu Oct 30 13:39:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/test.c: Add a test storage driver.

Wed Oct 29 16:33:16 CET 2008 Daniel Veillard <veillard@redhat.com>

	* docs/relatedlinks.html docs/relatedlinks.html.in: add link
	  for AMQP/QPid bindings

Wed Oct 29 15:25:28 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.h src/qemu_driver.c: patch adding hor removal of
	  scsi/virtio disks for KVM, patch by Guido Günther

Tue Oct 28 19:17:20 +0100 2008 Jim Meyering <meyering@redhat.com>

	remove src/socketcompat.h;  no longer needed
	* src/socketcompat.h: Remove file.
	* src/remote_internal.c: Don't include socketcompat.h.
	* qemud/qemud.h: Likewise.
	* qemud/remote_protocol.x: Likewise, but do include <arpa/inet.h>
	for htonl.
	* src/remote_internal.c: Likewise, but do include <errno.h>.
	* qemud/remote_protocol.c: Regenererate.
	* qemud/remote_protocol.h: Regenererate.
	* src/Makefile.am (REMOTE_DRIVER_SOURCES): Remove socketcompat.h.

Tue Oct 28 13:46:50 +0100 2008 Jim Meyering <meyering@redhat.com>

	make generated qemud/*.[ch] files read-only
	* qemud/Makefile.am (.x.c): Rewrite not to write directly to $@,
	and to make generated files read-only.
	(.x.h): Likewise.

Tue Oct 28 13:29:14 +0100 2008 Jim Meyering <meyering@redhat.com>

	avoid compiler warning when all storage backends are disabled
	* src/storage_backend.c (backends): Add a NULL terminator.
	(virStorageBackendForType): Use NULL terminator rather than
	warning-provoking (possibly 0) array size.

Tue Oct 28 13:29:14 +0100 2008 Jim Meyering <meyering@redhat.com>

	avoid many mingw-specific warnings
	* tests/virshtest.c (mymain): Use only one definition of this function.
	[WIN32]: Call exit(77) to skip the test.
	* tests/nodeinfotest.c: Likewise.

Tue Oct 28 13:29:14 +0100 2008 Jim Meyering <meyering@redhat.com>

	cvsignore mingw build artifacts: *.exe

Tue Oct 28 13:29:14 +0100 2008 Jim Meyering <meyering@redhat.com>

	include netinet etc #ifndef HAVE_WINSOCK2_H

Tue Oct 28 13:29:13 +0100 2008 Jim Meyering <meyering@redhat.com>

	* src/remote_internal.c (remoteFindDaemonPath) [!WIN32]: Don't compile.

Tue Oct 28 13:29:05 +0100 2008 Jim Meyering <meyering@redhat.com>

	use errno, not socket_errno()
	* remote_internal.c: s/socket_errno()/errno/, now that gnulib's
	socket module ensures errno is useful in those cases.

Tue Oct 28 12:12:41 +0100 2008 Jim Meyering <meyering@redhat.com>

	socketcompat.h: simplify, to match latest gnulib
	Now, sys/socket.h is always available, and errno works.

Tue Oct 28 12:07:46 +0100 2008 Jim Meyering <meyering@redhat.com>

	updates from gnulib

Tue Oct 28 10:22:45 +0100 2008 Jim Meyering <meyering@redhat.com>

	use more gnulib modules
	* bootstrap: use more gnulib modules: close, connect, perror, recv,
	send, socket setsockopt, gethostname.

Tue Oct 28 10:22:44 +0100 2008 Jim Meyering <meyering@redhat.com>

	adapt to API change in gnulib
	* qemud/qemud.c: Include <netdb.h>, not "getaddrinfo.h"
	* src/remote_internal.c: Likewise.

Tue Oct 28 10:22:22 +0100 2008 Jim Meyering <meyering@redhat.com>

	* src/network_conf.c: Include <string.h> for declaration of memcmp.

Mon Oct 27 17:14:56 +0100 2008 Jim Meyering <meyering@redhat.com>

	use ARRAY_CARDINALITY more
	* tests/nodeinfotest.c: Include "util.h".
	* src/xen_internal.c: Likewise.
	* src/qemu_conf.c (qemudCapsInit): Use ARRAY_CARDINALITY.
	* src/storage_backend.c (virStorageBackendForType): Likewise.
	* src/storage_backend_fs.c (virStorageBackendProbeFile): Likewise.
	* src/xen_internal.c (xenHypervisorMakeCapabilitiesInternal): Likewise.
	* src/xend_internal.c (xenDaemonParseSxpr): Likewise.
	* tests/nodeinfotest.c (mymain): Likewise.
	* tests/qparamtest.c (DO_TEST): Likewise.

Mon Oct 27 17:14:56 +0100 2008 Jim Meyering <meyering@redhat.com>

	exempt gnulib from write-avoidance syntax check

Mon Oct 27 11:17:32 +0100 2008 Jim Meyering <meyering@redhat.com>

	exempt gnulib from ctype-macros prohibition

Fri Oct 24 14:09:23 BST Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Add check for sys/poll.h
	* examples/domain-events/events-c/event-test.c: Stub out
	no-op main() on platforms without sys/poll.h
	* src/libvirt.c, src/remote_internal.c: Remove redundant
	include of sys/poll.h breaking mingw

Fri Oct 24 13:04:23 BST Daniel P. Berrange <berrange@redhat.com>

	* src/storage_conf.c: Remove <tab> character
	* include/libvirt/libvirt.h.in: Remove trailing whitespace

Fri Oct 24 12:32:23 BST Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c, src/openvz_conf.h: Extract version
	info from vzctl tool
	* src/openvz_driver.c: Implement the getVersion API call.

Fri Oct 24 12:30:23 BST Daniel P. Berrange <berrange@redhat.com>

	Fix mingw build
	* src/Makefile.am: Add windows icon files to EXTRA_DIST

Fri Oct 24 12:17:23 BST Daniel P. Berrange <berrange@redhat.com>

	* src/capabilities.c, src/capabilities.h: Record MAC address
	prefix info for hypervisor
	* src/domain_conf.c, src/domain_conf.h: Use capabilities to
	find MAC address prefix when generating MAC addrs
	* src/lxc_conf.c, src/lxc_driver.c, src/openvz_conf.c,
	src/qemu_conf.c, src/qemu_driver.c, src/xen_internal.c,
	src/xend_internal.c, src/xm_internal.c: Provide vendor
	MAC address prefix to capabilities
	* src/util.c, src/util.h: Generic method for generating
	mac addresses.

Fri Oct 24 10:54:23 CEST Jim Meyering <meyering@redhat.com>

	fix mingw compilation warning
	* src/libvirt.c (winsock_init) [HAVE_WINSOCK2_H]: Always return a value.

Thu Oct 23 15:20:00 CEST 2008 Chris Lalancete <clalance@redhat.com>
	* src/storage_conf.c: brown paper bag bug.  I didn't preserve the
	<sources> tags properly, and I didn't put the <source> tag into the
	proper place, so I totally changed the output of the discovery XML.
	Fix this up to do the right thing.

Thu Oct 23 15:11:03 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/libvirt.c src/libvirt_sym.version: new libvirt event entry
	  points, big patch provided by Ben Guthro
	* Makefile.am configure.in src/driver.h src/event.c src/event.h
	  src/internal.h src/libvirt.c src/libvirt_sym.version src/lxc_driver.c
	  src/openvz_driver.c src/qemu_conf.h src/qemu_driver.c
	  src/remote_internal.c src/storage_backend_fs.c src/test.c
	  qemud/event.c qemud/event.h qemud/mdns.c qemud/qemud.c
	  qemud/qemud.h qemud/remote.c qemud/remote_dispatch_localvars.h
	  qemud/remote_dispatch_proc_switch.h qemud/remote_dispatch_prototypes.h
	  qemud/remote_protocol.c qemud/remote_protocol.h
	  qemud/remote_protocol.x proxy/Makefile.am python/generator.py:
	  Not much is left untouched by the patch adding the events support
	* docs/libvirt-api.xml docs/libvirt-refs.xml
	  docs/html/libvirt-libvirt.html: regenerated the docs
	* examples/domain-events/events-c/Makefile.am
	  examples/domain-events/events-c/event-test.c: a test example
	* AUTHORS: added Ben Guthro

Thu Oct 23 13:41:49 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/apps.html docs/apps.html.in: update monitoring apps section

Thu Oct 23 13:38:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/storage_backend_logical.c src/storage_conf.c
	src/storage_conf.h: Add <device> tags to the XML returned by
	virConnectFindPoolSources for storage_backend_logical.

Thu Oct 23 13:31:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/storage_backend.h src/storage_backend_disk.c
	src/storage_backend_fs.c src/storage_backend_logical.c
	src/storage_conf.c: Fix up a regression caused by the transition of
	the storage backends to VIR_ENUM_IMPL.  Before, we would accept
	no format type, which would then use whatever the default for the pool
	was.  But the conversion caused this to instead cause a SEGFAULT,
	which isn't good.  Introduce a .defaultFormat parameter so that we
	restore the previous behavior, although in a more generic format.

Wed Oct 22 09:53:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* configure.in: Fix syntax error which was breaking RPM builds.

Tue Oct 21 19:22:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/storage_conf.c: Make logical pool dumpXML more idempotent with
	  defineXML by outputting <device name='/dev/sdb' /> when we are
	  dumping XML.  We only use the longer <device
	  name='/dev/sdb'>foo</device> when a pool has .nfreeExtent defined.

Tue Oct 21 19:18:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/storage_conf.c: Make sure to set errors on paths where
	  ->formatToString() or ->formatFromString() fail.

Tue Oct 21 19:13:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/qemu_driver.c src/storage_conf.c src/network_driver.c
	  src/storage_driver.c: Shore up the uses of virGetLastError() so that
	  if a path forgets to set a virError, we don't crash while trying
	  to dereference the NULL pointer to print out.

Tue Oct 21 09:19:24 PDT 2008 Dan Smith <danms@us.ibm.com>
	* src/cgroup.c src/cgroup.h: Add function to allow major device range
	* src/lxc_container.h src/controller.c: Fix cgroup initialization
	  order and fix /dev/pts cgroup permission

Tue Oct 21 16:25:22 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* HACKING: update with some rules for commiters
	* docs/apps.html docs/apps.html.in: add a section on monitoring
	  support

Tue Oct 21 15:08:02 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: cleanup patch for usb masstorage hotadd
	  by Guido Günther

Mon Oct 20 09:45:42 CEST Jim Meyering <meyering@redhat.com>

	ALL_LINGUAS: set unconditionally, using $srcdir/po
	* configure.in: Remove hard-coded list altogether.

Sun Oct 19 11:40:49 CEST Jim Meyering <meyering@redhat.com>

	ALL_LINGUAS: remove "no", now that it's superseded by np.po
	* configure.in: Remove "no" from hard-coded list.

Fri Oct 17 14:30:48 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: add scsi/virtio hotplug support for KVM
	  patch by Guido Günther

Fri Oct 17 11:58:31 +0200 Jim Meyering <meyering@redhat.com>

	Makefile.maint (sync-vcs-ignore-files): avoid risk of abuse
	* Makefile.maint (sync-vcs-ignore-files): Rewrite rule so that
	it won't misbehave even with maliciously-named sub-directories.

	generate .gitignore files from .cvsignore ones
	* Makefile.maint (sync-vcs-ignore-files): New target.
	Prompted by a patch from James Morris.
	http://thread.gmane.org/gmane.comp.emulators.libvirt/8619/focus=8773
	Add all (now-generated) .gitignore files.
	* .gitignore: New file.
	* build-aux/.gitignore: New file.
	* docs/.gitignore: New file.
	* docs/devhelp/.gitignore: New file.
	* docs/examples/.gitignore: New file.
	* docs/examples/python/.gitignore: New file.
	* gnulib/lib/.gitignore: New file.
	* gnulib/lib/arpa/.gitignore: New file.
	* gnulib/lib/netinet/.gitignore: New file.
	* gnulib/lib/sys/.gitignore: New file.
	* gnulib/tests/.gitignore: New file.
	* include/.gitignore: New file.
	* include/libvirt/.gitignore: New file.
	* po/.gitignore: New file.
	* proxy/.gitignore: New file.
	* python/.gitignore: New file.
	* python/tests/.gitignore: New file.
	* qemud/.gitignore: New file.
	* src/.gitignore: New file.
	* tests/.gitignore: New file.
	* tests/confdata/.gitignore: New file.
	* tests/sexpr2xmldata/.gitignore: New file.
	* tests/virshdata/.gitignore: New file.
	* tests/xencapsdata/.gitignore: New file.
	* tests/xmconfigdata/.gitignore: New file.
	* tests/xml2sexprdata/.gitignore: New file.

Fri Oct 17 11:25:43 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: use qemudDiskDeviceName to determine the block
	  device name in qemudDomainBlockStats(), patch by Guido Günther

Fri Oct 17 11:20:48 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: fix qemudDiskDeviceName to handle disk devices
	  too, patch by Guido Günther

Fri Oct 17 11:16:30 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c: fix virDiskNameToBusDeviceIndex() to allow 0
	  patch by Guido Günther

Thu Oct 16 19:17:25 +0200 Jim Meyering <meyering@redhat.com>

	build: when po-check fails, say why and suggest a fix
	* Makefile.maint (po-check): Before, when this check failed, it just
	spat out a diff mentioning two temporary files.  Now, it tells you
	what's wrong and suggests a fix with a patch using the name of the
	affected file (rather than temporary file names) in the diff output.

Thu Oct 16 17:02:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* Add support for detecting the partition table type when scanning
	iSCSI volumes.  This is implemented in the
	virStorageBackendUpdateVolInfoFD function, so all future callers will
	automatically benefit.  This is a somewhat large patch because the
	conversion of the virStorageBackendPartTableTypeToString necessitated
	a change to the formatToString and formatFromString function pointers,
	which caused fallout in other places in the storage stuff.  The good
	news is that most of these callers are now converted over to the
	VIR_ENUM_IMPL, which means a lot of redundant code is now gone.

Thu Oct 16 15:41:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* Compiling with -Werror showed a possible use before initialization
	in src/qemu_driver.c.  Make sure to initialize the origdisk ptr to
	NULL.

Thu Oct 16 15:04:36 +0200 Jim Meyering <meyering@redhat.com>

	build: exempt *.ico files from the trailing blank check
	* .x-sc_trailing_blank: Add \.ico$ to the list.

Wed Oct 16 14:03:00 CEST 2008 Chris Lalancette <clalance@redhat.com>

	* "make syntax-check" was complaining that network_driver.c was
	missing from POTFILES.in.  Add it, and then fix up one warning about
	included c-ctypes.h that wasn't being used.

Wed Oct 15 19:38:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, src/Makefile.am, src/virsh_win_icon.rc:
	Add a Windows icon resource.

Wed Oct 15 11:28:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c: Register the remote driver even when we are
	configured --without-libvirtd.  Also adds debugging of
	registration events.

Mon Oct 13 18:45:43 CEST 2008 Jim Meyering <meyering@redhat.com>

	avoid many format string warnings

	Building with --disable-nls exposed many new warnings like these:
	virsh.c:4952: warning: format not a string literal and no format ...
	util.c:163: warning: format not a string literal and no format arguments
	All but one of the following changes add a "%s" argument before
	the offending _(...) argument.

	This was the only manual change:
	* src/lxc_driver.c (lxcVersion): Use %s and strerror(errno)
	rather than %m, to avoid a warning from gcc -Wformat-security.

	Add "%s" before each warned about format-string-with-no-%-directive:
	* src/domain_conf.c (virDomainHostdevSubsysUsbDefParseXML)
	(virDomainDefParseString, virDomainDefParseFile):
	* src/hash.c (virGetConnect, __virGetDomain, virReleaseDomain)
	(__virGetNetwork, virReleaseNetwork, __virGetStoragePool)
	(virReleaseStoragePool, __virGetStorageVol, virReleaseStorageVol):
	* src/lxc_container.c (lxcContainerChild):
	* src/lxc_driver.c (lxcDomainDefine, lxcDomainUndefine)
	(lxcDomainGetInfo, lxcGetOSType, lxcDomainDumpXML)
	(lxcSetupInterfaces, lxcDomainStart, lxcDomainCreateAndStart)
	(lxcVersion, lxcGetSchedulerParameters):
	* src/network_conf.c (virNetworkDefParseString)
	(virNetworkDefParseFile):
	* src/openvz_conf.c (openvzReadNetworkConf, openvzLoadDomains):
	* src/openvz_driver.c (openvzDomainDefineCmd)
	(openvzDomainGetInfo, openvzDomainDumpXML, openvzDomainShutdown)
	(openvzDomainReboot, ADD_ARG_LIT, openvzDomainDefineXML)
	(openvzDomainCreateXML, openvzDomainCreate, openvzDomainUndefine)
	(openvzDomainSetAutostart, openvzDomainGetAutostart)
	(openvzDomainSetVcpus):
	* src/qemu_driver.c (qemudDomainBlockPeek, qemudDomainMemoryPeek):
	* src/remote_internal.c (remoteDomainBlockPeek)
	(remoteDomainMemoryPeek, remoteAuthPolkit):
	* src/sexpr.c (sexpr_new, _string2sexpr):
	* src/storage_backend_disk.c (virStorageBackendDiskMakeDataVol)
	(virStorageBackendDiskCreateVol):
	* src/storage_backend_fs.c
	(virStorageBackendFileSystemNetFindPoolSources):
	* src/storage_backend_logical.c (virStorageBackendLogicalFindLVs)
	(virStorageBackendLogicalFindPoolSources):
	* src/test.c (testOpenDefault, testOpenFromFile, testOpen)
	(testGetDomainInfo, testDomainRestore)
	(testNodeGetCellsFreeMemory):
	* src/util.c (virExec):
	* src/virsh.c (cmdAttachDevice, cmdDetachDevice)
	(cmdAttachInterface, cmdDetachInterface, cmdAttachDisk)
	(cmdDetachDisk, cmdEdit):
	* src/xend_internal.c (do_connect, wr_sync, xend_op_ext)
	(urlencode, xenDaemonDomainCreateXML)
	(xenDaemonDomainLookupByName_ids, xenDaemonDomainLookupByID)
	(xenDaemonParseSxprOS, xend_parse_sexp_desc_char)
	(xenDaemonParseSxprChar, xenDaemonParseSxprDisks)
	(xenDaemonParseSxpr, sexpr_to_xend_topology, sexpr_to_domain)
	(xenDaemonDomainFetch, xenDaemonDomainGetAutostart)
	(xenDaemonDomainSetAutostart, xenDaemonDomainMigratePerform)
	(xenDaemonDomainDefineXML, xenDaemonGetSchedulerType)
	(xenDaemonGetSchedulerParameters)
	(xenDaemonSetSchedulerParameters, xenDaemonDomainBlockPeek)
	(xenDaemonFormatSxprChr, virDomainXMLDevID):
	* src/xm_internal.c (xenXMConfigCacheRefresh, xenXMDomainPinVcpu)
	(xenXMDomainCreate, xenXMDomainDefineXML)
	(xenXMDomainAttachDevice, xenXMDomainDetachDevice):
	* src/xml.c (virXPathString, virXPathNumber, virXPathLong)
	(virXPathULong, virXPathBoolean, virXPathNode, virXPathNodeSet):
	* src/xs_internal.c (xenStoreOpen):

Mon Oct 13 16:24:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Documentation for NIC model selection.
	* docs/formatdomain.html.in, docs/formatdomain.html: Add the
	documentation for NIC model selection.

Mon Oct 13 16:22:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Build failure fixed.
	* src/domain_conf.c: Fix build failure of the Xen proxy.

Sat Oct 11 09:23:18 CEST 2008 Jim Meyering <meyering@redhat.com>

	testError format strings: explicitly include domain and network names
	This repairs the "make check" failure of tests/undefine.
	* src/test.c (testResumeDomain, testPauseDomain): Likewise.
	(testShutdownDomain, testGetDomainInfo, ): Likewise.
	(testSetMemory, testSetVcpus, testDomainCreate, testDomainUndefine)
	(testDomainGetSchedulerType, testDomainGetSchedulerParams): Likewise.
	(testDomainSetSchedulerParams, testNetworkUndefine): Likewise.
	(testNetworkStart, testNetworkGetBridgeName): Likewise.
	(testDomainCoreDump, testDomainSave): Likewise, and...
	Name the file upon failed open or write.
	Use strerror(errno) in diagnostics.
	* tests/undefine: Adjust expected output.

	test.c (testError): Remove now-ignored dom and net parameters.
	This is a sytnax-only change: removing the two unused parameters
	and updating all callers:
	* src/test.c (GET_DOMAIN, GET_NETWORK, testError)
	(testBuildCapabilities, testOpenDefault, testOpenFromFile)
	(testOpen, testGetHostname, testGetURI, testGetCapabilities)
	(testLookupDomainByID, testLookupDomainByUUID)
	(testLookupDomainByName, testResumeDomain, testPauseDomain)
	(testShutdownDomain, testGetDomainInfo, testDomainSave)
	(testDomainRestore, testDomainCoreDump, testGetOSType)
	(testSetMemory, testSetVcpus, testListDefinedDomains)
	(testNodeGetCellsFreeMemory, testDomainCreate)
	(testDomainUndefine, testDomainGetSchedulerType)
	(testDomainGetSchedulerParams, testDomainSetSchedulerParams)
	(testLookupNetworkByUUID, testLookupNetworkByName)
	(testListNetworks, testListDefinedNetworks, testNetworkUndefine)
	(testNetworkStart, testNetworkGetBridgeName): Update callers.

Fri Oct 10 19:16:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/memory.c: If size*count== 0, then virRelloc must not
	return a failure, it is same as virFree.

Fri Oct 10 17:51:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvirt.rng: Document SDL attributes in schema
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Support
	SDL display configuration
	* tests/qemuxml2argvtest.c: Set predictable env vars for SDL
	tests.
	* tests/qemuxml2argvdata/*.args: Add new env vars now set
	explicitly

Fri Oct 10 17:03:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c, src/domain_conf.h, src/lxc_container.c,
	src/lxc_controller.c, src/lxc_driver.c, src/openvz_conf.c,
	src/openvz_driver.c, src/qemu_conf.c, src/qemu_driver.c,
	src/xend_internal.c, src/xend_internal.h, src/xminternal.c:
	Switch to using arrays instead of linked lists for devices
	* tests/sexpr2xmldata/sexpr2xml-fv-v2.xml: Fix device ordering

Fri Oct 10 15:39:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_conf.c, src/storage_conf.h, src/storage_driver.c,
	src/storage_backend_disk.c, src/storage_backend_fs.c,
	src/storage_backend_iscsi.c, src/storage_backend_logical.c:
	Switch storage objects to array instead of linked list

Fri Oct 10 15:39:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/network_conf.c, src/network_conf.h, src/network_driver.c,
	src/test.c: Switch to using array instead of linked list for
	network objects

Fri Oct 10 15:19:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c, src/domain_conf.h: Switch to using
	array instead of linked list for domain objects
	* src/lxc_conf.h, src/lxc_driver.c, src/openvz_conf.c,
	src/openvz_conf.h, src/openvz_driver.c, src/qemu_conf.h,
	src/qemu_driver.c test.c: Update to manage domain objects
	in array instead of linked list

Fri Oct 10 14:56:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: option to enable/disable network driver
	* src/Makefile.am: Add network_driver.c/.h files
	* src/libvirt.c: Import network_driver.h file
	* src/qemu_conf.c, src/qemu-conf.h, src/qemu_driver.c: Remove
	all network driver support
	* src/network_driver.c, src/network_driver.h: Add standalone
	network driver

Fri Oct 10 13:30:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c, src/xen_internal.c: Cast some args to unsigned
	long to avoid printf format specifier warnings on 32-bit

Fri Oct 10 12:30:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Updated MinGW spec file.
	* .cvsignore, Makefile.am, autobuild.sh, configure.in,
	  mingw32-libvirt.spec.in: Import the latest MinGW libvirt spec
	  file.  Note that the file has been renamed to conform to
	  new Fedora packaging guidelines.
	* autobuild.sh: Fix a bug in the generation of the $EXTRA_RELEASE
	  field when autobuilding.

Fri Oct 10 11:17:59 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h[.in] include/libvirt/virterror.h
	  qemud/remote* src/driver.h src/libvirt.c src/libvirt_sym.version
	  src/lxc_driver.c src/openvz_driver.c src/proxy_internal.c
	  src/qemu_driver.c src/remote_internal.c src/test.c src/virsh.c
	  src/xen_internal.c src/xen_unified.c src/xen_unified.h
	  src/xend_internal.c src/xend_internal.h src/xm_internal.c
	  src/xs_internal.c docs/*: cleanup virDomainCreateLinux into
	  virDomainDefineXML, and a few additional cleanups

Fri Oct 10 10:33:29 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c src/util.c: fix index creation for disks >
	  {sd,hd,xvd,vd}z (Sanjay Rao and Chris Wright)

Thu Oct  9 11:30:00 EST Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c src/hash.c src/internal.h src/lxc_conf.c
	  src/lxc_conf.h src/network_conf.c src/openvz_conf.c src/openvz_conf.h
	  src/proxy_internal.c src/qemu_conf.c src/qemu_conf.h src/qparams.c
	  src/sexpr.c src/storage_conf.c src/storage_conf.h src/test.c
	  src/util.c src/virterror.c src/xen_internal.c src/xen_unified.c
	  src/xend_internal.c src/xm_internal.c src/xml.c src/xs_internal.c:
	  Centralize majority of error reporting logic.

Thu Oct  9 15:49:25 BST Daniel P Berrange <berrange@redhat.com>

	* src/lxc_driver.c: Annotate unused parameter
	* src/virsh.c: Fix scanf format specifier

Wed Oct  8 08:29:25 PDT 2008 Dan Smith <danms@us.ibm.com>
	* src/cgroup.c src/cgroup.h: Add cpu shares manipulation
	* src/lxc_driver.c: Add scheduler parameters interface for cpu shares
	* src/virsh.c: Add generic scheduler parameter interface

Wed Oct  8 15:42:44 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/cgroup.c: use safewrite()
	* src/qemu_driver.c: missing VIR_FREE pojnted out by Eduardo Habkost

Tue Oct  7 23:08:51 CEST 2008 Jim Meyering <meyering@redhat.com>

	avoid "make syntax-check" failure
	* src/cgroup.c (virCgroupSetValueStr): Use safe_write, not write.

Tue Oct  7 18:33:39 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: another OOM handling cleanup (Guido Günther)

Tue Oct  7 17:59:59 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: don't print and extra OOM error on top of
	  getpwuid error (Guido Günther)

Mon Oct  6 15:47:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* qemud/remote.c src/hash.c src/internal.h src/lxc_conf.c
	  src/lxc_container.c src/lxc_controller.c src/lxc_driver.c
	  src/remote_internal.c src/storage_backend_disk.c src/veth.c
	  src/xen_internal.c src/xen_unified.c src/xend_internal.c:
	  Move DEBUG and DEBUG0 macros to central location.

Mon Oct  6 15:32:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/qemu_conf.c: Fix possible segfault if starting a qemu guest with
	  with an inactive virtual network.

Mon Oct  6 15:23:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* tests/domainschematest: Slim down schema test result output

Mon Oct  6 17:39:12 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/lxc_driver.c src/qemu_driver.c src/remote_internal.c
	  src/storage_driver.c: use C99 initializers for virState (Guido
	  Gunther)

Mon Oct  6 11:23:40 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Fix VPATH build (Guido Gunther)

Mon Oct  6 12:08:40 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* po/no.po: removed it's obsoleted by np.po, fixes #335211

Thu Oct  3 09:32:42 PDT 2008 Dan Smith <danms@us.ibm.com>
	* src/lxc_container.h src/lxc_container.c
	  src/lxc_controller.c src/lxc_driver.c: Use internal cgroup
	  API to manipulate cgroups for LXC resource control

Thu Oct  3 09:32:42 PDT 2008 Dan Smith <danms@us.ibm.com>
	* src/cgroup.c src/cgroup.h: Add internal cgroup manipulation API

Thu Oct  2 17:01:32 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: fix bug #465274 to build on RHEL

Thu Oct  2 10:06:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: Fix startup timeout with multiple pty devices.

Wed Oct  1 17:28:47 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: fix ordering when parsing multiple Xen
	  interfaces, patch by Jim Fehlig
	* python/Makefile.am: fix parallel build

Thu Sep 25 13:37:42 IST 2008 Mark McLoughlin <markmc@redhat.com>

	* docs/virsh.pod: fixup some minor issues - e.g. bogus
	references to "xm"

Tue Sep 23 22:45:47 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in NEWS docs/*: release of libvirt-0.4.6
	* src/storage_backend_logical.c: re-add the -f flag to vgremove
	* po/*: rebuilt

Tue Sep 23 12:17:22 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* po/pt_BR.po: updated brazilian translation

Mon Sep 22 22:18:16 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_logical.c: enable stop pool in logical backend
	  improve portability when deleting a pool and also call pvremove
	  patch by Chris Lalancette

Mon Sep 22 21:55:55 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_conf.c: fixes parsing to allow no sources for a pool
	  fix by Dan and Chris Lalancette

Mon Sep 22 18:00:39 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/remote_internal.c src/storage_driver.c: structure init fixes
	  by Chris Lalancette

Mon Sep 22 17:14:25 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c: patch from Evgeniy Sokolov to read
	  network config in OpenVZ driver.

Thu Sep 18 11:19:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Remove commands which were deleting
	development files mistakenly

Thu Sep 18 09:55:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Documentation cleanups.
	* docs/bindings.html.in: Clean up the bindings page, and add
	  C# and Java.
	* docs/windows.html.in: Remove old bogus information and add
	  placeholder.

Thu Sep 18 09:52:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c, configure.in, libvirt.spec.in: Remove
	trailing whitespace & fix diagnostic string translation.

Wed Sep 17 17:02:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/openvz_driver.c: Fix segfault in OpenVZ driver
	  (Evgeniy Sokolov).

Wed Sep 17 16:38:00 BST 2008 Daniel P berrange <berrange@redhat.com>

	* tests/xmconfigdata/test-paravirt-new-pvfb-vncdisplay.xml,
	 tests/xmconfigdata/test-paravirt-old-pvfb-vncdisplay.xml,
	 tests/xml2sexprdata/xml2sexpr-pv-vfb-new-auto.sexpr: Remove
	redundant emulator tags which broke test cases.

Wed Sep 17 15:26:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/storage_backend_disk.c: Missing include file.

Wed Sep 17 15:18:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/qemu_driver.c: Remove some deadcode (Nguyen Anh Quynh).

Wed Sep 17 15:14:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: Change name of "blocked" state to "idle" (John Levon).

Wed Sep 17 15:10:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* include/libvirt/libvirt.h.in, src/libvirt.c: Fix comments
	  which incorrectly referred to non-existent 'virDomainFlags'
	  type (Anton Protopopov).

Wed Sep 17 15:08:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/conf.c: Improved error messages in XM conf module.

Wed Sep 17 15:03:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* libvirt.spec.in: Specfile enhancements for minimal
	  "client only" build (Ben Guthro).

Wed Sep 17 15:03:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, src/qemu_driver.h, src/qemu_driver.c: KVM
	  can determine max VCPUs at runtime (Guido Günther).

Tue Sep 16 12:43:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/storack_backend_disk.c: Implement disk volume delete

Tue Sep  9 09:50:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/xend_internal.c: fix reading vncdisplay from xend domain
	* tests/sexpr2xmldata/sexpr2xml-pv-vfb-new-vncdisplay.sexpr
	  tests/sexpr2xmldata/sexpr2xml-pv-vfb-new-vncdisplay.xml,
	  tests/xmconfigdata/test-paravirt-new-pvfb-vncdisplay.cfg,
	  tests/xmconfigdata/test-paravirt-new-pvfb-vncdisplay.xml,
	  tests/xmconfigdata/test-paravirt-old-pvfb-vncdisplay.cfg,
	  tests/xmconfigdata/test-paravirt-old-pvfb-vncdisplay.xml,
	  tests/xml2sexprdata/xml2sexpr-pv-vfb-new-auto.sexpr,
	  tests/xml2sexprdata/xml2sexpr-pv-vfb-new-auto.xml:
	  Add tests for various xen vnc cases.

Tue Sep  9 09:42:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/qemu_conf.c : fix a segfault if no qemu emulator is passed
	  when defining a domain.

Mon Sep  8 16:28:30 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/*: preparing release of
	  libvirt-0.4.5
	* po/*: rebuilt and updated de.po

Mon Sep  8 14:42:23 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/network_conf.c src/network_conf.h src/qemu_driver.c: add
	  support for a domain name in network configurations, patch by
	  JJ Reynolds with bugfix raised by Dan
	* src/openvz_conf.c: fix to small bug in openvzReadConfigParam
	  by Evgeniy Sokolov

Mon Sep  8 13:14:17 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_driver.c: Fix potential NULL dereference

Mon Sep  8 09:18:17 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_logical.c: finish applying initialization
	  from Jim Fehlig patch for logical storage backend

Fri Sep  5 15:59:26 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c, src/openvz_driver.c: Fix trailing
	whitespace mistakes

Fri Sep  5 15:09:26 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c, src/openvz_conf.h, src/openvz_driver.c,
	src/openvz_driver.h: Convert to generic domain XML apis

Fri Sep  5 13:02:26 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Fully support mingw builds
	* .cvsignore: Ignore mingw-libvirt.spec
	* autobuild.sh: Perform mingw build if toolchain is available
	* Makefile.am: Add mingw-libvirt.spec to EXTRA_DIST
	* configure.in: Add check for getuid/getgit. Add gettext()
	check against libintl. Disable storage drivers if libvirtd
	is disabled
	* mingw-libvirt.spec.in: Specfile for mingw cross compile
	* qemud/remote_protocol.{c,x,h}: Add socketcompat.h include
	for htons() methods
	* src/Makefile.am: Don't wrap storage driver conditionals in
	a  libvirtd conditional
	* src/storage_backend.c: Add no-op implementations of
	virStorageBackendRunProgRegex and virStorageBackendRunProgNul
	functions for mingw
	* src/storage_conf.c: Fix typo in getgid() call. Avoid
	not-literal in format string.
	* src/util.c: Fix signature of virExec() for mingw build
	* src/util.h: Add stub impl of getuid/getgid calls

Fri Sep  5 12:50:26 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix starting of Xen domains without PVFB console, by not
	setting emulator path in SEXPR unless asked for
	* src/domain_conf.c, src/domain_conf.h, src/xm_internal.c: Don't
	set emulator path with a default value
	* src/lxc_driver.c, src/qemu_conf.c, src/qemu_driver.c: Find a
	default emulator path if no explicit path is provided in config
	* tests/xmconfigdata/test-paravirt-net-e1000.xml,
	tests/xmconfigdata/test-paravirt-new-pvfb.xml,
	tests/xmconfigdata/test-paravirt-old-pvfb.xml,
	tests/xml2sexprdata/xml2sexpr-fv-kernel.xml: Remove default
	emulator path
	* tests/xml2sexprdata/xml2sexpr-pv-vfb-new.sexpr: Remove
	emulator path

Fri Sep  5 12:33:26 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_unified.c, src/xen_internal.c, src/xen_internal.h,
	tests/xencapstest.c: Pass connection object into capabilities
	constructor since it needs to talk to XenD

Thu Sep  4 15:33:26 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_fs.c: fix a signed/unsigned issue breaking
	  virStorageBackendProbeFile(), patch by Cole Robinson

Thu Sep  4 15:18:00 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: fix an error message, patch by Nguyen Anh Quynh

Thu Sep  4 14:16:20 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Fix make check when augparse is not
	available

Thu Sep  4 15:05:34 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_logical.c: fix a miscalculation of command line
	  size for vgcreate, patch from Jim Fehlig

Thu Sep  4 11:43:20 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Augeas config file support
	* configure.in: Check for augparse tool for test suite
	* libvirt.spec.in, qemud/Makefile.am, qemud/libvirtd.aug,
	qemud/libvirtd_qemu.aug, qemud/test_libvirtd.aug,
	qemud/test_libvirtd_qemu.aug: Augeas lens for processing
	libvirtd.conf and qemu.conf

Thu Sep  4 11:09:20 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: patch from John Levon shutting down a live
	  domain is just more hazardous

Thu Sep  4 11:05:59 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xs_internal.c: use poweroff instead of halt
	  when shutting down a xen domain, patch by John Levon

Thu Sep  4 10:13:43 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: switch flags to unsigned by James Morris
	* AUTHORS: add James Morris

Wed Sep  3 10:14:00 PDT 2008 Dan Smith <danms@us.ibm.com>

	* src/lxc_driver.c:
	  Add hypervisor version implementation

Wed Sep  3 11:52:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/qemu_driver.c:
	  Fix qemu media connect/eject to work with latest syntax. Add support
	  for ejecting floppy devices and scsi cdroms.

Wed Sep  3 10:57:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/qemu_driver.c:
	  Update domain xml after usb device hotplug.

Wed Sep  3 10:42:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/qemu_driver.c: scrape media eject output to determine failure

Wed Sep  3 09:58:00 EST 2008 Cole Robinson <crobinso@redhat.com>

	* src/domain_conf.c: fix disk device ordering when parsing domain
	  xml. check for disk target duplicates as well.
	* tests/xml2sexprdata/xml2sexpr-fv-v2.sexpr: fix for disk ordering
	* tests/xml2sexprdata/xml2sexpr-fv-vncunused.sexpr: fix for disk ordering

Wed Sep  3 14:51:03 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Cole Robinson to avoid a segfault
	  on KVM CD eject

Wed Sep  3 14:37:06 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Cole Robinson to add output on attach
	  and detach success

Wed Sep  3 14:23:48 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* AUTHORS: add Cole Robinson as commiter

Wed Sep  3 09:08:01 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_conf.c: add one missing check in virStoragePoolDefParseDoc

Tue Sep  2 17:30:50 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c: fix a parsing error for input devices
	  patch by Cole Robinson

Tue Sep  2 16:55:01 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c: patch from Cole Robinson to report in the
	  capabilities only the ones where the emulators is actually found
	* po/libvirt.pot: regenerated
	* src/libvirt.c: small typo fix

Tue Sep  2 16:12:20 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend.h src/storage_backend_logical.c
	  src/storage_conf.c src/storage_conf.h src/virsh.c:
	  Applied patches from David Lively to add storage source
	  elements needed for storage pool
	* docs/formatstorage.html docs/formatstorage.html.in: associated
	  documentation

Tue Sep  2 12:28:54 CEST 2008 Jim Meyering <meyering@redhat.com>

	qemu_conf.c: use new function, virFileReadLimFD
	* src/qemu_conf.c (qemudExtractVersionInfo): Use virFileReadLimFD
	and VIR_FREE in place of an open-coded loop and a static buffer.

	util.c: add a file-descriptor-based wrapper for fread_file_lim
	* src/util.c (virFileReadLimFP): New function.
	(__virFileReadLimFD): New function.
	* src/util.h (__virFileReadLimFD): Declare.
	(virFileReadLimFD): Define.
	(virFileReadAll): Rewrite to use virFileReadLimFP.

Fri Aug 29 08:04:15 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/bridge.c, src/proxy_internal.c, src/qemu_conf.c,
	src/qemu_conf.h, src/qemu_driver.c, src/remote_internal.c:
	Switch over to using virExec() function

Thu Aug 28 23:39:15 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: Fix off-by-one to allow making of paths at root
	* src/lxc_container.c: Allow for a private root filesystem
	using pivot_root.

Thu Aug 28 12:58:15 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fix lookup of Xen VMs after define
	(patch from Cole Robinson)

Thu Aug 28 11:08:15 CEST 2008 Jim Meyering <meyering@redhat.com>

	improve parallel build support
	* autobuild.sh: Append -j$N to MAKEFLAGS, if no -j option is there.
	* libvirt.spec.in: Use %{?_smp_mflags} with "make".
	Based on a patch from James Morris:
	http://thread.gmane.org/gmane.comp.emulators.libvirt/8201

Wed Aug 27 20:50:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Storage pool source discovery from David Lively

	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	src/libvirt_sym.version, src/libvirt.c, src/driver.h: Add
	the virConnectFindStoragePoolSources() API
	* src/remote_internal.c, qemu/remote.c, src/remote_protocol.{c,h,x}
	Implement remote protocol support for virConnectFindStoragePoolSources
	* src/remote_dispatch_*.h: Re-generate from remote_protocol.x
	* libvirt.spec.in:Add dep on nfs-utils
	* configure.in: Check for showmount binary
	* src/storage_backend.h, src/storage_driver.c: Generic impl
	of storage discovery
	* src/storage_backend_fs.c, src/storage_backend_logical.c: Add
	specific impl of storage discovery for NFS and LVM
	* src/virsh.c: Add command to discover storage pools

Wed Aug 27 12:40:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.h, src/util.c: Allow virExec to take set of FDs
	to preserve in child.
	* src/lxc_driver.c, src/qemu_driver.c, src/storage_backend.c:
	Preserve FDs as needed

Wed Aug 27 12:20:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_conf.c: Fix handling of EOF when reading list
	of domains

Wed Aug 27 12:14:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_driver.c: Remove incorrect usage of virState
	driver internal apis only intended for drivers within the
	daemon.
	* src/Makefile.am: No need to disable openvz if the
	daemon is disabled.

Fri Aug 22 08:30:00 PDT 2008 Dan Smith <danms@us.ibm.com>

	* src/lxc_driver.c: Make sure we cleanup veth devices at shutdown

Fri Aug 22 11:49:42 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* python/libvir.py: Use libvirt error message as exception
	message for improved diagnostics

Fri Aug 22 10:30:42 CEST 2008 Jim Meyering <meyering@redhat.com>

	configure.in: link with -lpthread when necessary
	* configure.in: Explicitly add -lpthread to $LIBS.
	With an empty "ACTION_IF_FOUND", AC_CHECK_LIB would have done
	that for us automatically, but when there is an explicit third
	argument, those commands are run instead of the default.
	Reported by Jun Koi <junkoi2004@gmail.com>.

Thu Aug 21 21:29:28 CEST 2008 Jim Meyering <meyering@redhat.com>

	autobuild.sh: Fix minor shell-quoting bugs.
	* autobuild.sh: Remove unnecessary quotes.
	Don't choke on a file name argument containing a space.
	Don't misbehave for $AUTOBUILD_INSTALL_ROOT containing
	a shell meta-character.

Wed Aug 21 11:14:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Clarify error messages from various
	failures while opening a connection

Wed Aug 21 11:09:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Propagate error from virConnect to global
	error object for virConnectOpen() failures

Wed Aug 21 10:28:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Add libvirt_lxc to spec file and conditionals
	for lxc/openvz drivers which are now on by default

Wed Aug 21 09:52:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_controller.h: Remove now unused file

Wed Aug 20 21:50:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Include PTY name if available
	* src/Makefile.am: Add lxc_controller binary
	* src/lxc_conf.c, src/lxc_conf.h, src/lxc_controller.c,
	src/lxc_controller.h, src/lxc_driver.c: Move LXC controller
	into a properly exec'd binary, instead of fork'd child of
	libvirtd daemon

Wed Aug 20 21:05:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in, qemud/Makefile.am, src/Makefile.am: Use automake
	conditions when deciding which files to include in build
	* src/bridge.c, src/bridge.h, src/conf.h, src/console.h,
	src/driver.h, src/hash.h, src/internal.h, src/libvirt.c,
	src/lxc_conf.c, src/lxc_conf.h, src/lxc_container.c,
	src/lxc_container.h, src/lxc_driver.c, src/lxc_driver.h,
	src/nodeinfo.h, src/openvz_conf.c, src/openvz_driver.c,
	src/proxy_internal.c, src/proxy_internal.h, src/qemu_conf.c,
	src/qemu_conf.h, src/qemu_driver.c, src/qemu_driver.h,
	src/remote_internal.h, src/test.c, src/test.h, src/veth.c,
	src/xen_internal.c, src/xen_internal.h, src/xen_unified.c,
	src/xen_unified.h, src/xend_internal.c, src/xend_internal.h,
	src/xm_internal.c, src/xs_internal.c, src/xs_internal.h
	tests/testutils.h: Remove preprocessor conditions for driver
	compilation. Remove unneccessary "extern C" declarations.

Wed Aug 20 20:42:09 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c, src/util.h: Add convenience APIs for stripping
	a file extension
	* src/domain_conf.c, src/domain_conf.h, src/lxc_driver.c,
	src/qemu_driver.c: Remove fixed configfile/autostartlink
	fields in virDomainObjPtr. Generate paths on-demand at time
	of use

Wed Aug 20 15:42:09 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_driver.c: patch from Evgeniy Sokolov
	  to limit the number of CPUs used by OpenVZ domains.

Wed Aug 20 15:31:47 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_logical.c: Patch from Cole Robinson, fix
	  creating and cleaning up logical volumes if a target path is
	  specified.

Wed Aug 20 15:18:54 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/parthelper.c: Patch from Cole Robinson, fix size reporting for
	  disks without partitions.

Wed Aug 20 15:11:57 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/Makefile.am: fix the problem
	  of HTML generation in the absence of XHTML1 DTDs in the system
	  catalog.

Wed Aug 20 14:49:29 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/network_conf.c src/network_conf.h src/qemu_driver.c: allow to
	  add static host definition for dnsmasq

Wed Aug 20 10:16:54 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c, src/util.h: Allow flags to be passed to specify
	non-blocking, or daemon mode
	* src/qemu_driver.c, src/openvz_driver.c, src/storage_backend.c:
	Switch to virExec() with VIR_EXEC_NONBLOCK flag

Wed Aug 20 09:59:54 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: Allow a pre-opened FD to be passed in for childs
	stdout/err
	* src/openvz_driver.c, src/qemu_driver.c: Initialize FDs to
	-1 before calling virExec()

Wed Aug 20 09:35:33 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Avoid signal race in virExec()
	* src/util.c: Block signals when forking and clear child's
	signal handlers.
	* src/remote_protocol.{c,h,x}: Add config.h include file
	* src/internal.h: define pthread_sigmask interms of sigprocmask
	for non-pthreads systems

Wed Aug 20 09:28:33 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: Re-arrange virExec() to improve error reporting

Mon Aug 18 10:22:33 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Remove duplicate call to virInitialize() in
	virStateInitialize spotted by Nguyen Anh Quynh

Fri Aug 15 11:00:38 IST 2008 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_conf.c: fix serial/telnet to use "server" option
	rather than "listen"

	* tests/qemuxml2argvdata/qemuxml2argv-serial-tcp-telnet.args:
	fix the test case too

Fri Aug 15 10:34:24 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	* src/virsh.c: fix typo from John Levon
	* src/domain_conf.c, src/openvz_driver.c, src/qemu_driver.c:fix typos

Thu Aug 14 10:06:36 BST 2008 Daniel Berrange <berrange@redhat.com>

	* po/POTFILES.in: Add lxc_controller.c, remove lxc_conf.c

Wed Aug 13 13:40:36 BST 2008 Daniel Berrange <berrange@redhat.com>

	* src/lxc_conf.c, src/lxc_conf.h: Remove all domain XML
	parsing / formatting methods, and all helpers for loading
	and saving files on disk. Added capabilities data object
	* src/lxc_container.c, src/lxc_container.h, src/lxc_driver.c,
	src/lxc_controller.h, src/lxc_controller.c: Switch over
	to use generic domain XML processing APIs.

Wed Aug 13 11:48:36 BST 2008 Daniel Berrange <berrange@redhat.com>

	* configure.in: Add check for termios.h
	* src/util.h, src/util.c: Add virFileOpenTty and helpers
	for creating/deleting/reading PID files
	* src/lxc_conf.h, src/lxc_conf.c, src/lxc_container.c,
	src/lxc_container.h, src/lxc_controller.c,
	src/lxc_controller.h, src/lxc_driver.c: Re-arrange
	container launch process so that the I/O helper is
	a direct parent of the container process. Daemonize
	container so it survives restarts of libvirtd.

Wed Aug 13 11:23:36 BST 2008 Daniel Berrange <berrange@redhat.com>

	Re-arrange code between LXC driver files
	* src/lxc_container.c, src/lxc_container.h,
	src/lxc_controller.h, src/lxc_container.c,
	src/lxc_driver.c: Move code for I/O handling into
	a seprate lxc_controller module, and move code for
	creating containers into lcx_container module.

Wed Aug 13 10:55:36 BST 2008 Daniel Berrange <berrange@redhat.com>

	* src/lxc_conf.h, src/lxc_conf.c, src/lxc_container.h,
	src/lxc_container.c, src/lxc_driver.c: Don't store socket
	or tty state in lxc_vm_t struct. Pass it around as args
	to functions when needed

Wed Aug 13 11:43:36 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/storage.html[.in] src/storage_backend_disk.c: revert previous
	  msdos patch and apply new one from Cole Robinson

Tue Aug 12 19:37:23 CEST 2008 Jim Meyering <meyering@redhat.com>

	rewrite virFileLinkPointsTo
	* src/util.c (SAME_INODE): Define.
	(virFileLinkPointsTo): Rewrite to be more portable and more efficient.

Tue Aug 12 13:28:09 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_disk.c: make sure parted doesn't ask
	  confirmation,  patch by Cole Robinson

Tue Aug 12 13:20:07 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/storage.html[.in] src/storage_backend_disk.c: patch from
	  Cole Robinson to rename the disk type from 'dos' to 'msdos'

Tue Aug 12 17:30:50 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	* src/domain_conf.h src/qemu_driver.c: name changing of
	  stdin, stdout, stderr to add _fd for compilation on MinGW

Tue Aug 12 17:20:36 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	* src/domain.conf.c src/network_conf.c src/util.c src/virsh.c
	  tests/testutilsxen.c: fix compilation for MinGW

Tue Aug 12 10:09:23 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: patch from Cole Robinson trying to fix
	  problem of connection lookup when creating storage instances

Tue Aug 12 10:04:33 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* po/*: regeneration of pot file, updates of .po

Tue Aug 12 09:27:03 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/formatdomain.html docs/formatdomain.html.in: documentation
	  for the USB format option by Guido Günther

Mon Aug 11 14:29:02 CEST 2008 Jim Meyering <meyering@redhat.com>

	tests: append a newline to expected-output files lacking NL-at-EOF
	* tests/qemuxml2argvtest.c (testCompareXMLToArgvFiles): Adjust the
	code that creates "actual" output, so that it too produces a
	newline-terminated buffer.
	* tests/qemuxml2argvdata/*.args: Append a newline to each, via:
	for i in $(find|grep '\.args$'); do echo >> $i;done

Fri Aug  8 16:41:24 BST 2008 Daniel Berrange <berrange@redhat.com>

	* src/iptables.c, src/lxc_driver.c, src/openvz_driver.c,
	src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c,
	src/storage_backend.c, src/storage_backend_disk.c,
	src/storage_backend_fs.c, src/storage_backend_iscsi.c,
	src/storage_backend_logical.c, src/util.c, src/util.h,
	src/veth.c, tests/qemuxml2argvtest.c: Fix const-correctness
	of virRun and virExec, and remove unneccessary casts in callers

Fri Aug  8 16:53:24 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/qemu_conf.c
	  src/qemu_driver.c: patch from Guido Günther allowing to add
	  disk as USB devices
	* docs/libvirt.rng: extend the schemas for the new value
	* tests/qemuxml2argvdata/qemuxml2argv-disk-usb.args
	  tests/qemuxml2argvdata/qemuxml2argv-disk-usb.xml
	  tests/qemuxml2argvtest.c tests/qemuxml2xmltest.c: add a specific
	  test to the regression suite

Fri Aug  8 16:15:55 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.c src/domain_conf.h src/qemu_conf.c
	  src/qemu_driver.c: Patch from Guido Günther allowing to pass
	  usb devices to qemu/kvm
	* docs/libvirt.rng: add the new functionality to the grammar
	* tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-address.args
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-address.xml
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-product.args
	  tests/qemuxml2argvdata/qemuxml2argv-hostdev-usb-product.xml
	  tests/qemuxml2argvtest.c tests/qemuxml2xmltest.c: adding examples
	  to the regression tests
	* libvirt.spec.in: fix the licence tag

Fri Aug  8 19:18:43 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	* docs/formatdomain.html docs/formatdomain.html.in
	docs/java.html docs/java.html.in: fix typos

Thu Aug  7 19:47:40 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* tests/domainschematest: patch from Guido Günther to fix RNG checking
	  in out of tree builds.

Thu Aug  7 06:32:05 PDT 2008 Dan Smith <danms@us.ibm.com>

	* src/veth.c: Fix assigned device name clash

Wed Aug  7 15:02:06 CEST 2008 Jim Meyering <meyering@redhat.com>

	add the mkstemp module from gnulib
	* bootstrap (modules): Add mkstemp.
	The remainder of these changes are the result of running
	./bootstrap, adding new files, and committing the result.
	* gnulib/lib/gettimeofday.c: New file.
	* gnulib/lib/mkstemp.c: New file.
	* gnulib/lib/tempname.c: New file.
	* gnulib/lib/tempname.h: New file.
	* gnulib/m4/gettimeofday.m4: New file.
	* gnulib/m4/mkstemp.m4: New file.
	* gnulib/m4/tempname.m4: New file.
	* gnulib/tests/test-gettimeofday.c: New file.
	* gnulib/lib/Makefile.am: Update.
	* gnulib/m4/gnulib-cache.m4: Likewise.
	* gnulib/m4/gnulib-comp.m4: Likewise.
	* gnulib/m4/inet_pton.m4: Likewise.
	* gnulib/tests/Makefile.am: Likewise.

Thu Aug  7 12:21:31 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/bridge.c: fix a build failure on RHEL4

Wed Aug  7 13:30:44 CEST 2008 Jim Meyering <meyering@redhat.com>

	update from gnulib: portability and bug fixes
	* build-aux/mktempd:
	* build-aux/useless-if-before-free:
	* build-aux/vc-list-files:
	* gnulib/lib/.cvsignore:
	* gnulib/lib/Makefile.am:
	* gnulib/lib/poll.c:
	* gnulib/lib/stdbool.in.h:
	* gnulib/lib/stdio-impl.h:
	* gnulib/lib/stdio.in.h (vasprintf, obstack_printf)
	(obstack_vprintf):
	* gnulib/lib/vasnprintf.c (_GNU_SOURCE, sprintf, IF_LINT, exp)
	(remainder, scale10_round_decimal_long_double)
	(scale10_round_decimal_double, pad_ourselves):
	* gnulib/m4/gnulib-cache.m4:
	* gnulib/m4/gnulib-common.m4 (gl_MODULE_INDICATOR):
	* gnulib/m4/gnulib-tool.m4 (gl_LOCAL_DIR, gl_M4_BASE, gl_PO_BASE)
	(gl_DOC_BASE, gl_TESTS_BASE, gl_WITH_TESTS, gl_LIB, gl_LGPL)
	(gl_MAKEFILE_NAME, gl_MACRO_PREFIX, gl_PO_DOMAIN, gl_VC_FILES):
	* gnulib/m4/lock.m4 (gl_LOCK_EARLY_BODY, gl_PREREQ_LOCK)
	(gl_DISABLE_THREADS):
	* gnulib/m4/onceonly.m4:
	* gnulib/m4/posix-shell.m4 (gl_POSIX_SHELL):
	* gnulib/m4/stdio_h.m4 (gl_STDIO_H_DEFAULTS):
	* gnulib/tests/test-getaddrinfo.c (ENABLE_DEBUGGING, dbgprintf)
	(simple):
	* gnulib/tests/test-stdint.c (UINTMAX_MAX, or):
	* gnulib/tests/test-vc-list-files-cvs.sh:
	* gnulib/tests/test-vc-list-files-git.sh:

	complete the MinGW inet_pton portability fix
	* gnulib/m4/inet_pton.m4: New file.  Required for MinGW.
	* gnulib/m4/gnulib-comp.m4: Regenerate via gnulib-tool.

Tue Aug  6 13:30:44 CEST 2008 Jim Meyering  <meyering@redhat.com>

	fix failing "make syntax-check"
	* src/stats_linux.c: Don't include <c-ctype.h> no longer used.

	work around MinGW build failure due to its lack of inet_aton
	Use inet_pton instead; pull in gnulib's module by the same name.
	* src/network_conf.c (virNetworkDefParseXML): Use inet_pton,
	rather than inet_aton.
	* bootstrap (modules): Add inet_pton.
	* gnulib/lib/inet_pton.c: New file, from gnulib.

Wed Aug  6 13:36:29 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/formatdomain.html docs/formatdomain.html.in: fix memory unit
	  as pointed out by matthew chan it's kilobytes

Wed Aug  6 13:24:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/xend_internal.c: Oops.  My bug fix from yesterday broke the
	  regressions suite.  We do actually need "(device" on the front of
	  the sexpr, but only if we are first creating the domain, not when
	  we are attaching a new disk.  This patch fixes it by adding a flag
	  that we check, and allows the regression suite to pass.

Tue Aug  5 18:43:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/xend_internal.c: Fix three bugs related to virsh attach-disk:
	  a) make sure to break in the xenDaemonAttachDevice() in the switch
	  b) convert a stray fprintf to a virXendError()
	  c) remove an additional "(device" on the front of the sexpr
	  expression passed to xend.  This actually fixes virsh attach-disk
	  and virsh attach-interface work with Xen again

Tue Aug  5 18:36:00 CEST 2008 Chris Lalancette <clalance@redhat.com>
	* src/stats_linux.c tests/statstest.c: Update the parsing of disks for
	  xen block statistics.  In particular, add support for > 16 xvd devices
	  recently put into upstream Xen, and fix up the test suite to fix some
	  wrong tests and add a couple more.

Tue Aug  5 12:51:11 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_conf.h src/openvz_driver.c: patch
	  from Evgeniy Sokolov saving the UUID when creating or defining
	  a domain.

Tue Aug  5 10:43:42 CEST 2008 Jim Meyering  <meyering@redhat.com>

	make distclean: remove generated source files
	* src/Makefile.am (DISTCLEANFILES): Define to $(BUILT_SOURCES)
	so "make distcheck" passes.

Mon Aug  4 15:30:02 JST 2008 Atsushi SAKAI      <sakaia@jp.fujitsu.com>

	* src/xend_internal.c: Replace TAB to space.

Fri Aug  1 15:28:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	'virsh edit' and related commands
	* src/virsh.c: Implement 'virsh edit', 'virsh net-edit' and
	  'virsh pool-edit' commands.  These edit the XML for domains,
	  networks and storage pools respectively, and are the
	  equivalent of doing 'virsh dumpxml; vi foo.xml; virsh define'
	* src/Makefile.am, src/.cvsignore: Auto-generate the net-edit
	  and pool-edit commands.
	* docs/virsh.pod: Updated the documentation.

Fri Aug  1 15:15:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Ensure new VM state is initialized to
	be SHUTOFF, rather than NOSTATE.

Fri Aug  1 15:51:04 CEST 2008 Jim Meyering  <meyering@redhat.com>

	* virsh.c: more const-correctness fixes
	* xend_internal.c, sexpr.c: Likewise.

Fri Aug  1 13:57:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.h, src/domain_conf.c, docs/libvirt.rng: Add
	support for an <init> element in <os> block, and <filesystem>
	device type, and 'exe' OS type.
	* tests/domainschematest: Check domainschemadata directory for
	XML files
	* tests/domainschemadata/domain-lxc-simple.xml: Simple example
	for LXC driver to validate

Fri Aug  1 13:54:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Always set forward-delay even if zero because
	the kernel defaults to 15 seconds which is too long

Fri Aug  1 13:19:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Const-correctness fixes in virsh.c
	* src/virsh.c: Const-correctness.

Fri Aug  1 12:24:44 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Link to "how to contribute to open source"
	* HACKING: Link to external document which describes how to
	  contribute to open source projects.

Fri Aug  1 13:20:44 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Chris Lalancette adding missing
	  carriage returns to logs

Fri Aug  1 11:50:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvirt.rng: Add missing xenfv machine type
	* tests/Makefile.am, tests/domainschematest: Added test
	case to validate all domain XML files in tests/ directory
	against RNG schema

Fri Aug  1 10:38:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Improve error messages when XML is not well-formed.
	* src/domain_conf.c, src/network_conf.c, src/storage_conf.c:
	  Improve error messages from commands such as 'virsh define'
	  when the XML is not well-formed by passing libxml2 errors
	  back out through virterror.

Fri Aug  1 08:40:48 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/formatdomain.html docs/formatdomain.html.in docs/libvirt-api.xml
	  docs/libvirt-refs.xml docs/html/libvirt-libvirt.html src/libvirt.c:
	  fixed somedocs and API entry point descriptions as suggested by
	  Charles Duffy and regenerated the API descriptions.

Fri Aug  1 08:22:08 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: apply patch from Charles Duffy fixing erro
	  messages when trying to crate a domain already defined.

Thu Jul 31 15:37:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: fix previous patch to ensure port number
	is kept as '-1' when autoport is set, and the domain is not
	running.

Thu Jul 31 14:27:00 CEST 2008 Chris Lalancette <clalance@redhat.com>

	* src/domain_conf.c: patch from Charles Duffy to make sure we print
	the "real" vncport if it exists instead of -1.

Wed Jul 30 11:18:50 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Guido Günther, interface stats should
	  not crash on interfaces without an ifname.

Wed Jul 30 10:51:12 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_logical.c: patch from David Lively fixing
	  small differences of behaviour for 'lvs' and 'vgs' on SLES

Wed Jul 30 10:45:41 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c: patch from Guido Günther fixing the place where
	  config file check is done.

Tue Jul 29 14:08:00 CEST 2008 Chris Lalancette <clalance@redhat.com>

	* src/qemu_conf.c: fix empty CD-ROM source device section
	* tests/qemuxml2argvtest.c,
	tests/qemuxml2argvdata/qemuxml2argv-disk-cdrom-empty.xml,
	tests/qemuxml2argvdata/qemuxml2argv-disk-cdrom-empty.args: Add test
	for empty source CD-ROM device section

Tue Jul 29 10:41:30 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c: fix compilation with new XPath interface
	  signatures
	* configure.in: build OpenVZ and LXC support by default

Mon Jul 28 16:04:58 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/domain_conf.[ch] src/openvz_conf.[ch] src/openvz_driver.c:
	  patch from Evgeniy Sokolov doing the OpenVZ xml refactoring,
	  still needs to be ported to the new XML parsing code but
	  implements the new format.

Mon Jul 28 14:50:55 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Guido Günther to make sure create
	  doesn't override an existing domain definition or UUID

Fri Jul 25 17:21:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Fix typos in comments, and the dummy
	filename passed to xmlReadDoc (patch from Chris Lalancette)

Fri Jul 25 17:17:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c: Remove now unused c-ctype.h include

Fri Jul 25 15:21:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c, src/xml.h: Take a virConnectPtr object as param
	for all methods to allow proper error reporting.
	* src/lxc_conf.c, src/domain_conf.c, src/network_conf.c,
	src/storage_conf.c, src/test.c: Pass virConnect object
	to XML routines

Fri Jul 25 15:03:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c, src/xend_internal.h: Expose the
	xenDaemonFormatSxprChr and xenDaemonFormatSxprSound()
	methods to the XM driver
	* src/xm_internal.c, src/xm_internal.h: Switch to use
	new domain APIs for the XML -> config formatter
	* src/xml.h, src/xml.c: Remove unused Xen specific
	APIs which now live in xend_internal.c
	* tests/xmconfigdata/test-fullvirt-usb*.cfg: Add an
	explicit 'usb=1' config setting

Fri Jul 25 14:48:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c, src/xend_internal.h: Remove the
	sound_string_to_xml() and make xenDaemonParseSxprChar
	non-static
	* src/xm_internal.c: Switch config -> XML parser to use
	the new domain APIs

Fri Jul 25 14:29:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Prepare xm_internal driver for new domain XML apis.

	* src/xm_internal.c, src/xm_internal.h: Track internal
	domain objects as virDomainDefPtr instead of virConfPtr
	objects, and start to use generic domain APIs
	* tests/xmconfigdata/*: Update to follow XML ordering
	for new APIs
	* tests/xmconfigtest.c: Fixup to comply with new internal
	APIs.

Fri Jul 25 14:00:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Increment dom ID tracker when setting up
	default domain. Reset dom ID when destroying domain. Fix
	listing of defined domains

Fri Jul 25 14:00:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Convert XenD XML->SEXPR conversion to new domain XML APIs

	* proxy/Makefile.am: no longer need to link xml.c
	* proxy/libvirt_proxy.c: Adapt to use new domain XML
	API contract
	* src/xen_internal.c, src/xen_internal.h: Don't pass a
	connection object when building capabilities.
	* src/xen_unified.c, src/xen_unified.h:  Initialize
	a virCapsPtr object when opening the connection
	* src/xend_internal.c, src/xend_internal.h: Add code
	for converting from XML to SEXPR.
	* src/xml.h, src/xml.c: Remove code for generating SXPR
	* src/xm_intenral.c: Adapt to new SXPR generation
	* tests/xml2sexprdata/*: Update to match new ordering
	for XML / SXPR generation
	* tests/xencapstest.c, tests/xml2sexprtest.c: Fix up
	to work with new internal APIs
	* src/domain_conf.c: Back compat workaround for Xen

Fri Jul 25 14:35:47 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: skip generation for virDomainBlockPeek and
	  virDomainMemoryPeek as they break the build

Fri Jul 25 11:45:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Convert XenD SEXPR->XML conversion to new domain XML APIs

	* proxy/Makefile.am: Link to domain XML formatting APIs
	* src/domain_conf.c, src/domain_conf.h: Disable XML parsing
	routines when used by proxy
	* src/sexpr.c, src/sexpr.h: Added sexpr_node_copy() API
	* src/xend_internal.c, src/xend_internal.h: Convert the
	SEXPR -> XML conversion routines to use the generic domain
	XML APIs
	* tests/sexpr2xmltest.c: Adapt for API changes
	* tests/sexpr2xmldata/*.xml: Update to take account of
	re-ordering of XML due to new APIs

Fri Jul 25 10:44:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Remove unused/no-op code from xen drivers
	* src/proxy_internal.c: Remove no-op xenProxyInit()
	* src/xen_unified.c: Remove calls to no-op init functions
	in sub-drivers.
	* src/xend_internal.c, src/xend_internal.h: Remove misc
	unused methods
	* src/xs_internal.c: Remove no-op xenStoreInit()

Fri Jul 25 10:41:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* autobuild.sh: Force enable OpenVZ, LXC and Xen proxy for
	automated build testing

Fri Jul 25 10:29:27 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Miscellaneous minor bug fixes
	* src/openvz_driver.c: Remove unused convCmdbufExec function
	* src/qemu_conf.c: Use global default VNC listen address if
	no domain specific address is available
	* src/qemu_driver.c: Set CPU affinity to all CPUs if no domain
	specific mask is provided
	* src/test.c: Initialize variable to avoid crash on cleanup
	* tests/.valgrind.supp: Suppress some valgrind warnins from
	global variables not intended to be free'd

Fri Jul 25 11:00:27 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: some uuid to string conversion were missing
	  patch from Guido Günther

Fri Jul 25 10:46:25 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in:
	  remove Xen centric comments patch from Guido Günther
	* docs/apibuild.py: ignore VIR_DEPRECATED
	* docs/libvirt-*.xml docs/html/libvirt-*.html: regenerated the
	  documentation for the API

Fri Jul 25 10:39:54 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: Guido Trotter pointed out a wrong open() failure
	  detection

Fri Jul 25 08:36:18 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/libvirt.rng: patch from John Levon fixing various patterns

Thu Jul 24 09:26:51 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: another patch from Guido Günther checking
	  for an already running domain on create

Thu Jul 24 09:08:32 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Guido Günther checking for
	  unsupported migrate command

Tue Jul 22 19:48:51 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/java.html docs/java.html.in: added documentation for the
	  java bindings

Tue Jul 22 18:11:13 CEST 2008 Jim Meyering <meyering@redhat.com>

	better diagnostic when failing to undefine a running domain via ID
	* src/virsh.c (cmdUndefine): Tell user to shutdown and then use name
	or UUID.
	* tests/undefine: New test.  Exercise virsh's undefine command.
	* tests/Makefile.am (test_scripts): Add undefine.

Mon Jul 21 15:31:52 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_driver.c: patch from Evgeniy Sokolov
	  cleaning up integer string parsing.

Mon Jul 21 11:47:08 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_unified.c: fix a leak in xenUnifiedOpen

Mon Jul 21 10:07:08 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_driver.c: patch from Evgeniy Sokolov to get OpenVZ
	  domain cpu time consumption.

Mon Jul 21 10:01:36 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in: patch from David Lively to try to detect the xen
	  libs when using --with-xen-distdir= on 64bit arches.

Mon Jul 21 09:29:22 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_driver.c: patch from Evgeniy Sokolov avoiding domain
	  lookups based on ID as this doesn't work for a stopped domain.

Sat Jul 19 09:41:53 CEST 2008 Jim Meyering <meyering@redhat.com>

	remove unnecessary "V = NULL;" stmts after VIR_FREE(V)
	* src/domain_conf.c (virDomainChrDefParseXML)
	(virDomainNetDefParseXML): Likewise.
	* src/iptables.c (iptRuleFree): Likewise.
	* src/storage_backend.c (virStorageBackendRunProgRegex): Likewise.
	* src/test.c (testOpenFromFile): Likewise.
	* src/xmlrpc.c (xmlRpcCallRaw): Likewise.

Fri Jul 18 13:01:38 CEST 2008 Jim Meyering <meyering@redhat.com>

	enable format-safety checks for virDomainReportError
	* src/domain_conf.c (virDomainReportError): Declare using
	ATTRIBUTE_FORMAT(printf, 3, 4).
	* Makefile.maint (msg_gen_function): Add virDomainReportError.

Thu Jul 17 17:18:24 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_fs.c: patch from Cole Robinson fixing
	  pool-create for netfs format 'auto'

Thu Jul 17 13:47:56 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Evgeniy Sokolov for the undefine command
	  which can't take an id

Wed Jul 16 22:36:43 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/openvz_driver.c: fix the description of the ID
	  domain lookup and fix the OpenVZ routine

Wed Jul 16 17:25:02 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_driver.c: fix the lookup by ID function and error
	  reporting in OpenVZ, fix by Evgeniy Sokolov

Wed Jul 16 16:44:27 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_driver.c: another cleanup patch from Evgeniy Sokolov
	  cleaning up the exec calls to OpenVZ binaries

Sat Jul 12 14:52:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Remove unneccessary c-ctype.h include

Fri Jul 11 20:32:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Switch
	over to generic domain APIs
	* src/bridge.c, src/bridge.h: Allocate tap device string on
	demand.
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Update
	to new APIs
	* tests/qemuxml2argvdata/: Update data files to match new
	XML generation format

Fri Jul 11 20:28:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/domain_conf.c: Set state to SHUTOFF when loading domain
	config

Fri Jul 11 18:58:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/network_conf.c, src/domain_conf.c: Use full path when
	opening XML files

Fri Jul 11 18:32:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/bridge.c, src/bridge.h, src/qemu_conf.c, src/qemu_conf.h,
	src/qemu_driver.c: Switch over to generic network APIs

Fri Jul 11 17:39:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c, src/test.h: Convert to the new domain XML apis
	* docs/testdomfc4.xml: Update for new syntax
	* docs/testnodeinline.xml: Demo of inline domain & network XML
	* tests/read-non-seekable: Update to have OS block

Fri Jul 11 17:37:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Convert to the new network XML apis

Fri Jul 11 15:49:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Generic APIs for domain XML configuration
	* include/libvirt/virterror.h, src/virterror.c: Added new
	scope VIR_FROM_DOMAIN
	* src/Makefile.am, po/POTFILES.in: Added domain_conf.{c,h}
	* src/xml.c, src/xml.h: Added virXPath{Int,UInt} and
	virXMLPropString functions
	* src/network_conf.c, src/network_conf.h: Added generic
	APIs for domain XML configuration
	* src/util.h: Re-write verify() hook for enums, to allow
	multiple enum declarations per file.

Fri Jul 11 13:08:13 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_driver.c: fix from Evgeniy Sokolov to the probe function

Fri Jul 11 11:35:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	Generic APIs for network XML configuration
	* include/libvirt/virterror.h, src/virterror.c: Added new
	scope VIR_FROM_NETWORK
	* src/Makefile.am, po/POTFILES.in: Added network_conf.{c,h}
	* src/xml.c, src/xml.h: Added virXPathULong function
	* src/network_conf.c, src/network_conf.h: Added generic
	APIs for network XML configuration

Fri Jul 11 10:55:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Fix booting off CDROM devices
	* tests/qemuxml2argvdata/qemuxml2argv-disk-drive-boot-*,
	tests/qemuxml2argvtest.c: New test cases for booting off
	CDROM with QEMU

Fri Jul 11 10:50:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in, qemud/Makefile.am: Rename installed polkit
	policy file to org.libvirt.unix.policy
	* qemud/libvirtd.policy: Default to admin auth instead of
	user auth.

Fri Jul 11 10:48:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Don't default to polkit auth when running
	as non-root

Fri Jul 11 10:46:59 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Fix parsing of QEMU stdout looking for
	serial device PTY with Xenner

Fri Jul 11 10:53:59 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c: cleanup OpenVZ config file accesses, patch
	  from Evgeniy Sokolov

Thu Jul 10 17:28:19 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: Evgeniy Sokolov found a driver open bug
	  in do_open()

Thu Jul 10 14:18:51 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_conf.h src/openvz_driver.c
	  Makefile.maint: patch from Evgeniy Sokolov cleaning up the
	  error function used and format check based on Jim's fedback.

Thu Jul 10 09:58:42 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/libvirt.rng: domain name validation fix by John Levon
	* AUTHORS: add John Levon

Thu Jul 10 09:50:39 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_conf.h src/openvz_driver.c: new
	  patch from Evgeniy Sokolov adding OpenVZ autostart get and set support

Wed Jul  9 13:53:25 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_conf.h src/openvz_driver.c: applied
	  patch from Evgeniy Sokolov fixing error diagnostic when exec'ing
	  OpenVZ commands.
	* AUTHORS: add Evgeniy

Wed Jul  9 11:25:44 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutils.c: Ensure VIR_TEST_DEBUG is used even when
	OOM testing is not compiled in
	* tests/.valgrind.supp: Supress some bogus warnings caused by
	global data we don't expect to ever free.

Wed Jul  9 11:16:44 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/virshtest.c: Remove legacy debugging output

Wed Jul  9 09:19:44 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/qemuxml2argvdata/qemuxml2argv-input-xen.args: Fix to
	match previous change to XML

Wed Jul  9 09:19:31 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c: Preserve the XPath context node to allow relative
	XPath queries to be used

Wed Jul  9 07:23:31 CEST 2008 Jim Meyering <meyering@redhat.com>

	give a more useful diagnostic for tap-add failure w/ENOTSUP
	* src/qemu_conf.c (qemudNetworkIfaceConnect):
	Suggestion from Daniel P. Berrange.

Tue Jul  8 18:47:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xs_internal.c: Fix typo in domain state constant (Toth
	István)

Tue Jul  8 18:42:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/drvqemu.html.in, docs/formatnetwork.html.in: Fix three
	typos pointed out by Anton Protopopov

Tue Jul  8 13:02:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvirt.rng: Updated schema to follow latest XML syntax
	supported by drivers. Based off work by John Levon
	* tests/qemuxml2argvdata/qemuxml2argv-input-xen.xml: Fix boot
	syntax to comply with schema

Mon Jul  7 12:46:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_driver.c: Don't cast pointers to ints, and fix
	the return value to be -1, not 0.

Mon Jul  7 11:34:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutils.c: Remove bogus return statement which
	prevented viewing of differences

Mon Jul  7 11:02:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutils.c: Allow OOM testing to be parallelized by
	setting VIR_TEST_MP=1

Mon Jul  7 11:59:07 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* proxy/libvirt_proxy.c: fix a compilation problem without Xen
	* libvirt.spec.in: add %{release] to BuildRoot

Mon Jul  7 10:39:56 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/capabilities.c: Refactor to avoid memory leak when in
	cleanup from OOM condition

Mon Jun 30 14:07:56 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	Compilation fix for MinGW
	* src/veth.c: add WITH_LXC ifdef

Fri Jun 27 15:05:31 PDT 2008 Dan Smith <danms@us.ibm.com>
	Fix compiler warnings in LXC
	* src/veth.c: remove unused and fix uninitialized variable

Thu Jun 26 19:51:19 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	fix make syntax-check
	* src/xm_internal.c: replace tabs to spaces

Thu Jun 26 18:25:25 JST 2008  Atsushi SAKAI <sakaia@jp.fujitsu.com>

	Compilation fix for MinGW
	* src/driver.h src/internal.h src/libvirt.c src/qemu_driver.c
	  src/remote_internal.c: add WITH_LIBVIRTD flag consideration
	* tests/Makefile.am tests/testutils.c tests/testutilsqemu.c
	  tests/virshtest.c: add WITH_LIBVIRTD flag consideration
	* qemud/Makefile.am: Pass $(LIBVIRT_FEATURES) to consider WITH_LIBVIRTD

Thu Jun 26 16:09:48 PDT 2008 Dan Smith <danms@us.ibm.com>

	Add NETNS support for LXC
	* src/veth.c src/veth.h: Support for managing veth pairs
	* src/lxc_conf.c src/lxc_conf.h src/lxc_container.c
	  src/lxc_driver.c: Add interface parsing and setup for LXC

Wed Jun 25 16:21:12 CEST 2008 Jim Meyering <meyering@redhat.com>

	quiet "make syntax-check"
	* Makefile.maint (strftime-check): Add "@" prefix.
	(po-check): Likewise.

Wed Jun 25 13:40:25 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* python/types.c: patch from Ryan Scott to remove misplaced verbosity
	  when compiling in debug mode.

Wed Jun 25 10:52:05 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in NEWS libvirt.spec* doc/* po/*: making libvirt-0.4.4
	  release
	* src/xm_internal.c: fix xm driver serialization escapes
	* tests/xmconfigtest.c tests/xmconfigdata/test-escape-paths.cfg
	  tests/xmconfigdata/test-escape-paths.xml: add test for previous
	  problem

Wed Jun 25 10:48:39 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* po/*: updated a couple of localizations and regenerated the
	  files

Tue Jun 24 15:59:33 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.h, src/util.c: Added helpers for managing enumerations
	and conversion to/from string vs integer format

Tue Jun 24 15:29:33 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_backend.h, src/storage_backend.c: Fix const-ness
	of virStorageBackendRunProgRegex()

Thu Jun 19 16:29:33 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c src/xend_internal.c: fix a couple of issues
	  for List functions where max given is 0

Thu Jun 19 13:50:41 CEST 2008 Jim Meyering <meyering@redhat.com>

	virsh fails to read files larger than BUFSIZ bytes
	* src/util.c (fread_file_lim): Use VIR_REALLOC_N, not VIR_ALLOC_N.
	Bug introduced in d3470efcda15f59549ac0aaa76cd25df319c217b.
	* tests/Makefile.am (test_scripts): Add read-bufsiz.
	* tests/read-bufsiz: New test for the above.

Thu Jun 19 13:47:00 CEST 2008 Chris Lalancette <clalance@redhat.com>

	* src/memory.c: the new memory API changed the semantics of ALLOC,
	  such that calling VIR_ALLOC(0) returned NULL.  This differed from
	  glibc semantics for malloc().  Remove the offending code to restore
	  glibc semantics.

Thu Jun 19 12:38:00 CEST 2008 Chris Lalancette <clalance@redhat.com>

	* src/qemu_conf.c: fix a bug where we were calling VIR_ALLOC_N
	  in the qemu driver instead of VIR_REALLOC_N, which was causing
	  libvirt to not start domains with multiple networks properly.

Tue Jun 17 14:43:00 CEST 2008 Chris Lalancette <clalance@redhat.com>

	* src/storage_backend.c,src/storage_backend.h,
	  src/storage_backend_iscsi.c, src/storage_backend_logical.c: Change
	  virStorageBackendRunProgRegex to return the exit status instead of
	  reporting an error with non-zero return code.
	* src/util.c: add carriage returns to all virLog() calls since they
	  really just map to fprintf(stderr)
	* src/storage_backend_iscsi.c: Change the call to
	  "iscsiadm --mode session -P 0" to "iscsiadm --mode session"; this
	  will work on all iscsiadm version back to Fedora Core 6.
	* src/storage_backend_iscsi.c: Move the iscsiadm sendtargets discovery
	  mechanism to only be called during --login; we don't need it in
	  --logout.
	* src/storage_backend_iscsi.c: Rewrite the findLuns function to only
	  use sysfs to find LUNs.  Use sysfs "type" parameter to determine if
	  this is a valid LUN or not.  Fix a race condition between sysfs
	  scanning and udev.  Constify all of the "iscsiadm" strings.

Fri Jun 13 11:07:52 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* Makefile.am: adding autogen.sh to EXTRA_DIST

Fri Jun 13 09:55:17 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c: patch from Kaitlin Rupert, dynamic devices
	  for network should be defined in an 'interface' node not 'net'

Thu Jun 12 17:49:23 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in NEWS libvirt.spec* doc/* po/*: making libvirt-0.4.3
	  release

Thu Jun 12 14:46:08 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/lxc_driver.c, src/openvz_driver.c: Add missing driver
	entry points
	* src/lxc_conf.c: Re-arrange headers to comply with standard
	* tests/testutils.c: Fix use of signed/unsigned ints

Thu Jun 12 14:46:08 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Fix saving of iptables rules

Thu Jun 12 11:18:08 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Deal with failure due to inactive virtual
	network when creating domain.

Thu Jun 12 10:53:08 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Kaitlin Rupert, changing vcpu or
	  memory of an active domain is a NO_SUPPORT not INTERNAL_ERROR

Wed Jun 11 17:21:13 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* po/*: update and regenerated

Wed Jun 11 12:25:57 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am: Tweak install rule to fix RPM build

Wed Jun 11 09:42:57 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* python/libvir.py python/libvirt-python-api.xml: more python
	  cleanups by Cole Robinson

Tue Jun 10 17:34:12 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in: patch  from Cole Robinson to reactivate storage
	  support

Tue Jun 10 17:10:31 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* python/generator.py python/libvir.c python/libvirt-python-api.xml:
	  Apply patch from Cole Robinson fixing UUIDString for python

Tue Jun 10 15:33:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Pass syntax check for XM block devices over to XenD
	* src/xm_internal.c: Pass responsibility for checking syntax
	  of XM block devices over the XenD (see also Xen cset 17617).
	  (Hiroyuki Kaguchi).

Tue Jun 10 11:34:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	virDomainMemoryPeek API
	* include/libvirt/libvirt.h.in, src/libvirt.c, src/driver.h,
	  src/libvirt_sym.version: New virDomainMemoryPeek API.
	* qemud/remote.c, qemud/remote_protocol.x, src/remote_internal.c:
	  Support for remote.
	* src/qemu_driver.c: QEMU driver implementation of API.
	* src/test.c: Test driver (null) implementation of API.
	* docs/hvsupport.html.in: Document API.
	* libvirt.spec.in: New path /var/cache/libvirt for temporary
	  storage of memory images.
	* qemud/libvirtd.init.in: Remove any old temp files in
	  /var/cache/libvirt on restarts.
	* src/Makefile.am: make install creates /var/cache/libvirt.
	* configure.in: Detect mkdir -p.

Mon Jun  9 15:42:34 PST 2008 David L. Leskovec <dlesko@linux.vnet.ibm.com>

	* src/lxc_driver.c: Console element is output only.  Always open new
	PTY when starting a container.
	Fix string overrun when storing console name in VM def struct

Mon Jun  9 13:14:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Better error messages in xend driver.
	* src/xend_internal.c: Change virXendError function to take
	varargs.  Better error messages throughout.

Fri Jun  6 12:01:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/bridge.c, src/conf.c, src/iptables.c, src/lxc_conf.c,
	src/lxc_container.c, src/lxc_driver.c, src/openvz_conf.c,
	src/openvz_driver.c, src/proxy_internal.c, src/remote_internal.c,
	src/sexpr.c, src/storage_backend.c, src/storage_backend_disk.c,
	src/storage_backend_fs.c, src/storage_backend_iscsi.c,
	src/storage_backend_logical.c, src/storage_conf.c,
	src/storage_driver.c, src/xen_internal.c, src/xen_unified.c,
	src/xend_internal.c, src/xmlrpc.c: Switch over to use the
	internal memory allocation APIs.

Fri Jun  6 11:41:00 BST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/event.c, qemud/mdns.c, qemud/qemud.c, qemud/remote.c:
	Switch over to use internal memory allocation APIs.
	* src/libvirt_sym.version, src/memory.c, src/memory.h: Export
	virAlloc/Realloc/Free to use by libvirtd daemon

Thu Jun  5 22:08:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	virDomainBlockPeek QEMU and remote support
	* qemud/remote.c, qemud/remote_protocol.x, src/remote_internal.c:
	  Remote support.
	* qemud/remote_dispatch_localvars.h,
	  qemud/remote_dispatch_proc_switch.h,
	  qemud/remote_dispatch_prototypes.h,
	  qemud/remote_protocol.c,
	  qemud/remote_protocol.h:
	  Generated files for remote support.
	* src/xen_unified.c, src/driver.h, src/libvirt.c: Small fix -
	  pass flags around internally.
	* src/qemu_driver.c: Support for QEMU.
	* src/xend_internal.c: Remove redundant fstat call from Xen.

Thu Jun  5 14:10:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	virDomainBlockPeek call
	* configure.in: Document AC_SYS_LARGEFILE.
	* docs/hvsupport.html.in: Document HV support for virDomainBlockPeek.
	* include/libvirt/libvirt.h.in, src/driver.h, src/libvirt.c,
	src/libvirt_sym.version: Add virDomainBlockPeek infrastructure.
	* src/qemu_driver.c, src/test.c: Null versions of this call.
	* src/xen_unified.c, src/xend_internal.c, src/xend_internal.h,
	src/xm_internal.c, src/xm_internal.h: Xen implementation.
	* tests/sexpr2xmldata/sexpr2xml-curmem.xml,
	tests/sexpr2xmldata/sexpr2xml-no-source-cdrom.xml: XML output
	has been reordered slightly in the Xen driver, but should be
	functionally the same.

Wed Jun  4 23:02:21 PST 2008 David L. Leskovec <dlesko@linux.vnet.ibm.com>

	* src/lxc_driver.c: Add sanity check of tty pid before kill()
	Ignore ECHILD errors during VM cleanup
	Call functions to store tty pid and cleanup tty pid file
	* src/lxc_conf.h: Add function to verify container process exists
	Add facilities to manage storing the tty forward process pid
	* src/lxc_conf.c: Add function to verify container process exists
	Call function to verify container process during config load
	Add facilities to manage storing the tty forward process pid
	Call function to load tty pid during load config

Tue Jun  3 08:58:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/xm_internal.c: If vcpu cpuset attribute is invalid
	then display an error instead of silently ignoring it
	(Hiroyuki Kaguchi).

Mon Jun  2 12:52:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	General tips for contributing patches
	* HACKING: Added section "general tips for contributing patches"
	to this file.

Thu May 29 16:43:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* autobuild.sh: Only run converage tests if lcov is installed

Thu May 29 16:09:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Change internal.h to qemud.h to fix
	'make dist'

Thu May 29 15:41:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutils.c: Fix warning when OOM testing is disabled

Thu May 29 15:25:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in, scripts/*: Remove all coverage helper scripts
	in favour of using lcov
	* src/Makefile.am, Makefile.am: Switch to use lcov for pretty
	code coverage reports

Thu May 29 15:17:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Don't register storage API if daemon is
	disabled.
	* configure.in: Fix check for parted to deal with missing
	devel package correctly

Thu May 29 15:17:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/conf.c, src/conf.h, src/qemu_conf.c, src/qemu_driver.c,
	src/test.c, src/util.c, src/xend_internal.c, src/xm_internal.c,
	src/xml.c, tests/virshtest.c: Switch over to using new memory
	allocation APIs.

Thu May 29 14:46:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/memory.h, src/memory.c, tests/testutils.c: Pass allocation
	number to hook callback

Thu May 29 14:45:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/buf.c: Convert to use new memory allocation APIs

Thu May 29 14:44:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fix missing check for failure

Thu May 29 11:29:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/nodeinfotest.c, tests/qemuxml2argvtest.c,
	tests/qemuxml2xmltest.c, tests/qparamtest.c,
	tests/sexpr2xmltest.c, tests/statstest.c,
	tests/xencapstest.c, tests/xmconfigtest.c,
	tests/xml2sexprtest.c: Convert over to new test suite
	infrastructure to enable OOM testing. Avoid use of
	the abs_top_srcdir variable in favour of abs_srcdir

Thu May 29 11:23:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Misc memory handling / cleanup fixes
	* src/capabilities.c: Avoiding deferencing NULL pointer in
	cleanup code
	* src/qemu_conf.c: Free sound structs on cleanup
	* src/qparams.c: raise a libvirt error upon OOM

Thu May 29 11:12:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutils.c, tests/testutils.h: Add generic main()
	impl for test programs to leverage OOM testing
	* tests/Makefile.am, tests/oomtrace.pl: post-processor for
	generating file/line number backtraces from OOM reports.

Thu May 29 11:12:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/memory.c, src/memory.h, configure.ac: Add generics hooks
	for out-of-memory testing

Thu May 29 10:55:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Don't add trailing blanks in dominfo output

Thu May 29 10:41:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* python/libvirt-python-api.xml: Add API overrides for functions
	where the generator doesn't produce correct python wrappers

Thu May 29 13:26:40 JST 2008 Atushi SAKAI <sakaia@jp.fujitsu.com>

	Fix make syntax-check caused by trailing blank(s)
	* test/virshdata/dominfo-fc4.txt: remove trailing blanks

Tue May 27 14:50:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Fix virsh dominfo test.
	* tests/virshdata/dominfo-fc4.txt: 'virsh dominfo' test
	matches actual output with autostart status.

Tue May 27 10:40:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Display autostart status in virsh dominfo command.
	* src/virsh.c: Display autostart status in virsh dominfo
	command (Shigeki Sakamoto).

Tue May 27 09:54:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Fix use of header files in disk storage backend.
	* src/storage_backend_disk.c: Include internal.h to resolve use
	of header files.

Fri May 23 09:23:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Deprecate the conn, dom and net fields in the _virError structure.
	* include/libvirt/libvirt.h.in: Add VIR_DEPRECATED macro.
	* src/internal.h: Internal code is allowed to use deprecated
	features, so override VIR_DEPRECATED here.
	* include/libvirt/virterror.h: Deprecate the conn, dom and net
	fields in the _virError structure.

Fri May 23 08:56:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Standardize use of header files, making internal.h primary.
	* qemud/internal.h, qemud/qemud.h: Rename this file so it
	doesn't conflict with src/internal.h.
	* HACKING: Document how header files should be used.
	* qemud/Makefile.am: Add src/ directory to includes.
	* qemud/event.c, qemud/mdns.c, qemud/qemud.c, qemud/remote.c,
	qemud/remote_protocol.c, qemud/remote_protocol.h,
	qemud/remote_protocol.x, src/buf.c, src/libvirt.c,
	src/nodeinfo.c, src/qemu_conf.c, src/qemu_driver.c,
	src/stats_linux.c, src/storage_backend.c, src/storage_backend_fs.c,
	src/storage_backend_iscsi.c, src/storage_backend_logical.c,
	src/storage_conf.c, src/storage_driver.c, src/util.c,
	src/util.h, src/virsh.c, src/virterror.c, src/xend_internal.c,
	src/xml.c, tests/reconnect.c, tests/xmlrpctest.c,
	tests/qparamtest.c: Standardize	use of header files.
	* docs/*, po/*: Rebuild docs.

Fri May 23 08:54:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Fix type-punning warning in remote code.
	* qemud/rpcgen_fix.pl: Case-insensitive string match on identifiers.
	* qemud/remote_protocol.c: Update this generated file.

Thu May 22 19:47:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qparams.c: Support ; as a param separator. Misc memory
	leaks
	* tests/qparamtest.c, tests/Makefile.am: Add test suite for
	qparams code

Thu May 22 19:44:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Refactor qemudBuildCommandLine to use a
	macro for readability

Thu May 22 12:22:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Apply CPU pinning at startup if requested for QEMU
	* src/qemu_conf.h: Store global CPU pinning data
	* src/qemu_conf.c: Parse and format CPU set mask for vCPUs
	* src/qemu_driver.c: Apply CPU pinning at startup
	* tests/qemuxml2argvdata/*.args: Add in -S arg which is now
	always used
	* src/xml.c, xml.h: Allow use of CPU set functions from QEMU

Thu May 22 12:20:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Add support for VCPU pinning in QEMU driver
	* configure.in: Add checks for sched.h/sched_getaffinity
	* src/qemu_conf.h: Add mapping of vcpu -> pids
	* src/qemu_driver.c: Detect vcpu -> pid mapping at startup
	of VMs. Support vcpu info and vcpu pinning driver APIs

Thu May 22 12:18:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutilsqemu.c: Added missing config.h include

Thu May 22 11:49:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Fix removal of iptables forwarding rules

Thu May 22 11:38:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Remove some duplicated error messages

Thu May 22 11:35:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Fix misleading comment about numactl

Thu May 22 11:31:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Quote all args to macros

Thu May 22 11:24:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Support for NUMA info in the QEMU driver
	* configure.in: check for libnuma
	* libvirt.spec.in: add requirement on libnuma-devel at build
	* src/Makefile.am: add NUMA compiler / linker flags
	* src/qemu_conf.c: populate capabilities data with NUMA topology
	* src/qemu_driver.c: implement free memory APIs

Thu May 22 11:15:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Support the free memory API calls in the remote driver/daemon
	* qemud/Makefile.am: Remove tabs from generated RPC header
	* qemud/qemud/remote_generate_stubs.pl: Remove tabs from
	generated C file
	* qemud/remote_dispatch_*.h: Re-generated with for RPC calls
	* qemud/remote_protocol.x: Added NUMA free memory apis
	* qemud/remote_protocol.{c,h}: Re-generated with new RPC calls
	* qemud/remote.c: Implement dispatcher for free memory APIs
	* src/remote_internal.c: Implement functions for free
	memory APIs

Thu May 22 11:06:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix misc memory leaks
	* qemud/remote.c: Fix memory leaks in stats/migration APIs
	* src/libvirt.c: Fix use of uninitialized memory & memory
	leak in default auth helper
	* src/qparams.c: Fix memory leak, and convert to use new
	style memory allocation APIs

Thu May 22 16:56:12 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/formatdomain.html docs/formatdomain.html.in: Anton Protopopov
	  pointed out a few "copy-paste" errors

Wed May 21 17:13:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Fix exit status check when using -help arg

Wed May 21 16:24:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Fix up misc memory leaks / incorrect docs (Cole Robinson)
	* qemud/remote.c: Free the virDomainPtr object in the
	virDomainDestroy handler to avoid leak
	* src/hash.c: Added more ref count debug
	* src/libvirt.c: Clarified docs on virXXXDestroy to
	match reality
	* src/remote_internal.c: Free virDomain/Network objects
	after dispatching RPC error
	* src/virsh.c: Added some more virDomainFree calls

Wed May 21 15:42:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: Don't free the underlying virDomainPtr
	object after the virDomainDestroy call. Same for virNetworkPtr
	From Cole Robinson.

Wed May 21 15:42:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Run qemu with -help and don't pollute
	libvirtd environment

Tue May 20 12:15:29 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Re-factor daemon startup code to avoid
	initializing the drivers if the pidfile is already claimed
	by another daemon instance. Always claim pidfile when running
	as root, even in non-daemon mode

Tue May 20 17:53:29 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/remote.html docs/remote.html.in: patch from Kenneth Nagin
	  with Notes on the use of listen_tls/listen_tcp

Fri May 16 18:53:12 CEST 2008 Jim Meyering <meyering@redhat.com>

	plug two leaks
	* src/qemu_conf.c (qemudParseXML): Free "obj" unconditionally.

Fri May 16 12:50:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Make QEMU test cases independant of QEMU capabilities on
	the host OS.
	* src/qemu_conf.c, src/qemu_driver.c: Move stat() check on
	qemu binary out of qemudBuildCommandLine() and into caller.
	* tests/Makefile.am: Add testutilsqemu.{c,h} to qemu tests
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: use
	stable capability set in tests, independant of host OS.
	* tests/testutilsqemu.c, tests/testutilsqemu.h: Define a
	stable capability set for test suites

Fri May 16 11:29:30 CEST 2008 Jim Meyering <meyering@redhat.com>

	* src/xml.c: Include "c-ctype.h".

	start using c-ctype functions
	Up to now, we've been avoiding ctype functions like isspace, isdigit,
	etc.  because they are locale-dependent.  Now that we have the c-ctype
	functions, we can start using *them*, to make the code more readable
	with changes like these:

	-        /* This may not work on EBCDIC. */
	-        if ((*p >= 'a' && *p <= 'z') ||
	-            (*p >= 'A' && *p <= 'Z') ||
	-            (*p >= '0' && *p <= '9'))
	+        if (c_isalnum(*p))

	-    while ((*cur >= '0') && (*cur <= '9')) {
	+    while (c_isdigit(*cur)) {

	Also, some macros in conf.c used names that conflicted with
	standard meaning of "BLANK" and "SPACE", so I've adjusted them
	to be in line with the definition of e.g., isblank.
	In addition, I've wrapped those statement macros with do {...} while (0),
	so that we can't forget the ";" after a use.  There was one like that
	already (fixed below).  The missing semicolon would mess up automatic
	indenting.
	* src/buf.c (virBufferURIEncodeString):
	* src/conf.c (IS_EOL, SKIP_BLANKS_AND_EOL, SKIP_BLANKS)
	(virConfParseLong, virConfParseValue, virConfParseName)
	(virConfParseSeparator, virConfParseStatement, IS_BLANK, IS_CHAR)
	(IS_DIGIT, IS_SPACE, SKIP_SPACES):
	* src/nodeinfo.c:
	* src/qemu_conf.c (qemudParseInterfaceXML):
	* src/qemu_driver.c (qemudDomainBlockStats):
	* src/sexpr.c:
	* src/stats_linux.c:
	* src/util.c (virParseNumber, virDiskNameToIndex):
	* src/uuid.c (hextobin, virUUIDParse):
	* src/virsh.c:
	* src/xml.c (parseCpuNumber, virParseCpuSet):

	avoid a double-free bug
	* src/qemu_conf.c (qemudParseXML): Ensure that "obj" is either
	NULL or a valid malloc'd pointer before we might "goto error"
	where it is freed.

Thu May 15 16:06:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Remove use of strcmp()

Thu May 15 12:21:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Fix default disk bus selection logic

Thu May 15 12:16:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Support xenner bootloader capability
	* src/qemu_conf.c, src/qemu_conf.h: Add support for specifying a
	bootloader for paravirt xen guests
	* tests/qemuxml2argv-bootloader.{args,xml}: Test case data
	files for xen bootloader
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Add
	test case for xen bootloader

Thu May 15 12:11:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h: Pass the -name flag to QEMU
	if available.
	* tests/qemuxml2argvdata/qemuxml2argv-minimal.args,
	tests/qemuxml2argvtest.c: Test for launching with -name flag

Thu May 15 12:08:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Support paravirt framebuffer input configuration for xenner guests
	* src/qemu_driver.c, src/qemu_conf.c, src/qemu_conf.h: Add support
	 for 'xen' input device type for Xenner PVFB
	* tests/qemuxml2argv-input-xen.{args,xml}: Test case data
	files for xen input devices
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Add
	test case for xen input devices

Thu May 15 11:57:08 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Support paravirt disk configuration for xenner guests
	* src/qemu_conf.c, src/qemu_conf.h: Add support for 'xen' disk
	bus and 'xvd' disk device names for Xenner
	* src/util.c: Support parsing 'xvd' disk names
	* tests/qemuxml2argv-disk-xenvbd.{args,xml}: Test case data
	files for xvd disks.
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Add
	test case for xvd disk / xen bus type

Thu May 15 09:12:08 CEST 2008 Jim Meyering <meyering@redhat.com>

	Avoid using STREQLEN with a literal; use STRPREFIX instead
	Likewise for STRNEQLEN -> !STRPREFIX.
	* src/nodeinfo.c (linuxNodeInfoCPUPopulate):
	* src/qemu_conf.c (qemudNetworkIfaceConnect):
	(qemudParseInterfaceXML):
	* src/qemu_driver.c (qemudDomainBlockStats):
	* src/remote_internal.c (call):
	* src/stats_linux.c (xenLinuxDomainDeviceID):
	* src/xend_internal.c (xend_parse_sexp_desc):
	(xend_get, sexpr_to_xend_topology):
	* src/xm_internal.c (xenXMConfigCacheRefresh)
	(xenXMDomainFormatXML):

	* Makefile.maint (sc_prohibit_strcmp): Also prohibit strncmp.

Thu May 15 15:07:49 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	* qemud/libvirtd.init.in: change libvirtd description
	which supports various guest not only Qemu
	* docs/*: typo fixes
	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	qemud/event.c, qemud/qemud.c, qemud/remote.c,
	src/event.c, src/proxy_internal.c: typo fixes in comment

Wed May 14 23:17:55 CEST 2008 Jim Meyering <meyering@redhat.com>

	exempt gnulib/ from "make syntax-check" strcmp prohibition
	* .x-sc_prohibit_strcmp: New file.
	* Makefile.am (EXTRA_DIST): Add .x-sc_prohibit_strcmp.

Wed May 14 15:34:43 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Add 'listen_addr' config param to control
	the IP address the daemon listens on (Stefan de Konink)
	* qemud/libvirtd.conf: Added example listen_addr config param
	* src/remote_internal.h: #define constant for default IP addr

Wed May 14 15:34:43 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* proxy/libvirt_proxy.c, src/conf.c, src/hash.c,
	src/iptables.c, src/libvirt.c, src/openvz_conf.c,
	src/qemu_conf.c, src/remote_internal.c, src/sexpr.c,
	src/test.c, src/util.c, src/virsh.c, src/xen_unified.c,
	src/xend_internal.c, src/xm_internal.c, src/xml.c,
	src/xmlrpc.c, tests/virshtest.c, tests/xml2sexprtest.c,
	tests/xmlrpctest.c: Replace all use of strcmp, strncmp,
	etc with STREQ/STREQLEN/STRPREFIX macros.
	* Makefile.cfg: Enable strcmp syntax check
	* .x-sc_prohibit_strcmp: Blacklist gnulib module

Tue May 13 10:55:43 CEST 2008 Jim Meyering <meyering@redhat.com>

	avoid "not a string literal..." warnings
	* src/qemu_conf.c (qemudParseInterfaceXML): Add "%s".
	(qemudBuildCommandLine, qemudGenerateXML): Likewise.

Mon May 12 23:32:21 PST 2008 David L. Leskovec <dlesko@linux.vnet.ibm.com>

	* qemud/qemud.c: get siginfo with signals, distribute to drivers that
	registers a handler
	* src/driver.h: add sighandler function to state driver table
	* src/internal.h: define virStateSigDispatcher functions
	* src/libvirt.c: add __virStateSigDispatcher function
	* src/libvirt_sym.version: add __virStateSigDispatcher
	* src/lxc_driver.c: add sig handler function, cleanup vm when sigchld
	received from container process
	* src/qemu_driver.c: NULL for sig handler (no handler) in state driver
	* src/remote_internal.c: NULL for sig handler (no handler) in state driver
	* src/storage_driver.c: NULL for sig handler (no handler) in state driver

Thu May  9 12:40:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* bootstrap: Added verify module
	* gnulib/lib/.cvsignore, gnulib/lib/Makefile.am: New verify module
	* gnulib/lib/c-ctype.c, gnulib/lib/c-ctype.h: Refreshed
	* gnulib/lib/verify.h: Refreshed upstream
	* gnulib/m4/gnulib-cache.m4, gnulib/m4/gnulib-comp.m4,
	  gnulib/tests/Makefile.am: Refreshed with upstream
	* gnulib/tests/verify.h: Removed
	* src/qemu_conf.c, src/qemu_conf.h: Support -drive syntax and
	support virtio, and add bus attribute
	* src/util.c, src/util.h: helper for drive name to index convertor
	* tests/qemuxml2argvtest.c: Added virtio test
	* tests/qemuxml2argvdata/*.xml: Updated with bus attribute

Fri May  9 15:45:39 CEST 2008 Jim Meyering <meyering@redhat.com>

	Add new files from gnulib.
	* gnulib/lib/c-ctype.c: New file.
	* gnulib/lib/c-ctype.h: Likewise.
	* gnulib/tests/test-c-ctype.c: Likewise.
	* gnulib/tests/test-vc-list-files-git.sh: Likewise.
	* gnulib/tests/test-vc-list-files-cvs.sh: Likewise.

	Use gnulib's c-ctype.h, not <ctype.h>.
	# Convert uses of isspace to c_isspace, isdigit to c_isdigit, etc.
	re=$(man isspace|grep is.....,.is|sed 's/ -.*//' \
	  |tr -s ', \n' \||sed 's/^|//;s/|$//')
	git grep -l -E "$re"|grep -Ev 'Chan|gnulib' \
	  |xargs perl -pi -e 's/\b('"$re"')\b/c_$1/g'
	# Remove all uses of to_uchar
	git grep -l to_uchar|xargs perl -pi -e 's/to_uchar\((.*?)\)/$1/g'
	* src/util.h (to_uchar): Remove definition.
	(TOLOWER): Remove definition.
	(__virMacAddrCompare): Use c_tolower, not TOLOWER.
	Globally:
	  Where needed, change <ctype.h> to <c-ctype.h>.
	  Remove unnecessary inclusion of <ctype.h>.
	Ensure the global changes are never needed again:
	* Makefile.maint (sc_avoid_ctype_macros): Prohibit use of ctype
	macros.   Recommend c-ctype.h instead.
	(sc_prohibit_c_ctype_without_use): New rule.
	(sc_prohibit_ctype_h): New rule.  Disallow use of <ctype.h>.

	Prepare to use gnulib's c-type module.
	* bootstrap: Move module list into separate variable w/less syntax.
	(modules): Add c-ctype.
	Update the following from gnulib:
	* build-aux/useless-if-before-free:
	* build-aux/vc-list-files:
	* gnulib/lib/Makefile.am:
	* gnulib/lib/getaddrinfo.h:
	* gnulib/m4/gnulib-cache.m4:
	* gnulib/m4/gnulib-comp.m4:
	* gnulib/m4/inet_ntop.m4:
	* gnulib/tests/Makefile.am:
	* gnulib/tests/test-getaddrinfo.c:

Fri May  9 10:10:28 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_unified.c src/xend_internal.c src/xend_internal.h: patch
	  from Cole Robinson implementing autostart for running Xen domains

Fri May  9 10:01:34 EST 2008 Jim Meyering <meyering@redhat.com>

	sytnax-check: add a check for risky ctype macro use
	* Makefile.maint (sc_risky_ctype_macros): New rule.

	avoid one more ctype vs. sign-extension problem
	* src/util.c (TOLOWER): Also convert tolower argument.

	add "const" and "static" attributes to file-scoped globals
	* src/storage_backend_fs.c (fileTypeInfo): Add "static" and two
	"const" attributes.
	(FileTypeInfo): Name the previously anonymous struct,
	so the declaration of fileTypeInfo looks more conventional.
	* src/xend_internal.c (sound_models): Mark as static, and
	as an array of "const" entries.
	These were relatively new additions to the list from here:
	nm src/*.o|grep ' D '

Thu May  9 00:07:34 PST 2008 David L. Leskovec <dlesko@linux.vnet.ibm.com>

	* src/lxc_driver.c: use epoll in tty process to avoid consuming the
	cpu when the slave side disconnects

Thu May  8 10:36:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* HACKING: Added notes on string/memory/buffer internal APIs

Thu May  8 10:36:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c, src/xend_internal.c: Added 'bus' attribute
	to disk target.
	* tests/sexpr2xmldata/*.xml, tests/xmconfigdata/*.xml: Update
	to add bus attribute to disks
	* tests/sexpr2xmltest.c: Fix XenD config version for 2 test cases

Thu May  8 10:19:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/page.xsl: Fix detection of sub-headings
	* docs/domain.html, docs/domain.html.in: Re-write content to
	reflect current domain XML format

Thu May  8 07:51:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/auth.html.in, src/auth.html: Fix policykit config docs
	(Cole Robinson)

Wed May  7 14:49:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c, src/xml.c: Disable certain sound functions
	when built into proxy

Wed May  7 18:12:11 CEST 2008 Daniel Veillard <veillard@redhat.com>

	*  src/qemu_conf.c src/qemu_conf.h src/qemu_driver.c: another patch
	   from Cole Robinson adding SetVcpus and DomainGetMaxVcpus for QEmu

Wed May  7 16:42:59 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* tests/qemuxml2argvdata/qemuxml2argv-sound.args
	  tests/qemuxml2argvdata/qemuxml2argv-sound.xml
	  tests/sexpr2xmldata/sexpr2xml-fv-sound-all.sexpr
	  tests/sexpr2xmldata/sexpr2xml-fv-sound-all.xml
	  tests/sexpr2xmldata/sexpr2xml-fv-sound.sexpr
	  tests/sexpr2xmldata/sexpr2xml-fv-sound.xml
	  tests/xmconfigdata/test-fullvirt-sound.cfg
	  tests/xmconfigdata/test-fullvirt-sound.xml
	  tests/xml2sexprdata/xml2sexpr-fv-sound.sexpr
	  tests/xml2sexprdata/xml2sexpr-fv-sound.xml: other regression
	  tests from previous commit

Wed May  7 16:02:07 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c src/qemu_conf.h src/xend_internal.c
	  src/xend_internal.h src/xm_internal.c src/xml.c src/xml.h:
	  Patch from Cole Robinson adding sound support for QEmu and Xen
	* tests/qemuxml2argvtest.c tests/sexpr2xmltest.c
	  tests/xmconfigtest.c tests/xml2sexprtest.c:
	  Associated regression tests

Mon May  6 17:43:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/memory.c: Add missing stddefs.h for ptrdiff_t type

Tue May  6 23:20:12 EST 2008 Jim Meyering <meyering@redhat.com>

	* build-aux/vc-list-files: Add support for bzr.
	Patch by Soren Hansen.

Mon May  5 15:57:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Check in /usr/sbin for iptables too, for SUSE
	distros (Jim Fehlig)

Thu May  1 14:10:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Cope with NULL from qparam_get_query
	by removing unncessary check. (Dave Leskovec)

Tue Apr 29 12:32:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Remove compatability macros AC_CHECK_*_ONCE for
	now part of onceonly.m4 in gnulib/m4/

Wed Apr 29 18:10:00 CEST 2008 Jim Meyering <meyering@redhat.com>

	update from gnulib, again
	* gnulib/m4/onceonly.m4: New file.
	* gnulib/m4/printf.m4: New file.
	* build-aux/useless-if-before-free: Update.
	* build-aux/vc-list-files: Update.
	* gnulib/lib/arpa_inet.in.h: Update.
	* gnulib/lib/stdio-impl.h: Update.
	* gnulib/m4/inet_ntop.m4: Update.

Tue Apr 29 11:54:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Add compatability macros AC_CHECK_*_ONCE for
	older autoconf (RHEL-5 vintage)

Tue Apr 29 08:13:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h, src/xend_internal.c,
	src/xm_internal.c, src/xml.c: Added support for network
	interface model type setting
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c,
	tests/sexpr2xmltest.c, tests/xmconfigtest.c,
	tests/xml2sexprtest.c: Added test cases for NIC model type
	* tests/qemuxml2argvdata/qemuxml2argv-net-virtio.{xml,args},
	tests/sexpr2xmldata/sexpr2xml-net-e1000.{sexpr,xml},
	tests/xml2sexprdata/xml2sexpr-net-e1000.{sexpr,xml},
	tests/xmconfigdata/test-paravirt-net-e1000.{cfg,xml}: Added
	new data files for test cases

Tue Apr 29 21:43:28 CEST 2008 Jim Meyering <meyering@redhat.com>

	Fix build errors.
	* proxy/Makefile.am (libvirt_proxy_LDADD): Add ../gnulib/lib/libgnu.la.
	* gnulib/lib/arpa_inet.in.h: Add new file from gnulib.
	* gnulib/tests/test-EOVERFLOW.c: Likewise.
	* gnulib/lib/stdio-impl.h: Likewise.

	update from gnulib
	* gnulib/lib/inet_ntop.h: Remove file.
	* gnulib/m4/onceonly_2_57.m4: Remove file.
	* build-aux/useless-if-before-free: Update.
	* build-aux/vc-list-files: Update.
	* gnulib/lib/.cvsignore: Update.
	* gnulib/lib/Makefile.am: Update.
	* gnulib/lib/fseeko.c: Update.
	* gnulib/lib/getaddrinfo.c: Update.
	* gnulib/lib/getdelim.c: Update.
	* gnulib/lib/inet_ntop.c: Update.
	* gnulib/lib/inet_ntop.h: Update.
	* gnulib/lib/poll.c: Update.
	* gnulib/lib/snprintf.c: Update.
	* gnulib/lib/stdlib.in.h: Update.
	* gnulib/lib/string.in.h: Update.
	* gnulib/lib/sys_socket.in.h: Update.
	* gnulib/lib/sys_stat.in.h: Update.
	* gnulib/lib/vasnprintf.c: Update.
	* gnulib/lib/vasprintf.c: Update.
	* gnulib/lib/wchar.in.h: Update.
	* gnulib/m4/arpa_inet_h.m4: Update.
	* gnulib/m4/extensions.m4: Update.
	* gnulib/m4/gnulib-common.m4: Update.
	* gnulib/m4/gnulib-comp.m4: Update.
	* gnulib/m4/include_next.m4: Update.
	* gnulib/m4/inet_ntop.m4: Update.
	* gnulib/m4/netinet_in_h.m4: Update.
	* gnulib/m4/onceonly_2_57.m4: Update.
	* gnulib/m4/physmem.m4: Update.
	* gnulib/m4/snprintf.m4: Update.
	* gnulib/m4/stdint.m4: Update.
	* gnulib/m4/stdio_h.m4: Update.
	* gnulib/m4/stdlib_h.m4: Update.
	* gnulib/m4/string_h.m4: Update.
	* gnulib/m4/strndup.m4: Update.
	* gnulib/m4/sys_select_h.m4: Update.
	* gnulib/m4/sys_socket_h.m4: Update.
	* gnulib/m4/sys_stat_h.m4: Update.
	* gnulib/m4/vasnprintf.m4: Update.
	* gnulib/tests/Makefile.am: Update.
	* gnulib/tests/test-fseeko.c: Update.
	* gnulib/tests/test-getaddrinfo.c: Update.
	* gnulib/tests/test-getdelim.c: Update.
	* gnulib/tests/test-getline.c: Update.
	* gnulib/tests/test-lseek.c: Update.
	* gnulib/tests/test-snprintf.c: Update.
	* gnulib/tests/test-sys_stat.c: Update.
	* gnulib/tests/test-vasnprintf.c: Update.
	* gnulib/tests/test-vasprintf.c: Update.

	remove useless tests before xmlFree
	* src/qemu_conf.c (qemudParseDiskXML, qemudParseInterfaceXML):
	(qemudParseInputXML, qemudParseDhcpRangesXML):
	* src/remote_internal.c (doRemoteOpen):
	* src/storage_conf.c (virStoragePoolDefParseDoc):
	* src/xm_internal.c (xenXMParseXMLDisk, xenXMParseXMLVif):
	(xenXMParseXMLToConfig, xenXMAttachInterface):
	* src/xml.c (virDomainParseXMLDiskDesc, virDomainParseXMLIfDesc):
	(virDomainXMLDevID):

Tue Apr 29 11:36:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/Makefile.am: Explicitly tell gcov to look in .libs for
	coverage data files

Tue Apr 29 10:10:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c: Fix array out of bounds access in parsing
	capabilities data from Xen

Tue Apr 29 10:06:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/formatnetwork.html, docs/formatnetwork.html.in: Added
	docs on XML format for networks

Tue Apr 29 09:46:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/hash.c: remove bogus test code accidentally added in
	previous commit

Tue Apr 29 15:20:12 CEST 2008 Jim Meyering <meyering@redhat.com>

	also check for useless test-before-xmlFree
	* Makefile.cfg (useless_free_options): Add --name=xmlFree.

	Recognize more uses of strcmp.
	* Makefile.maint (sc_prohibit_strcmp): Relax regexp.

	Avoid "make syntax-check" failures.
	* src/memory.c: Include "config.h".
	Remove trailing blanks.

	Avoid in-function #if directives.
	* src/parthelper.c [!PED_PARTITION_PROTECTED]: Define to 0.
	Remove in-function #ifdefs.

Tue Apr 29 09:15:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/parthelper.c: Don't fail if PED_PARTITION_PROTECTED
	  is not defined because of ancient libparted
	  (Soren Hansen).

Mon Apr 28 17:24:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/memory.h, src/memory.c: Added safer APIs for dealing
	with low level memory allocation.
	* src/hash.c, src/capabilities.c: Convert to new memory
	allocation APIs
	* src/internal.h: Define ATTRIBUTE_RETURN_CHECK and fix
	type in virDebug no-op impl
	* proxy/Makefile.am: Build and link against memory.c

Mon Apr 28 10:24:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/buf.c, src/buf.h: Change API to move errors checks to
	a single place
	* src/capabilities.c, src/conf.c, src/lxc_conf.c, src/qemu_conf.c,
	src/qparams.c, src/storage_conf.c, src/test.c, src/virsh.c,
	src/xend_internal.c, src/xm_internal.c, src/xml.c, src/xmlrpc.c,
	src/xmlrpc.h, tests/xmlrpctest.c: Update to conform with new
	virBuffer API
	* src/libvirt_sym.version: Add new virBuffer APIs for virsh

Mon Apr 28 16:11:22 CEST 2008 Jim Meyering <meyering@redhat.com>

	fix typo in bootstrap script
	* bootstrap: Fix typo: s/gnulib/.gnulib/.  Reported by
	Daniel P. Berrange.

Mon Apr 28 09:32:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/.valgrind.supp, tests/Makefile.am: Ignore bash bugs when
	running valgrind

Mon Apr 28 11:08:58 CEST 2008 Jim Meyering <meyering@redhat.com>

	avoid format-related warnings
	* qemud/qemud.c (main): Fix a bogus format string reported as unmarked.
	* src/virsh.c (cmdVcpupin): Non-literal with no args.

Mon Apr 28 10:26:17 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/Makefile.am docs/et.png docs/libvirt.css docs/page.xsl
	  docs/*.html docs/html/*.html: removed footer, added sponsor logo
	  regenerated the html pages also fixed 'make distcheck' as
	  pointed by Jim.

Sat Apr 26 10:21:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c, src/xml.c, src/xml.h, src/xend_internal.c,
	src/xend_internal.h: Added support for serial and parallel
	devices
	* tests/sexpr2xmltest.c, tests/xml2sexprtest.c, tests/xmconfigtest.c:
	added tests for serial and parallel devices
	* tests/sexpr2xmldata/*, tests/xml2sexprdata/*, tests/xmconfigdata/*:
	updated for new test cases

Fri Apr 25 16:45:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/internal.c: Convenience macros for fixed arrays
	* src/qemu_driver.c: Extract TTY paths for serial and parallel
	devices too
	* src/qemu_conf.c, src/qemu_conf.h: Support arbitrary serial
	and parallel devices.
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Add tests
	for serial and parallel devices
	* tests/qemuxml2argvdata/*: Updated and added data files for
	new test cases

Fri Apr 25 12:21:28 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/page.xsl, docs/libvir.css: Re-arrange layout to workaround
	IE6 bugs
	* docs/site.xsl, docs/newapi.xsl, docs/ChangeLog.xsl: Switch to
	HTML strict to avoid layout bugs in transitional mode
	* docs/*.html: Re-generate files with new layout

Fri Apr 25 17:44:28 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c: applied patch from Anton Protopopov to change
	  group ownership of /var/run/libvirt/ to unix_sock_gid.

Fri Apr 25 16:51:58 CEST 2008 Jim Meyering <meyering@redhat.com>

	avoid problems with sign-extended "char" operand to is* functions
	* src/util.h (to_uchar): Define function.
	* src/sexpr.c (_string2sexpr): Apply to_uchar to is* operand.
	* src/nodeinfo.c (linuxNodeInfoCPUPopulate): Likewise.
	* src/qemu_driver.c (qemudExtractMonitorPath): Likewise.
	* src/stats_linux.c (xenLinuxDomainDeviceID): Likewise.
	* src/util.c (TOLOWER, __virMacAddrCompare, virParseMacAddr): Likewise.
	* src/virsh.c (cmdVcpupin, vshCommandGetToken): Likewise.

Thu Apr 24 17:18:18 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/page.xsl docs/redhat.gif docs/*.html: using the shadowman
	  logo to indicate Red Hat sponsoring, regenerated.

Thu Apr 24 14:34:37 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* AUTHORS: update, list people with commit access

Thu Apr 24 11:42:53 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* libvirt.css search.php: fix the search box and PHP output

Thu Apr 24 18:00:21 JST 2008 Atsushi SAKAI <sakaia@jp.fujitsu.com>

	* proxy/libvirt_proxy.c docs/*: fixing typos

Thu Apr 24 09:54:19 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* AUTHORS: indicate that the Logo is by Diana Fong
	* docs/index.py: modify to also index subprojects pages

Wed Apr 23 15:38:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/Makefile.am, docs/news.xsl: Fix generation of NEWS file

Wed Apr 23 13:43:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/page.xsl: Fix link to wiki when href_base is set
	* docs/html/*.html: Regnerate to fix wiki link

Wed Apr 23 12:18:11 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvir.html, docs/*.html.in: Removed merged HTML docs
	and replaced with one file per page
	* docs/*.html: Re-generated with new page layout
	* docs/page.xsl: New master page template and navigation
	* docs/site.xsl, docs/newapi.xsl, docs/ChangeLog.xsl: Updated
	to use new page.xsl templates
	* libvirt-net-*.{fig,png}: Added diagrams illustrating some
	ways of using virtual networking
	* docs/*.css: New styles for site
	* docs/html/*: Re-generated for new page layout & removed
	unused files

2008-04-21  Jim Meyering  <meyering@redhat.com>

	Enable 'make syntax-check's sc_changelog rule.
	* Makefile.maint (sc_changelog): Adapt to work with legacy
	ChangeLog entry header lines.
	* Makefile.cfg (local-checks-to-skip): Remove sc_changelog.

Fri Apr 18 14:30:12 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	Work around Python.h name-space pollution.
	* python/types.c (HAVE_PTHREAD_H): #undef.
	Without this, we'd get a redefinition warning.

Fri Apr 18 20:07:12 CEST 2008 Jim Meyering <meyering@redhat.com>

	Work around Python.h name-space pollution.
	* python/libvir.c (HAVE_PTHREAD_H): #undef.
	Without this, we'd get a redefinition warning.

Fri Apr 18 11:26:24 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am: Add abs_srcdir and abs_builddir to test
	environment
	* tests/test_conf.sh: Refactor to pretty print
	* tests/statstest.c, tests/xencapstest.c, tests/xmconfigtest.c:
	Use new virtTestDifference for display. Autoset abs_srcdir if
	not in environment. Refactor common code into macros

Fri Apr 18 11:04:24 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* tests/testutils.h, tests/testutils.c: Add virtTestDifference
	for printing out trimmed string differences

Fri Apr 18 11:24:24 CEST 2008 Jim Meyering <meyering@redhat.com>

	avoid compile error when <pthread.h> is absent
	* src/internal.h (HAVE_PTHREAD_H): Test with "#ifdef", not "#if".

Fri Apr 18 09:27:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Fixes for MinGW.
	* configure.in: Fix pkg-config detection of libxml2,
	  add -lgcrypt to gnutls lib.
	* src/Makefile.am: If compiling --without-libvirtd then
	  don't compile any part of the storage driver.
	* configure.in, src/hash.c, src/internal.h: Detect availability
	  of pthread library and compile out mutex code if not available.
	* src/storage_driver.c, src/util.c: Ignore some missing
	  headers on MinGW.

Tue Apr 15 17:19:16 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* virsh.1 docs/virsh.pod: fix missing entries and small cleanups
	  in the man page, should fix #442429

Mon Apr 14 13:44:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* po/POTFILES.in: Added src/lxc_container.c entry

Thu Apr 10 18:33:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Remove unused uid field in virsh control structure.
	* src/virsh.c: Remove unused uid field in virsh control structure.

Thu Apr 10 18:54:03 CEST 2008 Jim Meyering <meyering@redhat.com>

	HACKING: New file: begin to describe contributor/coding guidelines

	ensure that no C source file uses TABs for indentation
	* Makefile.maint (sc_TAB_in_indentation): New rule.

	Convert TAB-based indentation in C sources to use only spaces.
	Done using this command (also includes .c.in and .h.in files):
	for i in $(g ls-files|grep -E '\.[ch](\.in)?$'|grep -v gnulib); do
	  expand -i $i > j && mv j $i;done

	Remove Vim and Emacs variable settings from C source files.
	Done with these commands:
	git grep -l Local.variab|xargs \
	  perl -0x3b -pi -e 's,\n+/\*\n \* vim:(.|\n)*,\n,'
	git grep -l Local.variab|xargs \
	  perl -0x3b -pi -e 's,\n+/\*\n \* Local variables:\n(.|\n)*,\n,'

Thu Apr 10 15:28:36 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* AUTHORS: adding Dave Leskovec and Ryan Scott to the authors list
	* po/*: rebuilt

Thu Apr 10 15:24:40 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied a patch from Ryan Scott to ask
	  xend to save the change in the config file

Thu Apr 10 09:28:31 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/lxc_conf.c src/lxc_conf.h src/lxc_container.c
	  src/lxc_container.h src/lxc_driver.c: Applied second set of
	  linux container patches from Dave Leskovec adding start/stop
	  of domains

Wed Apr  9 16:08:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Add virsh.pod to EXTRA_DIST
	* docs/Makefile.am: Add virsh.pod to EXTRA_DIST.

Wed Apr  9 15:00:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Core code contains Xen-ism UUID of dom0 = 0..0
	* src/libvirt.c: Remove a Xen-ism from the core code, the
	  assumption that dom0's UUID is all zeroes.

Wed Apr  9 14:56:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Warn about conn, dom and net fields in virterror
	* include/libvirt/virterror.h: Warn about the use of
	  conn, dom and net fields in virterror.

Wed Apr  9 14:46:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Remove extraneous underscore
	* src/openvz_conf.c: Remove extraneous underscore which stopped
	  file from compiling (Anton Protopopov).

Tue Apr  8 18:44:27 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in NEWS doc/* po/*: making libvirt-0.4.2 release

Mon Apr  8 17:32:07 CET 2008 Jim Meyering <meyering@redhat.com>

	* configure.in (ALL_LINGUAS): Fix typo: s/Latn/latin/.

	Don't fail to read a file because it's non-seekable (e.g., a pipe).
	* src/util.c (fread_file_lim): New function.
	(__virFileReadAll): Use fread_file_lim, rather than requiring
	that stat.st_size provide a usable file size.
	* tests/read-non-seekable: New test, for the above.
	* tests/Makefile.am (test_scripts): Add read-non-seekable.
	* tests/test-lib.sh (mkfifo_or_skip_): New helper function.

Tue Apr  8 13:24:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/qemu_driver.c: Handle errors from fork(2) and pipe(2)
	  system calls when creating qemu subprocess.

Tue Apr  8 11:50:42 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* po/sr.po po/sr@Latn.po po/sr@latin.po: fix/update serbian
	  translations.

Tue Apr  8 11:24:28 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/test.c: patch from Cole Robinson adding xen and hvm guest types
	  to the test driver's capabilities.

Tue Apr  8 10:19:01 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: fix an infinite loop bug

Mon Apr  7 14:36:56 CET 2008 Jim Meyering <meyering@redhat.com>

	* tests/vcpupin: Add a test for the 2008-04-04 virsh.c bugfix.

Mon Apr  7 12:53:01 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs/bugs.html docs/libvir.html: update the page bugzilla URIs
	  depending on the set the user is running.

Fri Apr  4 11:00:08 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Don't run polkit-auth if running as root
	* qemud/qemud.c, qemud/remote.c, qemud/internal.h: Don't
	ask client for polkit auth if they are running as root

Fri Apr  4 13:19:08 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Shigeki Sakamoto adding message on vcpupin

Fri Apr  4 10:04:23 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs//* po/*: regenerated the documentation and reextracted the
	  full set of localization strings to push to the translation team.

Fri Apr  4 09:56:42 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* docs//* src/conf.c src/hash.c src/libvirt.c src/proxy_internal.c
	 src/remote_internal.c src/virsh.c src/xen_internal.c
	 src/xend_internal.c src/xml.c: applied patch from Atsushi SAKAI
	 fixing a lot of typos

Fri Apr  4 09:29:08 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/test.c: patch from Cole Robinson to add
	  virNodeGetCellsFreeMemory to the test driver

Wed Apr  2 17:19:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	C99 initializer on __lastErr
	* src/virterror.c: Use C99 initializers to make initialization
	  of __lastErr clearer (Guido Günther).

Tue Apr  1 15:00:03 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/lxc_conf.c: patch from Dave Leskovec fixing an freed memory
	  access I introduced yesterday

Mon Mar 31 16:35:47 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/hash.c src/internal.h src/virterror.c: remove dandling
	  domain/net/conn pointers from error data when released.
	* src/lxc_driver.c: fix a NULL/0 return error mismatch

Mon Mar 31 14:12:42 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in: small patch from Mike Gerdts to avoid problems with
	  older awk implementations, fixes #439649

Mon Mar 31 13:58:25 CEST 2008 Daniel Veillard <veillard@redhat.com>

	* src/lxc_conf.c src/lxc_conf.h: cleanup patch for the conf driver
	  of linux countainers, reuse XPath helpers, make string fields dynamic
	  and remove a memory leak.
	* src/lxc_driver.c: avoid some problems when the config directory is
	  not accessible and for regression tests

Fri Mar 28 16:34:56 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/network.rng: Add new routed networking schema
	* src/iptables.c, src/iptables.h: Add iptablesAddForwardAllowRelatedIn
	and iptablesRemoveForwardAllowRelatedIn
	* src/qemu_conf.h: Add attribute for routed networking
	* src/qemu_conf.c: Parse / format new networking attributes
	* src/qemu_driver.c: Support routed networking config
	  (patches from Mads Chr. Olesen)

Fri Mar 28 13:55:56 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_conf.c: Fix XML output tag for FS storage pools
	directory path

Thu Mar 27 20:59:56 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/iptables.c: Ensure masquering rule only catches traffic
	leaving the virtual network, and not traffic inside it
	(patch from Charles Duffy)

Thu Mar 27 14:36:56 CET 2008 Jim Meyering <meyering@redhat.com>

	lxcError: mark a string and add to the list of nearly-checked functions
	* Makefile.maint (msg_gen_function): Add, but commented-out.
	* src/lxc_conf.c (lxcParseXML): Mark a diagnostic for translation.

	testError: mark most string arguments for translation
	* Makefile.maint (msg_gen_function): Add testError
	* src/test.c (testDomainSave, testDomainRestore): Mark strings.
	(testDomainCoreDump): Likewise.

	openvzLog: mark its string arguments for translation
	* Makefile.maint (msg_gen_function): Add openvzLog.
	* src/openvz_conf.c (openvzAssignVMDef, openvzParseXML): Mark strings.
	* src/openvz_driver.c (openvzDomainShutdown, openvzDomainReboot):
	(openvzDomainDefineXML, openvzDomainCreateLinux):
	(openvzDomainCreate, openvzDomainUndefine): Likewise.

	error: mark most string arguments for translation
	Also mark some arguments to __virRaiseError.
	* Makefile.maint (msg_gen_function): Add error.
	* po/POTFILES.in: Add src/openvz_conf.c and src/openvz_driver.c.
	* src/openvz_conf.c (openvzParseXML, openvzGetVPSInfo): Mark strings.
	* src/openvz_driver.c (openvzDomainLookupByID): Likewise.
	(openvzDomainLookupByUUID, openvzDomainLookupByName): Likewise.
	(openvzDomainGetInfo, openvzDomainShutdown, openvzDomainReboot)
	(openvzDomainCreate, openvzDomainUndefine): Likewise.
	* src/remote_internal.c (check_cert_file): Likewise.
	(negotiate_gnutls_on_connection, verify_certificate): Likewise.
	(remoteAuthenticate, addrToString, remoteAuthSASL): Likewise.
	(remoteAuthPolkit, call, really_read_buf): Likewise.

	Convert diagnostics like "VAR > MAX_VAR" to translatable messages.
	* src/remote_internal.c (errorf): New function.
	(remoteListDomains, remoteDomainPinVcpu, remoteDomainGetVcpus):
	(remoteListDefinedDomains, remoteListNetworks):
	(remoteListDefinedNetworks): Convert strings to be translatable,
	and also to include offending and maximum values.  Use errorf.

	qemudReportError: mark for translation string args to this function
	* Makefile.maint (msg_gen_function): Add qemudReportError.
	* src/qemu_conf.c (qemudLoadDriverConfig)
	(qemudExtractVersion, qemudParseDiskXML, qemudParseInterfaceXML)
	(qemudParseInputXML, qemudParseXML, qemudNetworkIfaceConnect)
	(qemudBuildCommandLine, qemudSaveConfig, qemudParseVMDeviceDef)
	(qemudAssignVMDef, qemudSaveVMDef, qemudSaveNetworkConfig)
	(qemudParseDhcpRangesXML, qemudParseNetworkXML)
	(qemudAssignNetworkDef, qemudSaveNetworkDef, qemudGenerateXML)
	(qemudGenerateNetworkXML, qemudDeleteConfig): Mark strings.
	* src/qemu_driver.c (qemudBuildDnsmasqArgv, qemudAddIptablesRules)
	(qemudGetCapabilities, qemudDomainGetOSType)
	(qemudListDefinedDomains, qemudListNetworks)
	(qemudListDefinedNetworks, qemudNetworkGetBridgeName): Mark strings.

	ReportError: mark for translation string args to this function
	* Makefile.maint (msg_gen_function): Add ReportError.
	* src/util.c (_virExec): Mark strings.

	xenXMError: mark for translation string args to this function
	* Makefile.maint (msg_gen_function): Add xenXMError.
	* src/xm_internal.c (xenXMParseXMLToConfig, xenXMDomainDefineXML):
	(xenXMDomainAttachDevice, xenXMDomainDetachDevice): Mark strings.

	Mark many more strings for translation.
	* Makefile.maint (err_func_re): Add to the list and make it readable.
	* po/POTFILES.in: Add src/util.c and src/xm_internal.c, and sort.
	* src/storage_backend.c: Fix comment.
	* src/util.c (virFileLinkPointsTo): Mark a string.
	* qemud/remote.c (remoteDispatchClientRequest): Mark strings.
	(remoteDispatchOpen, CHECK_CONN, remoteDispatchGetType): Likewise.
	(remoteDispatchDomainGetSchedulerType): Likewise.
	(remoteDispatchDomainGetSchedulerParameters): Likewise.
	(remoteDispatchDomainSetSchedulerParameters): Likewise.
	(remoteDispatchDomainBlockStats): Likewise.
	(remoteDispatchDomainInterfaceStats): Likewise.
	(remoteDispatchDomainAttachDevice, remoteDispatchDomainCreate):
	(remoteDispatchDomainDestroy, remoteDispatchDomainDetachDevice):
	(remoteDispatchDomainDumpXml, remoteDispatchDomainGetAutostart):
	(remoteDispatchDomainGetInfo, remoteDispatchDomainGetMaxMemory):
	(remoteDispatchDomainGetMaxVcpus, remoteDispatchDomainGetOsType):
	(remoteDispatchDomainGetVcpus): Likewise.
	(remoteDispatchDomainMigratePerform): Likewise.
	(remoteDispatchListDefinedDomains, remoteDispatchDomainPinVcpu):
	(remoteDispatchDomainReboot, remoteDispatchDomainResume):
	(remoteDispatchDomainSave, remoteDispatchDomainCoreDump):
	(remoteDispatchDomainSetAutostart): Likewise.
	(remoteDispatchDomainSetMaxMemory, remoteDispatchDomainSetMemory):
	(remoteDispatchDomainSetVcpus, remoteDispatchDomainShutdown):
	(remoteDispatchDomainSuspend, remoteDispatchDomainUndefine):
	(remoteDispatchListDefinedNetworks, remoteDispatchListDomains):
	(remoteDispatchListNetworks, remoteDispatchNetworkCreate):
	(remoteDispatchNetworkDestroy, remoteDispatchNetworkDumpXml):
	(remoteDispatchNetworkGetAutostart, remoteDispatchNetworkGetBridgeName):
	(remoteDispatchNetworkSetAutostart, remoteDispatchNetworkUndefine):
	(addrToString, remoteDispatchAuthSaslInit, remoteDispatchAuthSaslStart):
	(remoteDispatchAuthSaslStep, remoteDispatchListDefinedStoragePools):
	(remoteDispatchListStoragePools, remoteDispatchStoragePoolCreate):
	(remoteDispatchStoragePoolBuild, remoteDispatchStoragePoolDestroy):
	(remoteDispatchStoragePoolDelete, remoteDispatchStoragePoolRefresh):
	(remoteDispatchStoragePoolGetInfo, remoteDispatchStoragePoolDumpXml):
	(remoteDispatchStoragePoolGetAutostart): Likewise.
	(remoteDispatchStoragePoolSetAutostart):
	(remoteDispatchStoragePoolListVolumes):
	(remoteDispatchStoragePoolNumOfVolumes):
	(remoteDispatchStoragePoolUndefine, remoteDispatchStorageVolCreateXml):
	(remoteDispatchStorageVolDelete, remoteDispatchStorageVolGetInfo):
	(remoteDispatchStorageVolDumpXml, remoteDispatchStorageVolGetPath):
	(remoteDispatchStorageVolLookupByName): Likewise.
	* src/qemu_driver.c (qemudOpenMonitor, qemudStartVMDaemon):
	(dhcpStartDhcpDaemon, qemudStartNetworkDaemon):
	(qemudDomainSuspend, qemudDomainResume, qemudDomainShutdown):
	(qemudDomainGetOSType, qemudDomainSetMaxMemory):
	(qemudDomainSetMemory, qemudDomainGetInfo, qemudDomainSave):
	(qemudDomainRestore, qemudDomainDumpXML, qemudDomainStart):
	(qemudDomainUndefine, qemudDomainChangeCDROM):
	(qemudDomainAttachDevice, qemudDomainGetAutostart):
	(qemudDomainSetAutostart, qemudDomainInterfaceStats):
	(qemudNetworkLookupByUUID, qemudNetworkLookupByName):
	(qemudNetworkUndefine, qemudNetworkStart, qemudNetworkDestroy):
	(qemudNetworkDumpXML, qemudNetworkGetAutostart):
	(qemudNetworkSetAutostart): Likewise.
	* src/virsh.c (cmdVcpupin, cmdAttachDevice, cmdDetachDevice): Likewise.
	* src/xm_internal.c (xenXMConfigCacheRefresh, xenXMDomainPinVcpu):
	Likewise.

Thu Mar 27 10:30:12 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/lxc_conf.c src/lxc_conf.h src/lxc_driver.c src/remote_internal.c:
	  applied patch from Dan Berrange to change the way the lxc driver
	  works, migrating the support in the daemon, it also removes some
	  compilation issues and teh way the configuration files are named.

Thu Mar 27 09:09:34 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/storage_backend_iscsi.c: patch from Chris Lalancette to improve
	  support with older versions of iscsiadm.

Wed Mar 26 14:00:47 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c proxy/libvirt_proxy.c: fix Xen hypercall for
	  Xen-3.2, and merged its debugging with the general library facility

Wed Mar 26 12:57:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	* po/lt.po: Fixed typo (Beth Kon).

Tue Mar 25 10:23:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: Additional error messages for missing
	  parameters (Shigeki Sakamoto).

Mon Mar 24 11:56:58 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: remove trailing newlines from error messages
	  patch from Guido Günther

Mon Mar 24 11:47:47 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: applied patch from Guido Günther to make error
	  strings as translatable

Mon Mar 24 11:16:58 CET 2008 Jim Meyering <meyering@redhat.com>

	* Makefile.maint (err_func_re): Add lxcError.

	* qemud/remote.c: Don't include <getopt.h>. Not used.

	Sync Makefile rules from coreutils.
	* Makefile.maint: Merge.
	* GNUmakefile: Update from coreutils.

	Add new testing framework and the first test to use it.
	* tests/Makefile.am (test_scripts): Add vcpupin.
	(EXTRA_DIST): Add test-lib.sh.
	* tests/test-lib.sh: Testing framework, from coreutils.
	* tests/vcpupin: New file.
	* build-aux/mktempd: New file, from gnulib.
	* bootstrap: Add posix-shell and mktempd to the list of imported modules.
	* gnulib/m4/posix-shell.m4: New file, from gnulib.

	Fix bugs in tests/Makefile.am.
	* tests/Makefile.am (TESTS_ENVIRONMENT): Correct invalid
	settings of abs_top_builddir and abs_top_srcdir.
	Also prepend src/ to PATH, so we test the just-built virsh,
	not whatever happens to be in the original $PATH.

Mon Mar 24 10:20:21 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Saori Fukuta adding the
	  scheduler API for the Xen daemon driver
	* po/POTFILES.in: add the two new linux container modules

Fri Mar 21 15:59:53 CET 2008 Daniel Veillard <veillard@redhat.com>

	* configure.in include/libvirt/virterror.h src/Makefile.am
	  src/driver.h src/lxc_conf.[ch] src/lxc_driver.[ch] src/virterror.c:
	  Applied 3 patches from Dave Leskovec for intial support of
	  Linux containers, configured off by default, work in progress.
	* src/libvirt.c: improve virDomainCreateLinux xmlDesc description

Thu Mar 20 12:23:03 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/util.c src/util.h src/xml.c: applied patch from Hiroyuki Kaguchi
	  fixing Ethernet MAC addresses parsingand separating as an util
	  function, with added comments from Jim Meyering

Wed Mar 19 15:31:34 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c src/qemu_conf.h src/qemu_driver.c: applied patch
	  from Cole Robinson implementing memory operations for qemu driver

Tue Mar 18 23:31:26 CET 2008 Jim Meyering <meyering@redhat.com>

	Avoid "make syntax-check" failure.
	* src/xen_unified.c: Remove trailing blank.

Mon Mar 17 13:24:22 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Add WITH_PROXY to config.h file
	* src/remote_internal.c: Handle local Xen URIs if Xen drivers
	declines them
	* src/xen_unfied.c: Use explicit logic for opening sub-drivers
	rather than a hacked loop.
	* src/xend_internal.c: Don't complain about failing to open
	xend when non-root read-only.

Mon Mar 17 17:55:56 CET 2008 Jim Meyering <meyering@redhat.com>

	Treat ENOTSUP like ENODATA, after failed fgetfilecon.
	* src/storage_backend.c (virStorageBackendUpdateVolInfoFD): Treat a
	failed fgetfilecon with errno == ENOTSUP the same as for ENODATA.

Mon Mar 17 17:40:12 CET 2008 Daniel Veillard <veillard@redhat.com>

	* libvirt.c: fixed DefinedDomains function comments c.f. 437216
	* docs/libvirt-*.xml docs/*/libvirt-libvirt.html: regenerated

Mon Mar 17 11:10:22 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_driver.c: Don't crash if backend is missing the
	startPool operation, and run refreshPool when creating an
	unmanaged pool

Mon Mar 17 11:09:22 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/storage_backend.c: Cope with missing SELinux context
	data by ignoring the error

Mon Mar 17 11:46:09 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c docs/libvirt-*.xml docs/html/libvirt-libvirt.html:
	  fixed a few missing argument descriptions and regenerated.

Mon Mar 17 11:23:32 CET 2008 Daniel Veillard <veillard@redhat.com>

	* NEWS virsh.1 docs//* include/libvirt/libvirt.h[.in] qemud/mdns.h
	  src/libvirt.c src/qemu.conf src/remote_internal.c src/xend_internal.c
	  tests/confdata/libvirtd.conf tests/confdata/libvirtd.out: patch from
	  Atsushi SAKAI fixing a ot more typo

Fri Mar 14 16:38:34 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/bridge.c, src/bridge.h: Don't set MAC address on TAP
	device.
	* src/qemu_conf.c: Pass ifname= param along with TAP file
	handle for Xenner

Fri Mar 14 16:55:34 CET 2008 Daniel Veillard <veillard@redhat.com>

	* po/*: updated translations

Fri Mar 14 16:30:27 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/bridge.c: fix a typo in a comment

Fri Mar 14 16:19:21 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/qemud.c src/virsh.c: fixing some user facing strings
	  problems pointed out by Francesco Tombolini should fix #436620

Fri Mar 14 11:01:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	* virsh.1 docs/apibuild.py docs/architecture.html docs/errors.html
	  docs/format.html docs/index.py docs/libvir.html docs/libvirt-api.xml
	  docs/libvirt.rng docs/news.html docs/python.html docs/virsh.pod
	  docs/devhelp/libvirt-libvirt.html docs/examples/examples.xml
	  docs/examples/index.html docs/examples/info1.c
	  docs/examples/suspend.c docs/html/libvirt-libvirt.html
	  include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  proxy/libvirt_proxy.c python/libvir.py python/libvirt-python-api.xml
	  python/tests/node.py src/xen_internal.c:
	Fix typo "informations" -> "information" (Atsushi SAKAI and
	Saori FUKUTA).

Thu Mar 13 10:24:45 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: virDomainSetSchedulerParameters need to be
	  blocked on read-only connections, patch from Saori Fukuta

Thu Mar 13 10:19:16 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/bridge.c src/virsh.c: typo fixes from Atsushi SAKAI

Thu Mar 13 10:15:58 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c src/qemu_driver.c: patch from Cole Robinson
	  fixing CD Rom change on live QEmu/KVM domains.

Tue Mar 11 10:45:53 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c, configure.in: Remove use of polkit-grant since
	it is fundamentally broken. Only use polkit-auth instead. Keep
	stdin/out/err open when running polkit-auth.

Tue Mar 11 10:21:53 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Don't force connection to readonly as non-root
	since with auth support we can have full connections.

Tue Mar 11 10:17:53 EDT 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Don't run cleanup code when parent process is
	exiting in daemon mode.

Fri Mar  7 12:11:53 CET 2008 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html docs/storage.html: apply documentation fixes
	  and typos cleanup from Atsushi Sakai

Fri Mar  7 10:22:00 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Cole Robinson to not
	  loose the boot tag when defining a fully virtualized xen domain

Tue Mar  4 20:01:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Make iSCSI login actually work
	* src/storage_backend_iscsi.c: Make iSCSI login actually work
	  (Chris Lalancette).

Tue Mar  4 19:57:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Report error when vcpupin is given bad vCPU number.
	* src/virsh.c: Report error when vcpupin is given bad vCPU number
	  (Shigeki Sakamoto).

Mon Mar  3 21:39:17 CET 2008 Jim Meyering <meyering@redhat.com>

	Also ignore leading zeros when comparing MAC addresses.
	* src/util.c: Include <ctype.h>.
	(TOLOWER): Define.
	(__virMacAddrCompare): Rewrite to also ignore leading zeros.

Mon Mar  3 21:17:29 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/capabilities.c: Cole Robinson pointed out a well formedness
	  problem when generating the capabilities in the test driver.

Mon Mar  3 19:09:51 CET 2008 Jim Meyering <meyering@redhat.com>

	Don't use first byte of string as a pointer.
	* src/qemu_conf.c (qemudReportError): Use the pointer, errorMessage,
	not its first byte, errorMessage[0].

	Avoid segfault upon early libvirtd failure.
	* qemud/qemud.c (main): Don't call qemudCleanup on an
	uninitialized pointer.

Mon Mar  3 15:40:31 CET 2008 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in libvirt.spec.in docs/* include/libvirt/libvirt.h
	  po/*: preparing release of libvirt-0.4.1

Mon Mar  3 14:14:03 CET 2008 Jim Meyering <meyering@redhat.com>

	Plug saslUsernameWhitelist leak.
	* qemud/qemud.c (qemudCleanup): Free the array as well as
	the strings in it.

	Plug skipped-qemudCleanup leak.
	* qemud/qemud.c (main): Call qemudCleanup also upon failure.
	Otherwise, an error return would skip it and induce leaks.

	Plug remoteReadConfigFile leak.
	* qemud/qemud.c (remoteReadConfigFile): Be careful to free
	"conf" after a successful virConfReadFile.

	Plug two leaks: host.migrateTrans and arch.name
	* src/capabilities.c (virCapabilitiesFree): Free host.migrateTrans.
	(virCapabilitiesFreeGuest): Free arch.name member.

	Plug virCapabilities*GuestDomain leak.
	* src/capabilities.c (virCapabilitiesFreeGuestDomain): Free dom->type.
	(virCapabilitiesAddGuestDomain): Remove duplicate strdup stmt.

Mon Mar  3 07:16:35 CET 2008 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in:
	  missing comments for _virDomainBlockStats fields
	* docs/*: rebuilt docs

Fri Feb 29 18:01:14 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/Makefile.am: fix a broken line split

Fri Feb 29 12:50:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Many typos fixed (Atsushi SAKAI).

Thu Feb 28 18:04:59 CET 2008 Jim Meyering <meyering@redhat.com>

	Rewrite test-coverage rules to accommodate multiple .o files per .c.
	* src/Makefile.am (cov): Rewrite rule to merge gcov results corresponding
	to two .o files: the libvirt_la- one, and the libvirt_test_la- one.
	(tst): Remove unused rule.
	* configure.in (LV_LIBTOOL_OBJDIR): Define and AC_SUBST.

	Avoid link errors with "configure --disable-shared".
	* src/Makefile.am: Create a convenience library, libvirt_test.la,
	and don't restrict access to *its* symbols.
	* tests/Makefile.am (LDADDS): Add ../src/libvirt_test.la, so that
	"configure --disable-shared" no longer provokes link errors.
	(LIBVIRT): Remove definition.
	(LDADDS): Remove use.
	($(LIBVIRT)): Remove rule.
	(LDADDS): Use the new convenience library instead.
	(CLEANFILES): Define.
	* docs/examples/index.py (dump_Makefile): Append $(COVERAGE_LDFLAGS),
	to the LDADDS definition, to avoid link error with the combination of
	--enable-test-coverage and --disable-shared.
	* docs/examples/Makefile.am: Regenerate.
	* docs/examples/index.html: Likewise.
	* qemud/Makefile.am (libvirtd_LDFLAGS): Append $(COVERAGE_LDFLAGS).
	* src/libvirt_sym.version: Remove some SP-before-TAB.

Thu Feb 28 12:16:39 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c: applied patch from Cole Robinson to use virErrorMsg
	  in qemudReportError.

Wed Feb 27 20:21:35 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/bridge.c, src/bridge.h, src/qemu_conf.c: Set mac address
	on TUN device to work with Xenner

Wed Feb 27 20:12:35 CET 2008 Jim Meyering <meyering@redhat.com>

	Make qemud/'s rpcgen rules work.
	* qemud/Makefile.am (SUFFIXES): Define to .x before implicit rule.

Wed Feb 27 16:11:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	virMacAddrCompare for comparing MAC addresses
	* src/util.c, src/util.h, src/libvirt_sym.version: Added
	  virMacAddrCompare utility function for comparing MAC
	  addresses.
	* src/virsh.c, src/xm_internal.c: Use virMacAddrCompare
	  to compare addresses.  (Shigeki Sakamoto and Richard Jones).

Wed Feb 27 15:39:10 CET 2008 Jim Meyering <meyering@redhat.com>

	Avoid "make distcheck" failure.
	* src/Makefile.am (virsh_SOURCES): Add util-lib.h.

	Fix a "make syntax-check" failure.
	* src/capabilities.c: Include <config.h> from the .c file,
	* src/capabilities.h: ... not from the .h file.

Wed Feb 27 10:34:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Fix typos (Atsushi SAKAI).

Tue Feb 26 23:16:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/capabilities.h, src/capabilities.c, src/Makefile.am:
	Add generic API for dealing with hypervisor capabilities
	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Switch
	to using capabilities API. Add support for Xenner guests
	* src/xen_internalc, src/xend_internal.c, src/xend_internal.h,
	src/xml.h, src/xml.c, src/util.c, src/util.h, src/test.c:
	Switch to using capabilities API
	* tests/xencapstest.c, tests/xencapsdata/*.xml: Update for
	changes to capabilities API
	* proxy/Makefile.am: Link to capabilities.c and util.c

Tue Feb 26 18:38:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Implement virDomainBlockStats for QEMU/KVM.
	* src/qemu_driver.c: Implement virDomainBlockStats for QEMU/KVM
	  using QEMU/KVM 'info blockstats' command (Richard Jones).
	* src/qemu_driver.c, src/qemu_conf.h: const-correctness
	  fixes (Jim Meyering).

Tue Feb 26 18:28:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	No address attribute in Xen domain XML.
	* src/xm_internal.c: handle the case where <mac/> clause
	  in Xen domain interface has no address attribute
	  (Shigeki Sakamoto).

Tue Feb 26 08:02:57 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/driver.h src/libvirt.c src/openvz_driver.c src/qemu_driver.c
	  src/remote_internal.c src/test.c src/util.c src/util.h
	  src/xen_unified.c: added probe interface at the driver level,
	  use that to improve default hypervisor selection in the absence
	  of a given URI when connecting

Mon Feb 25 14:53:59 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/util-lib.h: fix done with Jim to allow
	  compilation of virsh with the static libraries.

Mon Feb 25 10:59:43 CET 2008 Jim Meyering <meyering@redhat.com>

	Avoid new "make syntax-check" failures.
	* .x-sc_avoid_write: Exempt src/util-lib.c, too.
	* Makefile.maint (sc_unmarked_diagnostics): Filter out false positives.
	* src/storage_backend_fs.c (virStorageBackendFileSystemVolCreate):
	Use safewrite, not write.
	* src/storage_backend_logical.c (virStorageBackendLogicalBuildPool):
	Likewise.

Fri Feb 22 13:32:11 CET 2008 Jim Meyering <meyering@redhat.com>

	avoid format string warnings
	Avoid warnings like this:
	file:nnn:format not a string literal and no format arguments
	* qemud/qemud.c: Insert a "%s" format argument.
	* qemud/remote.c: Likewise.
	* src/iptables.c: Likewise.
	* src/qemu_driver.c: Likewise.
	* src/storage_backend.c: Likewise.
	* src/storage_backend_fs.c: Likewise.
	* src/storage_backend_iscsi.c Likewise.
	* src/storage_backend_logical.c: Likewise.
	* src/storage_conf.c: Likewise.
	* src/storage_driver.c: Likewise.

	Use safewrite in place of write, in many cases.
	Also add "make syntax-check" rules to ensure no new uses sneak in.
	* Makefile.maint (sc_avoid_write): New rule, to avoid recurrence.
	* .x-sc_avoid_write: New file.  Record two legitimate exemptions.
	* qemud/qemud.c (sig_handler, qemudClientWriteBuf): Use safewrite,
	not write.
	* src/conf.c (__virConfWriteFile): Likewise.
	* src/qemu_conf.c (qemudSaveConfig, qemudSaveNetworkConfig): Likewise.
	* src/qemu_driver.c (qemudWaitForMonitor, qemudStartVMDaemon)
	(qemudVMData, PROC_IP_FORWARD): Likewise.
	* proxy/libvirt_proxy.c: Include "util.h".
	(proxyWriteClientSocket): Use safewrite.
	* src/test.c (testDomainSave, testDomainCoreDump): Likewise.
	* src/proxy_internal.c (virProxyWriteClientSocket): Likewise.
	* src/virsh.c: Include "util-lib.h".
	(vshOutputLogFile): Use safewrite.
	* src/console.c: Include "util-lib.h".
	(vshRunConsole): Use safewrite.

	Move safewrite and saferead to a separate file.
	* src/util.c (saferead, safewrite): Move function definitions to
	util-lib.c and include that .c file.
	* src/util-lib.c (saferead, safewrite): New file.
	Functions from src/util.c with slight change (s/int r =/ssize_t r =/)
	to reflect read/write return type.
	* src/util-lib.h: Declare the two moved functions.
	* src/util.h: Remove declarations.  Include src/util-lib.h.
	* proxy/Makefile.am (libvirt_proxy_SOURCES): Add src/util-lib.c.
	* qemud/Makefile.am (libvirtd_SOURCES): Likewise.
	* src/Makefile.am (virsh_SOURCES): Add util-lib.c.
	Remove some SP-before-TAB.

	With --enable-iptables-lokkit=no, avoid warning about unused parameter.
	* src/iptables.c (iptRulesSave) [!ENABLE_IPTABLES_LOKKIT]:
	Mark parameter as used.

	With --without-xen, avoid warning about unused function.
	* tests/statstest.c (testQuietError) [!WITH_XEN]: Don't define.

Thu Feb 21 19:22:10 CET 2008 Jim Meyering <meyering@redhat.com>

	Rewrite openvzSetUUID.
	* src/openvz_conf.c (openvzSetUUID): Rewrite to avoid unchecked
	lseek, write, and close as well as a potential file descriptor leak.

	Handle failed openvzLocateConfDir.
	* src/openvz_conf.c (openvzLocateConfDir, openvzGetVPSUUID):
	(openvzSetUUID): Don't dereference NULL upon failure.

Thu Feb 21 15:17:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Fix double-free in OpenVZ driver.
	* src/openvz_conf.c: Double-free fix (Anton Protopopov).

Wed Feb 20 22:48:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_sym.version: Added missing virStorageVolGetConnect

Wed Feb 20 18:24:39 CET 2008 Jim Meyering <meyering@redhat.com>

	Avoid "make syntax-check" failure.
	* docs/examples/index.py: Don't emit trailing blanks.
	* docs/examples/Makefile.am: Regenerate.

Wed Feb 20 11:52:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Update to non-deprecated PolicyKit apis
	* src/libvirt.c: call out to polkit-grant/polkit-auth to
	obtain credentials
	* po/*.po, po/libvirt.pot: Re-generate for new translatable
	strings
	* configure.in: Add test for polkit apis & CLI programs

Wed Feb 20 11:03:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* po/*.po, po/libvirt.pot: Re-generate to pull in latest
	strings from storage APIs
	* docs/libvirt-api.xml, docs/libvirt-refs.xml: Re-generate

Wed Feb 20 10:50:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvir.html, docs/site.xsl: Added webpage describing
	the storage management capabilities
	* docs/*.html: Re-generate content

Wed Feb 20 10:49:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: no-op stub impl of storage APIs

Wed Feb 20 10:46:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Added check for parted tool & libraries
	* libvirt.spec.in: Added dep on parted
	* po/POTFILES.in: Added storage_backend_disk.c
	* src/Makefile.am, src/storage_backend.c, src/parthelper.c,
	src/storage_backend_disk.c, src/storage_backend_disk.h: Added
	disk partition storage pool backend

Wed Feb 20 10:44:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Added check for iscsiadm tool
	* libvirt.spec.in: Added dep on iscsi-initiator-utils
	* po/POTFILES.in: Added storage_backend_iscsi.c
	* src/Makefile.am, src/storage_backend.c,
	src/storage_backend_iscsi.c, src/storage_backend_iscsi.h:
	Added iSCSI storage pool backend

Wed Feb 20 10:42:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Set close-on-exec flag for signal pipe

Wed Feb 20 10:39:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Added checks for LVM tools
	* docs/storage/pool-logical.xml: Example XML description
	* libvirt.spec.in: Added dep on LVM tools
	* po/POTFILES.in: Added storage_backend_logical.c
	* src/Makefile.am, src/storage_backend.c,
	src/storage_backend_logical.c, src/storage_backend_logical.h:
	Added logical volume backend

Wed Feb 20 10:32:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Add checks for mount/unmount/qemu-img/qcow-create
	* docs/storage/*.xml: Add some example XML configs for storage
	* libvirt.spec.in: Added deps on qemu-img and/or qcow-create,
	and util-linux
	* src/Makefile.am, src/storage_backend.c, src/storage_backend_fs.c,
	src/storage_backend_fs.h: Add impl of directory, filesystem &
	network filesystem pools.
	* po/POTFILES.in: Added storage_backend_fs.c

Wed Feb 20 10:32:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Add check for selinux library
	* libvirt.spec.in: Add BuildRequires on libselinux-devel
	* src/Makefile.am, tests/Makefile.am: Add selinux build flags
	* src/storage_backend.c, src/storage_backend.h: Add some
	helper routines for storage backend impls

Wed Feb 20 10:26:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* Makefile.maint: Add virStorageReportError to locale check rule
	* configure.in: Turn on large file support
	* po/POTFILES.in: Add storage driver files
	* include/libvirt/virterror.h, src/virterror.c: Add more error codes
	* src/storage_driver.c, src/storage_driver.h: Add impl of all the
	storage APIs
	* src/storage_conf.c, src/storage_conf.h: Support routines for
	parsing and formatting XML, and persisting storage pool configs
	* src/storage_backend.c, src/storage_backend.h: Contract for
	internal storage backends to interface with driver
	* src/Makefile.am: Add new storage source files to library build

Wed Feb 20 10:23:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Added convenience methods for creating pools
	and volumes without XML
	* src/buf.c, src/buf.h, src/libvirt_sym.version: Export the
	virBuffer* methods to virsh
	* src/xend_internal.c, src/xm_intenral.c, src/xml.c,
	src/qemu_conf.c
	* src/util.c, src/util.h: Export virStrToLong_ull to virsh

Wed Feb 20 10:22:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Added commands for all storage APIs

Wed Feb 20 10:20:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py, python/libvir.c, python/libvirt_wrap.h,
	python/types.c: Add binding for storage APIs

Wed Feb 20 10:18:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Implement storage APIs in remote
	driver. Replace memset+malloc with calloc. Replace strcmp
	with STREQ

Wed Feb 20 10:17:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Add binding for storage APIs
	* qemud/remote_protcol.x: Add wire format definition for storage
	APIs
	* qemud/remote_protocol.{c,h}: Re-generated
	* qemud/remote_dispatch*: Re-generated

Wed Feb 20 10:15:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvirt-api.xml, docs/libvirt-refs.xml, docs/devhelp/*:
	re-generate docs to include latest API details

Wed Feb 20 10:01:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* include/libvirt/virterror.h, src/virterror.c: Add error codes
	for storage API drivers
	* src/internal.h, src/hash.c: Add internal storage object structs
	* src/driver.h: internal driver API for storage management
	* src/libvirt.c: hook up storage API to internal driver API

Wed Feb 20 09:51:27 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	src/libvirt_sym.version: Add public API for storage management

Wed Feb 13 22:51:27 CET 2008 Jim Meyering  <meyering@redhat.com>

	Pull useless-if-before-free from gnulib, and update.
	* bootstrap (gnulib_tool): Add useless-if-before-free to
	the list of modules.
	* build-aux/useless-if-before-free: Update from gnulib.
	* gnulib/lib/vasnprintf.c: Work around a bug in HPUX 10.20.
	* gnulib/m4/vasnprintf.m4: Likewise.

Tue Feb 12 9:44:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* .x-sc_trailing_blank: ignore NEWS / ChangeLog file

Mon Feb 11 17:05:53 CET 2008 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html docs/format.html: fixes the examples on the
	  section about ethernet bridging, as raised by Maxwell Bottiger,
	  fixes bug #430790

Thu Feb  7 09:10:18 IST 2008 Mark McLoughlin <markmc@redhat.com>

	Fix gcc-4.3.0 "inlining failed" warning.

	* src/internal.h: move xstrol() variants from here ...

	* src/util.[ch]: ... to here and rename to virStrToLong()

	* src/libvirt_sym.version: export __virStrToLong_i() for
	virsh and qemud.

	* src/nodeinfo.c, src/stats_linux.c, src/virsh.c,
	  src/xend_internal.c, qemud/qemud.c: replace xstrtol()
	calls with virStrToLong()

	* src/nodeinfo.h: don't include internal.h, which was only
	needed for xstrtol(), but instead include libvirt.h which
	is suffificient for the declarations in the header.

Thu Feb  7 20:19:19 CET 2008 Jim Meyering  <meyering@redhat.com>

	Enable another syntax-check rule.
	* Makefile.cfg (local-checks-to-skip): Remove sc_no_have_config_h.
	* qemud/mdns.c: Remove "#ifdef HAVE_CONFIG_H".
	* Makefile.maint (sc_no_have_config_h): Tighten up regexp,
	so that the above mention of "HAVE_CONFIG_H" doesn't match.
	* .x-sc_no_have_config_h: New file, to exempt gnulib/ straggler.

	* autobuild.sh: Run "make syntax-check", so the autobuilder does this.

Thu Feb  7 18:02:22 CET 2008 Daniel Veillard <veillard@redhat.com>

	* qemud/remote.c: fix a missing ')' introduced earlier

Thu Feb  7 17:46:14 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/hash.c: fix a couple of problems in virHashRemoveSet based
	  on Hiroyuki Kaguchi patch and explanations.

Thu Feb  7 17:48:30 CET 2008 Jim Meyering  <meyering@redhat.com>

	Mark all qemudLog diagnostics for translation.
	* po/POTFILES.in: Add names of many new files.
	* Makefile.maint (err_func_re): Add qemudLog.
	Mark diagnostics with _(...).  Split some long lines.
	* qemud/qemud.c (remoteCheckCertFile, remoteInitializeGnuTLS):
	(qemudDispatchSignalEvent, qemudSetCloseExec, qemudSetNonBlock):
	(qemudWritePidFile, qemudListenUnix, remoteMakeSockets):
	(remoteListenTCP, qemudInitPaths, qemudInitialize):
	(qemudNetworkInit, remoteInitializeTLSSession, remoteCheckDN):
	(remoteCheckCertificate, remoteCheckAccess, qemudDispatchServer):
	(qemudClientReadBuf, qemudDispatchClientRead):
	(qemudClientWriteBuf, qemudDispatchClientWrite, qemudOneLoop):
	(remoteConfigGetStringList, checkType, GET_CONF_STR):
	(remoteConfigGetAuth, remoteReadConfigFile, main):
	* qemud/remote.c (remoteDispatchAuthSaslInit, remoteSASLCheckSSF):
	(remoteSASLCheckAccess, remoteDispatchAuthSaslStart):
	(remoteDispatchAuthSaslStep, remoteDispatchAuthSaslInit):
	(remoteDispatchAuthSaslStart, remoteDispatchAuthSaslStep):
	(qemudGetSocketIdentity, remoteDispatchAuthPolkit):
	* src/iptables.c (notifyRulesUpdated, MAX_FILE_LEN, iptRulesSave):
	(iptRulesReload):
	* src/qemu_conf.c (qemudExtractVersionInfo, qemudLoadConfig):
	(qemudLoadNetworkConfig, qemudScanConfigDir):
	* src/qemu_driver.c (qemudSetCloseExec, qemudSetNonBlock):
	(qemudAutostartConfigs, qemudStartup, qemudReload):
	(qemudWaitForMonitor, qemudStartVMDaemon, qemudVMData):
	(qemudShutdownVMDaemon, qemudStartNetworkDaemon):
	(qemudShutdownNetworkDaemon, qemudMonitorCommand):
	(qemudDomainUndefine, qemudNetworkUndefine):
	* src/uuid.c (virUUIDGenerate):
	* src/xm_internal.c (xenXMAttachInterface):

	Remove more useless if tests before "free"-like functions.
	* build-aux/useless-if-before-free: Rename from ...
	* build-aux/find-unnecessary-if-before-free: ... this.  Remove file.
	Also changed it so that new names are no longer hard-coded in the
	script.  Instead, they're supplied via options:
	* Makefile.cfg (useless_free_options): Define.
	Add xmlXPathFreeObject to the list of free-like functions it detects.
	* Makefile.maint (sc_avoid_if_before_free): Reflect script renaming.
	* .x-sc_avoid_if_before_free: Likewise.
	* src/openvz_conf.c (openvzParseXML): Remove useless "if"-before-free.
	* src/qemu_conf.c (qemudParseXML, qemudParseNetworkXML): Likewise.
	* src/virsh.c (cmdVNCDisplay, cmdTTYConsole, cmdDetachInterface):
	(cmdDetachDisk): Likewise.
	* src/xm_internal.c (xenXMConfigSetIntFromXPath): Likewise.
	(xenXMConfigSetStringFromXPath, xenXMParseXMLToConfig): Likewise.
	(xenXMDomainAttachDevice, xenXMAttachDisk, xenXMAttachInterface):
	(xenXMDomainDetachDevice): Likewise.
	* src/xml.c (virXPathString): Likewise.
	* tests/xmlrpctest.c (checkRequestValue): Likewise.

2008-02-07  Jim Meyering  <meyering@redhat.com>

	* src/xm_internal.c: Remove trailing blanks
	* NEWS, ChangeLog: Likewise.

Thu Feb  7 10:19:12 IST 2008 Mark McLoughlin <markmc@redhat.com>

	* src/xen_internal.c: Don't crash if there's no
	/sys/hypervisor/capabilities

Thu Feb  7 10:16:42 IST 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c: Create directory for saving iptables rules

Thu Feb  7 10:12:15 IST 2008 Mark McLoughlin <markmc@redhat.com>

	* src/xm_internal.[ch]: Move static function prototype from header

Thu Feb  7 10:47:44 CET 2008 Daniel Veillard <veillard@redhat.com>

	* python/libvir.c: apply patch from Cole Robinson to provide
	  return values for manulally written python bindings.

Thu Feb  7 10:29:57 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: fix bug in xenUnifiedDomainSuspend() patch provided
	  by Marcus Meissner

Wed Feb  6 18:55:37 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.[ch]: applied patch from Shigeki Sakamoto to
	  add/change/delete a Disk/NIC of an inactive domains

Wed Feb  6 17:22:34 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.c: applied 2 patches from Guido Guenther to avoid
	  crashes when reading the config file

Tue Feb  3 20:26:53 CET 2008  Jim Meyering  <meyering@redhat.com>

	Fix new "make distcheck" failures.
	* src/xml.c (virDomainParseXMLOSDescHVM): Mark a diagnostic.

	Remove all trailing blanks; turn on the rule to detect them.
	* Makefile.cfg (local-checks-to-skip): Remove sc_trailing_blank.
	* .x-sc_trailing_blank: New file, to exempt the few binary files.

Tue Feb  3 11:21:45 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c, src/xend_internal.c: Allow use of kernel+initrd
	in HVM guests as well as PV
	* tests/xml2sexprdata/*, tests/sexpr2xmldata/*: Updated for
	slight changes in SXPR element ordering
	* tests/xml2sexprtest.c, tests/sexpr2xmltest.c: Add test
	case for new HVM kernel+initrd ability

Tue Feb  3 15:21:45 CET 2008  Jim Meyering  <meyering@redhat.com>

	Eliminate all uses of virBufferAdd with string literals.
	* Makefile.maint (sc_prohibit_virBufferAdd_with_string_literal):
	New rule.
	* src/buf.h (virBufferAddLit): Define.
	* src/conf.c (virConfSaveValue): Use virBufferAddLit, in place
	of virBufferAdd everywhere possible.
	(virConfSaveEntry): Likewise.
	* src/qemu_conf.c (qemudGenerateXML, qemudGenerateNetworkXML): Likewise.
	* src/qemu_driver.c (qemudGetFeatures, qemudGetCapabilities): Likewise.
	* src/test.c (testDomainDumpXML, testNetworkDumpXML): Likewise.
	* src/xen_internal.c (xenHypervisorMakeCapabilitiesXML): Likewise.
	* src/xend_internal.c (xend_parse_sexp_desc_os): Likewise.
	(xend_parse_sexp_desc, sexpr_to_xend_topology_xml): Likewise.
	* src/xm_internal.c (xenXMDomainFormatXML, xenXMDomainPinVcpu): Likewise.
	* src/xml.c (virSaveCpuSet, virParseXenCpuTopology): Likewise.
	(virDomainParseXMLGraphicsDescImage): Likewise.
	(virDomainParseXMLGraphicsDescVFB, virDomainParseXMLOSDescHVM): Likewise.
	(virDomainParseXMLOSDescPV, virDomainParseXMLDiskDesc): Likewise.
	(virDomainParseXMLIfDesc, virDomainParseXMLDesc): Likewise.

Mon Feb  2 15:56:45 CET 2008  Jim Meyering  <meyering@redhat.com>

	Enable more checks for unmarked messages; fix violators.
	* Makefile.maint (sc_unmarked_diagnostics): Check for more functions.
	* src/conf.c (virConfParseValue): Remove trailing space in diagnostic.
	* src/libvirt.c (do_open, virDomainMigrate): Mark diagnostics.
	* src/xend_internal.c (do_connect, xenDaemonDomainDumpXMLByID): Likewise.
	(xenDaemonDomainDumpXMLByName, xenDaemonCreateLinux): Likewise.
	(xenDaemonDomainMigratePerform, xenDaemonDomainDefineXML): Likewise.
	* src/xml.c (virXPathString, virXPathNumber, virXPathLong): Likewise.
	(virXPathBoolean, virXPathNode, virXPathNodeSet): Likewise.
	(virDomainParseXMLOSDescHVM): Likewise.
	* src/xmlrpc.c (xmlRpcValueNew): Likewise.
	(xmlRpcValueUnmarshalDictElement): Likewise.

	Mark a string for translation.
	* src/virsh.c: Add a "%s" and wrap with _(...).

	Enable the sc_unmarked_diagnostics test and correct all violations
	involving the "error" function.
	* Makefile.cfg (local-checks-to-skip): Remove from skip list.
	* src/remote_internal.c: Mark translatable strings.

Fri Feb  1 20:46:07 CET 2008  Jim Meyering  <meyering@redhat.com>

	Pull vc-list-files from gnulib, and update.
	* bootstrap (gnulib_tool): Add the vc-list-files module.

Thu Jan 31 20:12:40 CET 2008  Guido Guenther  <agx@sigxcpu.org>

	Avoid compilation failure when building --without-xen.
	* tests/statstest.c (testDevice) [!WITH_XEN]: #ifdef-out.
	(main) [!WITH_XEN]: #ifdef-out the body.

Wed Jan 30 20:49:34 CET 2008  Jim Meyering  <meyering@redhat.com>

	Avoid virsh leaks due to missing virDomainFree(dom) calls
	* src/virsh.c (cmdDomuuid): Add missing virDomainFree call.
	(cmdAttachDevice): Likewise.
	(cmdDetachDevice): Likewise.

	* src/virsh.c (cmdCapabilities): Plug a small leak.

	* src/test.c (testLoadDomain): Avoid leaks upon failure.

	Avoid used-uninitialized errors in test driver.
	* src/test.c (testOpenFromFile): Initialize "privconn".

	* src/libvirt.c (do_open): Avoid double-free upon failure.

	Avoid segfault upon malloc failure, and plug a leak.
	* src/test.c (testDomainSave): Detect testDomainDumpXML failure.
	Free "xml".

	Plug test-related leaks.
	* src/test.c (testLoadNetwork): Free forwardDev.
	(testLoadDomain): Free ctxt.
	(testLoadNetwork): Likewise.
	(testOpenFromFile): Likewise.

Wed Jan 30 13:18:25 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/hash.c: Remove double mutex lock() flaw

Wed Jan 30 11:35:25 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fix SXPR -> XML conversion for USB
	devices.
	* tests/sexpr2xmldata/sexpr2xml-fv-usbmouse.sexpr,
	tests/sexpr2xmldata/sexpr2xml-fv-usbtablet.sexpr: Fix test
	case SXPR to actually match what XenD produces for USB devices.

Wed Jan 30 07:54:25 CET 2008  Jim Meyering  <meyering@redhat.com>

	Arrange for "make syntax-check" to pass.
	* .x-sc_avoid_if_before_free: Exempt ChangeLog.
	* tests/statstest.c: Include <config.h>, not "config.h".

Tue Jan 29 13:33:25 EST 2008  Daniel P. Berrange <berrange@redhat.com>

	* src/stats_linux.c, src/stats_linux.h: Fix conversion of device
	names into device numbers
	* tests/.cvsignore, tests/Makefile.am, tests/statstest.c: Add
	test case to validate device name -> number conversion

Tue Jan 29 18:39:25 CET 2008  Jim Meyering  <meyering@redhat.com>

	Also detect and remove unnecessary if-before-xmlXPathFreeContext.
	* build-aux/find-unnecessary-if-before-free: Update regexp.
	* src/virsh.c: Remove unnecessary "if (P)"-before xmlXPathFreeContext.
	* src/openvz_conf.c: Likewise.
	* src/qemu_conf.c: Likewise.
	* src/xm_internal.c: Likewise.
	* src/xml.c: Likewise.
	* tests/xmlrpctest.c: Likewise.

	Enable two more tests.
	* Makefile.cfg (local-checks-to-skip)
	[sc_cast_of_x_alloc_return_value, sc_cast_of_argument_to_free]: Enable.

	Enable the <assert.h>-checking test; fix violations.
	* Makefile.cfg (local-checks-to-skip)
	[sc_prohibit_assert_without_use]: Enable.
	* qemud/mdns.c: Don't include <assert.h>; no uses of assert here.
	* qemud/qemud.c: Likewise.
	* qemud/remote.c: Likewise.

	Enable the po-check test; fix violations.
	* Makefile.cfg (local-checks-to-skip) [po-check]: Enable.
	* po/POTFILES.in: Add three file names.  Sort.

	Update from gnulib
	* lib/poll.c: Update.
	* lib/string.in.h: Update.
	* m4/string_h.m4: Update.
	* tests/test-getaddrinfo.c: Update.
	* lib/Makefile.am: Regenerate.

	Enable the <config.h>-requiring test; fix violations
	Use <config.h>, not "config.h", per autoconf documentation.
	* Makefile.cfg (local-checks-to-skip) [sc_require_config_h]: Enable.
	* .x-sc_require_config_h: New file, to list exempted files.
	* Makefile.am (EXTRA_DIST): Add .x-sc_require_config_h.

	Enable the duplicate-"the" test; fix violations
	* Makefile.cfg (local-checks-to-skip) [sc_the_the]: Enable.
	* docs/virsh.pod: Remove a duplicate "the".
	* libvirt.spec.in: Likewise.
	* virsh.1: Likewise.

	Add framework for code style- and syntax-checking rules.
	Almost all tests are initially disabled via the list in Makefile.cfg.
	* Makefile.am (EXTRA_DIST): Add .x-sc_avoid_if_before_free.
	Omit names of files that automake includes automatically.
	* .x-sc_avoid_if_before_free: New file.
	* build-aux/vc-list-files: Likewise.
	* build-aux/find-unnecessary-if-before-free: Likewise.
	* GNUmakefile, Makefile.cfg, Makefile.maint: New files.

	Given code like if (foo) free (foo); remove the useless "if (foo) " part
	Likewise, given if (foo != NULL) free (foo); remove the useless "if"
	test.
	* proxy/libvirt_proxy.c: Remove unnecessary "if" test before free.
	* python/generator.py: Likewise.
	* qemud/qemud.c: Likewise.
	* src/buf.c: Likewise.
	* src/conf.c: Likewise.
	* src/hash.c: Likewise.
	* src/iptables.c: Likewise.
	* src/libvirt.c: Likewise.
	* src/openvz_conf.c: Likewise.
	* src/qemu_conf.c: Likewise.
	* src/qemu_driver.c: Likewise.
	* src/remote_internal.c: Likewise.
	* src/test.c: Likewise.
	* src/virsh.c: Likewise.
	* src/virterror.c: Likewise.
	* src/xen_internal.c: Likewise.
	* src/xen_unified.c: Likewise.
	* src/xend_internal.c: Likewise.
	* src/xm_internal.c: Likewise.
	* src/xml.c: Likewise.
	* src/xmlrpc.c: Likewise.
	* src/xs_internal.c: Likewise.
	* tests/testutils.c: Likewise.
	* tests/xencapstest.c: Likewise.
	* tests/xmconfigtest.c: Likewise.

Fri Jan 25 12:00:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Clarify virsh documentation.
	* docs/virsh.pod: Clarify virsh documentation on when you can
	  set memory and vCPUs.

Fri Jan 25 10:46:32 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: fix an erronous use of VIR_DOMAIN_NONE instead
	  of VIR_DOMAIN_NOSTATE (both defined as 0, no regression)

Thu Jan 24 18:08:28 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: Jay Gagnon pointed out that virDomainGetXMLDesc
	  was failing with a non-zero flag value

Thu Jan 24 10:08:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Correct typos in the documentation (Atsushi SAKAI)
	* README, libvirt.spec.in, docs/devhelp/html.xsl,
	  docs/devhelp/index.html: Correct typos in the documentation.

Wed Jan 23 14:36:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Fix enablement of SASL

Wed Jan 23 14:47:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Portability improvements for Mac OS X.
	* configure.in: Use PortableXDR if available.
	* qemud/internal.h: Use "socketcompat.h".
	* qemud/qemud.c: Use <signal.h>.
	* src/sexpr.c: Use <stdlib.h> instead of <malloc.h>.
	* src/socketcompat.h: Include <sys/un.h> for Mac OS X.

Wed Jan 23 14:43:00 BST 2008 Richard W.M. Jones <rjones@redhat.com>

	Remove DOS line-endings.
	* src/socketcompat.h: Remove DOS line-endings in this file.

Tue Jan 22 16:27:47 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* configure.ac: Remove use of PKG_CHECK_EXISTS macro. Avoid
	lines going over 80 chars wide. Make sasl check automatic
	enable/disable as neccessary.
	* acinclude.m4: Added compatability macro for old pkg-config
	* src/gnutls_1_0_compat.h: Add compat for gnutls_cipher_algorithm_t

Mon Jan 21 18:03:47 CET 2008  Jim Meyering  <meyering@redhat.com>

	Avoid "may be used uninitialized" warning.
	* tests/xmconfigtest.c (testCompareParseXML): Initialize "old_priv".

Mon Jan 21 11:18:04 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/hash.c: Split the virFree* functions into virUnref*
	and virRelease*. Switch to use standard pthread_mutex_t type.
	* src/internal.h: Rename virFree* to virUnref*
	* src/qemu_driver.c: Remove bogus release of object in
	virDomainDestroy and virNetworkDestroy.
	* src/xend_internal.c, src/libvirt.c: Update to call virUnref*
	* src/xs_internal.c: Remove dead code & mark functions static

Mon Jan 21 10:52:04 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: Abort with non-zero status if any functions
	are marked as failed.
	* python/libvir.c: Don't do manual virDomainFree/virNetworkFree/
	virConnectFree since the generator creates them without issue

Mon Jan 21 10:39:04 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: mark VCPU / schedular related functions
	as skipped.
	* python/libvirt-python-api.xml: Add new defs for VCPU/ schedular
	related functions
	* python/libvir.c: Manual impl of VCPU/schedular functions

Mon Jan 21 10:25:04 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c, src/util.h: Rename virFileReadAll to __virFileReadAll,
	and add macro for compat
	* src/libvirt_sym.version: Export __virFileReadAll
	* src/virsh.c: Use virFileReadAll for loading XML files

Mon Jan 21 10:12:04 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/openvz_driver.c: Remove no-op networking APIs

Mon Jan 21 15:03:04 CET 2008  Jim Meyering  <meyering@redhat.com>

	Adjust sexpr-related interfaces to be const-correct.
	* src/sexpr.c (sexpr_cons, append, sexpr_append, sexpr2string)
	(sexpr_lookup_key, sexpr_lookup, sexpr_node, sexpr_fmt_node):
	Add "const" attribute where appropriate.
	* src/xend_internal.c (sexpr_int, sexpr_float, sexpr_u64)
	(sexpr_uuid, sexpr_to_xend_domain_info, sexpr_to_xend_node_info)
	(sexpr_to_xend_topology_xml, sexpr_to_domain): Likewise.
	* src/sexpr.h: Adjust prototypes.

	Don't access line[-1] for a zero-length "line" from fgets.
	A NUL byte at beginning of input, or just after a newline
	would provoke an invalid buf[-1] access (possible segfault).
	* src/libvirt.c (virConnectAuthCallbackDefault):

Mon Jan 21 09:25:12 CET 2008 Daniel Veillard <veillard@redhat.com>

	* src/xml-internal.c: apply patch from Hiroyuki Kaguchi to
	  preserve the vif list order.

Mon Jan 21 09:06:28 CET 2008 Daniel Veillard <veillard@redhat.com>

	* docs/API* docs/api.xsl docs/site.xsl docs/Makefile.am: remove the
	  generation of the API*.html files as it's not really useful here

Sun Jan 20 11:01:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/internal.h: Add xstrtol_ull, xstrtol_ll convenience
	functions

Sun Jan 20 10:54:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fix nodeinfo compat with Xen 3.2.0 and
	add sanity checking of data

Sat Jan 19 13:32:22 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/configure.in: enable debug by default. print status of
	compiler warning flags in configure summary
	* src/internal.h: Provide a generic VIR_DEBUG macro for logging
	* src/libvirt.c, src/remote_internal.c, src/xen_unified.c,
	src/xend_internal.c: Use generic VIR_DEBUG macro for logging.
	Enable debug when env var LIBVIRT_DEBUG=1

Thu Jan 17 23:12:42 CET 2008  Jim Meyering  <meyering@redhat.com>

	Handle PyTuple_New's malloc failure.
	* python/libvir.c (libvirt_virDomainBlockStats): Handle a NULL
	return from PyTuple_New.
	(libvirt_virDomainInterfaceStats, libvirt_virGetLastError): Likewise.
	(libvirt_virConnGetLastError): Likewise.

	Factor out some duplication.
	* python/libvir.c (VIR_PY_NONE): New macro, to encapsulate
	a common two-statement sequence.
	Replace all such 2-stmt sequences.

	Avoid format string warnings.
	* src/virsh.c: Add "%s" where needed.
	* src/proxy_internal.c: Likewise.

Tue Jan 15 16:25:57 CET 2008  Jim Meyering  <meyering@redhat.com>

	* docs/examples/examples.xml: Regenerate, now that *.c file names
	are sorted.

Tue Jan 15 10:01:53 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.h, src/qemu_conf.c: Add support for 'keymap'
	parameter wrt to VNC servers (Daniel Hokka Zakrisson)

Tue Jan 15 09:18:53 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix off by one in checking SSH
	argv for NULL. Fix format args in error message to avoid
	compile warning.

2008-01-14  Jim Meyering  <meyering@redhat.com>

	Update files from gnulib.
	* gnulib/lib/Makefile.am: Update.
	* gnulib/lib/float.in.h: Likewise.
	* gnulib/lib/fseeko.c: Likewise.
	* gnulib/lib/printf-parse.c: Likewise.
	* gnulib/lib/stdint.in.h: Likewise.
	* gnulib/lib/stdio.in.h: Likewise.
	* gnulib/lib/stdlib.in.h: Likewise.
	* gnulib/lib/string.in.h: Likewise.
	* gnulib/lib/unistd.in.h: Likewise.
	* gnulib/lib/vasnprintf.h: Likewise.
	* gnulib/m4/alloca.m4: Likewise.
	* gnulib/m4/float_h.m4: Likewise.
	* gnulib/m4/gnulib-comp.m4: Likewise.
	* gnulib/m4/stdlib_h.m4: Likewise.
	* gnulib/m4/string_h.m4: Likewise.
	* gnulib/m4/unistd_h.m4: Likewise.
	* gnulib/tests/Makefile.am: Likewise.
	* gnulib/tests/test-fseeko.c: Likewise.

	Clean up the global name space.
	* src/qemu_conf.c: Add "static" and "const" attributes to some globals.
	* src/qemu_conf.h: Update a declaration.
	* src/qemu_driver.c (qemud_driver): Declare static.

	Clean up global name space in examples and tests.
	* docs/examples/suspend.c: Declare global "conn" to be static.
	* tests/qemuxml2argvtest.c: Declare global "driver" to be static.
	* tests/qemuxml2xmltest.c: Likewise.

Sun Jan 13 22:59:53 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Refactor code to make error patches
	clearer (Jim Meyering).

Sun Jan 13 22:53:53 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix crash when server has auth type
	enabled but client has no auth callback

Thu Jan 10 14:40:53 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c: fix an unused variable warning.

Thu Jan 10 13:59:15 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.[ch]: add iptablesSaveRules(), and don't
	save the rules to disk and run lokkit each time a new
	rule is added

	* src/qemu_driver.c: use iptablesSaveRules()

Thu Jan 10 13:57:56 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c: now that we only use built-in iptables
	chains, we don't need to add or delete them

Thu Jan 10 13:56:33 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	Like --with-iptables-prefix, --with-iptables-dir is no
	longer useful, so let's remove it.

	* configure.in, src/iptables.c: remove --with-iptables-dir

Thu Jan 10 13:54:10 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	--with-iptables-prefix was added to integrate with
	a proposed system for letting iptables know how to
	reload our rules. The proposed system wasn't accepted
	so, although there might be some other theoretical
	use for this, let's just remove it.

	* configure.in, src/iptables.c: remove --with-iptables-prefix

Thu Jan 10 13:52:05 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	Add support for integrating our iptables support with
	Fedora's iptables configuration using the lokkit --custom-rules
	command.

	Basically, we write out our rules to /var/lib/libvirt/iptables
	and run lokkit --custom-rules so that if e.g. iptables is
	restarted or the user edits their firewall configuration,
	then libvirt's rules get reloaded.

	* configure.in: Add --enable-iptables-lokkit

	* src/iptables.c: Add support for lokkit

Thu Jan 10 13:51:00 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c: Include the iptables command and chain
	name in the saved rules files

Thu Jan 10 13:50:11 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c: Re-name the "flipflop" variable to "command_idx"

Thu Jan 10 13:49:01 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c:  make use of virFileMakePath(),
	virFileBuildPath() and virRun().

Thu Jan 10 13:48:01 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/iptables.c: Fix compile error in --with-iptables-dir code

Thu Jan 10 13:46:14 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/util.c: change virExec() such that with --enable-debug,
	stdout and stderr no longer go to /dev/null.

Thu Jan 10 13:44:17 GMT 2008 Mark McLoughlin <markmc@redhat.com>

	* src/util.[ch]: Add virRun() helper function (Dan Berrange)

Wed Jan  9 16:04:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c: Ensure cpumap is at least 8 bytes long
	when doing hypercall (Saori Fukuta)

Wed Jan  9 10:55:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Wire up to system_shutdown command for
	graceful ACPI triggered shutdown process (Guido Guenther)

Tue Jan  8 12:48:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: cast  off_t to int in debug output to avoid warning

Tue Jan  8 11:12:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c: Fix addr passed to free() in error cleanup

Mon Jan  7 10:19:00 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/util.c, src/util.h: virFileReadAll() now allocates its
	own buffer
	* src/conf.c: Use virFileReadAll() to avoid truncating config
	files
	* src/qemu_conf.c: Update for new virFileReadAll() contract
	* tests/test_conf.sh, tests/confdata/libvirtd.conf,
	tests/libvirtd.out: New test case for large config file

Sat Jan  5 16:02:00 UTC 2008 Richard W.M. Jones <rjones@redhat.com>

	Miscellaneous fixes for building on Windows (MinGW).
	* configure.in: xdr functions may require -lxdr.
	* configure.in, src/Makefile.am: Extra linking flags for
	  building libvirt DLL.
	* src/socketcompat.h: Hide Windows Winsock incompatibilities
	  in a separate header file.
	* src/remote_internal.c: Switch to using socketcompat.h /
	  socket_errno().
	* src/test.c: Switch to using socketcompat.h.
	* gnulib/lib/arpa/.cvsignore: Ignore another generated file.
	* src/qparams.c: Include <config.h>.

Wed Jan  2 17:45:53 EST 2008 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: fix policykit auth handling of NULL
	callbacks to not crash

Wed Dec 26 06:38:53 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/openvz.c: patch from Mikhail Pokidko to fix the OpenVZ
	  compilation error #426385

Tue Dec 18 00:18:33 CET 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in docs/libvir.html docs/news.html po/*:
	  prepare release of libvirt-0.4.0

Mon Dec 17 18:04:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Added dep on 'nc'

Mon Dec 17 18:03:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Compatability with Xen 3.2.0 changed
	fields for physinfo data used by virNodeInfoPtr.

Mon Dec 17 17:38:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	Fix remote_internal.c error handling of qparam_get_query
	* src/remote_internal.c: Fixed reversed check of error handling
	  of qparam_get_query call (Dan Berrange).

Mon Dec 17 10:05:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	Add separate qparams module for handling query parameters.
	* src/qparams.c, src/qparams.h, src/Makefile.am: Added a
	  separate 'qparams' module for handling query parameters.
	* src/remote_internal.c: Factor out query parameter code so
	  it uses the 'qparams' module.

Mon Dec 17 10:01:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	Add extra utility functions to buf.c
	* src/buf.c, src/buf.h: Added utility functions
	  virBufferURIEncodeString and virBufferAddChar to the
	  buffer module.

Sat Dec 15 12:12:14 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Return error code if passed unsupported
	credential types.
	* src/remote_internal.c: Don't run callback if it doesn't
	support the VIR_CRED_EXTERNAL credential type

Fri Dec 14 16:50:14 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c: patch from Saori Fukuta to fix setting
	  CPU parameters in the config files, the value was overwritten

Fri Dec 14 16:36:02 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xs_internal.[ch]: patch from Saori Fukuta to fix the
	  detach-disk command when using Xen tap devices.
	* docs/libvir.html: typo fix from Jim Meyering

Wed Dec 12 16:42:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	Fix virBufferEscapeString escaping of '<'
	* src/buf.c (virBufferEscapeString): '<' escaped as "&lt;"

Wed Dec 12 09:11:44 CET 2007 Jim Meyering <meyering@redhat.com>

	Always build in python/ subdir.
	* configure.in (PYTHON_SUBDIR): Don't set.  Remove all uses.
	* Makefile.am (SUBDIRS): Hard-code "python" here.
	(tests): Test equivalent "$(pythondir)", not @PYTHON_SUBDIR@.

Wed Dec 12 08:20:07 CET 2007 Jim Meyering <meyering@redhat.com>

	Accommodate automake-1.9.
	* tests/Makefile.am (TESTS_ENVIRONMENT): Adjust PATH setting
	to work also with automake-1.9.  Can't use $(abs_top_builddir).

Tue Dec 11 22:56:47 CET 2007 Jim Meyering <meyering@redhat.com>

	Use a variable name as sizeof argument, not a type name.
	Given code like: T *var = calloc (n, sizeof (T));
	Convert to this: T *var = calloc (n, sizeof (*var));
	This first-cut change adjusts all malloc, calloc, and
	realloc statements.
	The only binary differences are in remote_internal.c
	(due to the bug fix) and in xmlrpc.c (due to factorization).
	* python/libvir.c: As above.
	* qemud/event.c: Likewise.
	* qemud/mdns.c: Likewise.
	* qemud/qemud.c: Likewise.
	* qemud/remote.c: Likewise.
	* src/bridge.c: Likewise.
	* src/buf.c: Likewise.
	* src/conf.c: Likewise.
	* src/hash.c: Likewise.
	* src/iptables.c: Likewise.
	* src/openvz_conf.c: Likewise.
	* src/qemu_conf.c: Likewise.
	* src/qemu_driver.c: Likewise.
	* src/test.c: Likewise.
	* src/xen_internal.c: Likewise.
	* src/xen_unified.c: Likewise.
	* src/xm_internal.c: Likewise.
	* src/xml.c: Likewise.
	* tests/qemuxml2argvtest.c: Likewise.
	* src/xmlrpc.c (xmlRpcValuePtr): Likewise, and minor factorization.
	* src/remote_internal.c (remoteAuthMakeCredentials): Use the right
	type when allocating space for an array of cred _pointers_.

Tue Dec 11 22:19:22 CET 2007 Jim Meyering <meyering@redhat.com>

	Test libvirtd's config-processing code.
	And remove a minor diagnostic inconsistency.
	* tests/daemon-conf: New test.
	* tests/Makefile.am (TESTS_ENVIRONMENT): Prepend qemud/ to PATH,
	so we can invoke libvirtd without an absolute name.
	(test_scripts): Add daemon-conf.
	* qemud/qemud.c (remoteConfigGetAuth): Use checkType,
	rather than open-coding it with a different diagnostic.

Mon Dec 10 19:25:22 CET 2007 Jim Meyering <meyering@redhat.com>

	Add gnulib-tool unit tests.
	* bootstrap: Re-add --with-tests, now that gnulib-tool
	arranges to use separate libraries for lib/ and tests/.
	* configure.in (AC_OUTPUT): Add gnulib/tests/Makefile.in.
	* Makefile.am (SUBDIRS): Add gnulib/tests.
	* gnulib/tests/Makefile.am: New file.
	* gnulib/lib/.cvsignore: Sort.
	* gnulib/lib/Makefile.am, gnulib/m4/getdelim.m4, gnulib/m4/getline.m4:
	* gnulib/m4/gnulib-cache.m4, gnulib/m4/gnulib-comp.m4: Regenerate.
	* gnulib/tests/test-alloca-opt.c: New file, from gnulib.
	* gnulib/tests/test-arpa_inet.c: Likewise.
	* gnulib/tests/test-fseeko.c: Likewise.
	* gnulib/tests/test-fseeko.sh: Likewise.
	* gnulib/tests/test-getaddrinfo.c: Likewise.
	* gnulib/tests/test-getdelim.c: Likewise.
	* gnulib/tests/test-getline.c: Likewise.
	* gnulib/tests/test-lseek.c: Likewise.
	* gnulib/tests/test-lseek.sh: Likewise.
	* gnulib/tests/test-netinet_in.c: Likewise.
	* gnulib/tests/test-snprintf.c: Likewise.
	* gnulib/tests/test-stdbool.c: Likewise.
	* gnulib/tests/test-stdint.c: Likewise.
	* gnulib/tests/test-stdio.c: Likewise.
	* gnulib/tests/test-stdlib.c: Likewise.
	* gnulib/tests/test-string.c: Likewise.
	* gnulib/tests/test-sys_select.c: Likewise.
	* gnulib/tests/test-sys_socket.c: Likewise.
	* gnulib/tests/test-sys_stat.c: Likewise.
	* gnulib/tests/test-sys_time.c: Likewise.
	* gnulib/tests/test-unistd.c: Likewise.
	* gnulib/tests/test-vasnprintf.c: Likewise.
	* gnulib/tests/test-vasprintf.c: Likewise.
	* gnulib/tests/test-wchar.c: Likewise.
	* gnulib/tests/dummy.c: Likewise.
	* gnulib/tests/intprops.h: Likewise.
	* gnulib/tests/verify.h: Likewise.

Sat Dec  8 18:06:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* gnulib/lib/arpa/inet.h: Remove autogenerated file

Fri Dec  7 10:25:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* gnulib/m4/getdelim.m4, gnulib/m4/getline.m4: Remove bogus
	AC_PREREQ(2.60) since it works fine without this

Fri Dec  7 10:16:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: ensure $prefix is quoted in conditional test

Fri Dec  7 14:55:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* proxy/Makefile.am: Include gnulib code when building the
	  proxy.

Fri Dec  7 14:49:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/console.c, src/console.h, src/virsh.c: Disable
	  text console on Windows.
	* src/libvirt.c: Use replacement getpass from Gnulib.
	* src/libvirt.c: Initialize Winsock before use.
	* src/remote_internal.c: Header file fixes for Windows.
	  Don't fail if AI_ADDRCONFIG isn't defined.  Disable
	  unsupported stuff under Windows.
	* src/uuid.c: ENODATA unavailable on Windows, use EIO instead.
	* src/virsh.c: No uid_t / getuid on Windows.
	* src/virsh.c: No O_SYNC on Windows.

Fri Dec  7 14:47:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/internal.h: Use gnulib gettext library.  Define
	  INET_ADDRSTRLEN unless already defined.

Fri Dec  7 14:36:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/.cvsignore: Ignore *.loT files (generated under Windows).
	* proxy/libvirt_proxy.c: Bail out earlier --without-xen.
	* src/proxy_internal.c: Don't build proxy client side if
	  configured --without-xen.
	* src/iptables.c, src/iptables.h: Disable this code if
	  configured --without-qemu.
	* src/nodeinfo.c: If no 'uname' function, set model name to
	  empty string (for Windows).
	* src/xen_unified.h, src/util.c, src/test.c: Include <winsock2.h>
	  on Windows.
	* src/util.c: Disable virExec* and virFileLinkPointsTo on
	  MinGW.

Fri Dec  7 14:34:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/sexpr.c: Cosmetic rearrangement of headers.

Fri Dec  7 14:27:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Extra checks for uname and some header files
	  (for MinGW Windows port).

Fri Dec  7 14:27:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* bootstrap, Makefile.am, gnulib/*: Import more gnulib
	  modules for use by MinGW Windows port.

Fri Dec  7 11:06:58 CET 2007 Jim Meyering <meyering@redhat.com>

	Include "config.h" in remaining non-generated files.
	* proxy/libvirt_proxy.c: Likewise.
	* python/libvir.c: Likewise.
	* python/types.c: Likewise.
	* src/event.c: Likewise.
	* src/xm_internal.c: Likewise.
	* tests/reconnect.c: Likewise.
	* tests/testutils.c: Likewise.

Fri Dec  7 09:39:41 CET 2007 Daniel Veillard <veillard@redhat.com>

	* python/generator.py python/libvir.c python/libvirt-python-api.xml:
	  add a python binding for virNodeGetCellsFreeMemory

Thu Dec  6 12:41:18 CET 2007 Jim Meyering <meyering@redhat.com>

	* qemud/qemud.c (qemudInitPaths): Remove unused code.

Thu Dec  6 16:32:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: The prompt should depend on readonly status,
	  not on the UID.

Thu Dec  6 16:30:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, qemud/Makefile.am: Added a --without-libvirtd
	  configure option.

Thu Dec  6 10:35:41 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Fix macros build on RHEL distros

Thu Dec  6 15:53:41 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/*: rebuilt the docs and XML files

Thu Dec  6 15:42:52 CET 2007 Daniel Veillard <veillard@redhat.com>

	* po/*: updated the localization files

Thu Dec  6 12:00:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Clean up a warning if neither SASL
	  nor PolKit are enabled.

Thu Dec  6 12:41:18 CET 2007 Jim Meyering <meyering@redhat.com>

	Build also on systems where -lreadline requires e.g., -lncurses.
	* configure.in: If the test for -lreadline fails, search for a
	library with termcap support.  If one is found (often -lncurses),
	rerun the test for -lreadline, linking also with the new library.

Thu Dec  6 11:23:31 CET 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in src/Makefile.am src/virsh.c: fix compilation problems
	  when readline headers were found but not the library

Wed Dec  5 23:57:53 CET 2007 Jim Meyering <meyering@redhat.com>

	Accommodate developers using autoconf-2.59.
	* configure.in (m4_foreach_w): Define if not defined.

Wed Dec  5 22:38:18 CET 2007 Jim Meyering <meyering@redhat.com>

	Include "config.h".
	* qemud/event.c: Likewise.
	* src/buf.c: Likewise.
	* src/hash.c: Likewise.
	* src/nodeinfo.c: Likewise.
	* src/openvz_conf.c: Likewise.
	* src/proxy_internal.c: Likewise.
	* src/virterror.c: Likewise.
	* src/xmlrpc.c: Likewise.
	* src/xs_internal.c: Likewise.
	* tests/conftest.c: Likewise.
	* tests/xmlrpctest.c: Likewise.
	This fixes a mingw build failure reported by Rich Jones.

Wed Dec  5 22:34:27 CET 2007 Jim Meyering <meyering@redhat.com>

	Add all of the files pulled in from gnulib by running ./bootstrap.
	Adjust some .cvsignore files.

Wed Dec  5 22:30:03 CET 2007 Jim Meyering <meyering@redhat.com>

	Use gnulib, starting with its physmem and getaddrinfo modules.
	New files go into these directories:
	  gnulib/lib
	  gnulib/m4
	  gnulib/tests
	* bootstrap: A wrapper around gnulib-tool.
	* configure.in: Invoke gl_EARLY and gl_INIT, being careful to put
	gl_EARLY before any macro that uses AC_COMPILE_IFELSE.
	(AC_OUTPUT): Add lib/Makefile and gl-tests/Makefile.  Remove m4/Makefile.
	* Makefile.am (SUBDIRS): Add gnulib/lib and remove m4.  Add gnulib/tests
	early enough that those tests run before any libvirt unit tests.
	* m4/Makefile.am: Remove file.  Not needed.
	* src/Makefile.am (INCLUDES): Add -I$(top_srcdir)/gnulib/lib
	-I../gnulib/lib.
	(LDADDS, libvirt_la_LIBADD): Add ../gnulib/lib/libgnu.la.
	* src/nodeinfo.c: Include "physmem.h".
	* qemud/qemud.c, src/remote_internal.c: Include "getaddrinfo.h".
	(MEMINFO_PATH, linuxNodeInfoMemPopulate): Remove definitions.
	(virNodeInfoPopulate): Use physmem_total, not linuxNodeInfoMemPopulate.
	* tests/Makefile.am (INCLUDES): Add -I$(top_srcdir)/gnulib/lib
	-I../gnulib/lib.
	(LDADDS): Add ../gnulib/lib/libgnu.la.
	* qemud/Makefile.am (libvirtd_LDADD): Add ../gnulib/lib/libgnu.la.
	* tests/nodeinfotest.c (linuxTestCompareFiles): No longer read total
	memory from a file.
	Update expected output not to include "Memory: NNNN"
	* tests/nodeinfodata/linux-nodeinfo-1.txt:
	* tests/nodeinfodata/linux-nodeinfo-2.txt:
	* tests/nodeinfodata/linux-nodeinfo-3.txt:
	* tests/nodeinfodata/linux-nodeinfo-4.txt:
	* tests/nodeinfodata/linux-nodeinfo-5.txt:
	* tests/nodeinfodata/linux-nodeinfo-6.txt:
	* src/test.c [WITH_TEST]: Remove definition of _GNU_SOURCE that
	would conflict with the one now in "config.h".
	* autogen.sh: Add -I gnulib/m4.
	* src/conf.c, src/sexpr.c: Don't define _GNU_SOURCE.
	Instead, include "config.h".
	* qemud/qemud.c: Remove definition of _GNU_SOURCE.
	* src/openvz_driver.c: Likewise.
	* src/qemu_driver.c: Likewise.
	* src/remote_internal.c: Likewise.

	* configure.in: Use AC_CONFIG_AUX_DIR(build-aux), so that a bunch
	of gettextize-generated files go into build-aux/, rather than in
	the top-level directory.
	* .cvsignore: Adjust.
	* build-aux/.cvsignore: New file.

Wed Dec  5 21:44:17 CET 2007 Daniel Veillard <veillard@redhat.com>

	* qemud/remote.c: rename remoteDispatchAuthPolkitInit to
	  remoteDispatchAuthPolkit, the no-op init call when policykit
	  is not available

Wed Dec  5 14:16:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Disable saslUsernameWhitelist config file
	handling if SASL is disabled. (Rich Jones)
	* src/remote_internal.c: Enable remoteDebug() API when SASL
	is disabled too

Wed Dec  5 14:16:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvir.html: Add page about authentication setup options
	* docs/libvirt.css: Make <pre> tag show scrollbars if content
	is too wide to fit
	* docs/*.html: Re-generated from libvir.html

Wed Dec  5 14:09:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: automatically disable Xen setuid proxy if
	PolicyKit is enabled
	* libvirt.spec.in: force disable of Xen setuid proxy for
	distros where PolicyKIt is enabled

Wed Dec  5 14:08:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* python/libvir.c, python/libvir.py: Add binding for the
	virConnectOpenAuth() API which generator can't handle

Wed Dec  5 13:55:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Re-added listen_tcp & listen_tls config
	param handling accidentally lost in earlier refactoring

Wed Dec  5 13:51:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* include/libvirt/libvirt.h.in: Add virConnectAuthPtrDefault
	as default CLI auth callback
	* src/libvirt_sym.version: Export virConnectAuthPtrDefault
	* src/libvirt.c: Default auth callback for command line based
	apps
	* src/virsh.c: Use default auth callback
	* src/internal.h: Add STRCASEEQLEN, STRCASENEQLEN
	* src/remote_internal.c: Wire up callback API to SASL interaction
	types / callbacks.

Wed Dec  5 13:27:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* Makefile.am: Put include/ before src/ in SUBDIRS
	* docs/*: updated for new public API
	* include/libvirt.h.in: Added virConnectOpenAuth and related
	definitions for authentication callbacks.
	* proxy/libvirt_proxy.c, src/openvz_driver.c, src/proxy_internal.c,
	src/qemu_driver.c, src/test.c, src/xen_internal.c, src/xen_unified.c,
	src/xend_internal.c, src/xend_internal.h, src/xm_internal.c,
	src/xm_internal.h, src/xs_internal.c, src/xs_internal.h,
	src/remote_internal.c: Update for new auth arg to the open API

Wed Dec  5 13:20:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: do PolicyKit checks via pkg-config
	* libvirt.spec.in: Add dep on PolicyKit if Fedora 8 or later
	* qemud/Makefile.am: Add PolicyKit build flags and default
	policy file
	* qemud/libvirtd.conf: Add comment about polkit auth option
	* qemud/libvirtd.policy: Default policy file
	* qemud/qemud.c, qemud/remote.c: Implementation of PolicyKit
	authentication
	* qemud/remote_protocol.x: Add RPC calls for PolicyKit auth
	* qemud/remote_dispatch*, qemud/remote_protocol.{c.h}: update
	for new RPC calls.
	* src/remote_internal.c: Fetch credentials for PolicyKit and
	perform client part of auth process

Wed Dec  5 18:00:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/Makefile.am, tests/Makefile.am: Remove LIBOBJS/LTLIBOBJS
	  which were incorrectly committed earlier.

Wed Dec  5 11:24:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: quit if initial conection attempt fails

Wed Dec  5 10:29:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Fix VPATH build for remote_generate_stubs.pl
	* qemud/internal.h: Add saslusername to client data & username
	whitelist to server data
	* qemud/libvirtd.conf: Add config param for whitelisting users.
	Remove config param for whitelisting IP addrs. Cleanup whitespace
	and syntax errors in default values
	* qemud/qemud.c, qemud/remote.c: Remove IP whitelisting. Add
	username whitelisting against SASL authenticated username.
	Makefile socket authentication schemes configurable.
	* qemud/remote_dispatch_prototypes.h, remote_generate_stubs.pl:
	Add a struct qemud_server * parameter to every dispatch function

Wed Dec  5 10:25:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c, qemud/qemud.c, qemud/internal.h,
	qemud/remote.c: Add support for SASL SSF layer providing
	data encryption of the connection post-authentication.

Wed Dec  5 10:20:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Add checks for SASL library
	* include/libvirt/virterror.h: Add VIR_ERR_AUTH_FAILED
	* libvirt.spec.in: Add deps on cyrus-sasl & md5 plugin
	and add SASL config file
	* qemud/Makefile.am: Add SASL config file & build flags
	* qemud/remote_protocol.x: new RPC calls for SASL
	* qemud/internal.h, qemud/qemud.c, qemud/remote.c: Server
	side of SASL authentication support
	* qemud/libvirtd.init.in, qemud/libvirtd.sysconf: Set
	KRB5_KTNAME to tell daemon where kerberos keytab lives
	* qemud/libvirtd.sasl: example SASL config file
	* src/Makefile.am, tests/Makefile.am: add SASL build flags
	* src/remote_internal.c: Add support for SASL auth client
	* src/virterror.c: Add VOIR_ERR_AUTH_FAILED string

Wed Dec  5 10:07:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Strip out NIC interfaces named vnetXXX since
	those are auto-generated names.

Wed Dec  5 13:48:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* python/libvir.c, python/libvirt_wrap.h, qemud/qemud.c,
	qemud/remote.c, src/internal.h, src/openvz_conf.c,
	src/openvz_driver.c, src/proxy_internal.h, src/qemu_conf.c,
	src/qemu_driver.c, src/remote_internal.h, src/test.h, src/util.c,
	src/xen_unified.c, src/xen_unified.h, tests/nodeinfotest.c,
	tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c, tests/reconnect.c,
	tests/sexpr2xmltest.c, tests/virshtest.c, tests/xencapstest.c,
	tests/xmconfigtest.c, tests/xml2sexprtest.c:
	Change #include <> to #include "" for local includes.
	Removed many includes from src/internal.h and put them in
	the C files which actually use them.
	Removed <ansidecl.h> - unused.
	Added a comment around __func__.
	Removed a clashing redefinition of VERSION symbol.
	All limits (PATH_MAX etc) now done in src/internal.h, so we
	don't need to include those headers in other files.

Tue Dec  4 18:25:01 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Fix configure if rpcgen program is missing.

Tue Dec  4 17:47:01 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: curses is not actually required to build libvirt
	* configure.in, src/virsh.c: Make readline optional.  If not
	  available then virsh is built without support for command
	  line editing.

Mon Dec  3 20:44:01 CET 2007 Jim Meyering <meyering@redhat.com>

	Avoid compile failure when HAVE_AVAHI is not defined.
	* qemud/qemud.c (remoteReadConfigFile): Remove some of the
	"#ifdef HAVE_AVAHI" guards around uses of mdns_name and mdns_adv.

Mon Dec  3 16:15:10 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/util.c: Fix header files for Windows builds.

Mon Dec  3  9:10:10 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: remove qemudMakeConfigPath, qemudEnsureDir,
	qemudReadFile,compareFileToNameSuffix, hasSuffix, checkLinkPointsTo
	* src/qemu_conf.h: remove qemudEnsureDir
	* src/qemu_driver.c: Update to use new API names
	* src/util.h, src/util.c: add virFileReadAll, virFileHasSuffix,
	virFileMatchsNameSuffix, virFileLinkPointsTo, virFileMakePath,
	virFileBuildPath

Mon Dec  3 10:32:10 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_unified.[ch] src/proxy_internal.c src/xen_internal.c
	  src/xend_internal.c src/xm_internal.c src/xs_internal.c:
	  cleanup the xen subdriver table, remove the type entry and
	  always return "Xen" from the unified entry point.

Sat Dec  1 10:42:34 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/hash.c: reset error object when releasing connection
	* src/iptables.c: don't strdup() param passed to strcmp()
	* src/qemu_driver.c: free TLS directory path in driver shutdown
	* src/remote_internal.c: don't strdup() params for virRaiseError
	* src/virsh.c: reset global error object at shutdown. Release
	connection state during abnormal shutdown

Sat Dec  1 10:22:34 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Fix off-by-1 buffer NULL termination in
	symlink comparison code

Fri Nov 30 17:50:34 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c, src/xml.h: Disable xen specific functions if
	Xen driver is disabled.
	* tests/xml2sexprtest.c: Disable if xen driver is disabled

Fri Nov 30 16:36:34 CET 2007 Jim Meyering <meyering@redhat.com>

	Detect heap allocation failure; factor out some duplication.
	* qemud/qemud.c (tls_port, tcp_port, mdns_name, tls_allowed_ip_list):
	  (tls_allowed_dn_list): Remove "const", now that we free these.
	  (unix_sock_rw_mask): Rename from unix_sock_rw_perms, so that
	  the latter name can be used as a local string variable, so that the
	  variable name matches the config attribute name.
	  (unix_sock_ro_mask): Rename from unix_sock_ro_perms, likewise.
	  (remoteCheckDN, remoteCheckAccess): Adapt to const removal.
	  (qemudDispatchServer): Check for heap allocation failure.
	  (remoteConfigGetStringList): New function, based on code from
	  Dan Berrangé.
	  (CHECK_TYPE): Remove macro.
	  (checkType): New function.
	  (GET_CONF_INT, GET_CONF_STR): New macros.
	  (remoteReadConfigFile): Use new macros to avoid duplication and to
	  check for allocation failure.
	* src/conf.h (virConfTypeName): New static inline function.

Fri Nov 30 11:04:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* python/libvir.c, python/libvir.py: Make Python aware that
	  the C bindings module is called cygvirtmod.dll when compiled
	  by CYGWIN.
	* python/Makefile.am: Remove symlink libvirtmod.dll -> cygvirtmod.dll
	  no longer necessary because of the above.
	* configure.in: Remove AM_CONDITIONAL(CYGWIN).

Thu Nov 29 17:40:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Added CYGWIN_EXTRA_LDFLAGS, CYGWIN_EXTRA_LIBADD,
	  CYGWIN_EXTRA_PYTHON_LIBADD, CYGWIN automake conditional.
	* src/Makefile.am: Extra flags required to build DLL of libvirt
	  for Cygwin.
	* python/Makefile.am: Extra flags and rule required to build
	  Python module for Cygwin.

Thu Nov 29 17:38:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Check for C compiler first before checking for
	  external programs.
	  Add AC_LIBTOOL_WIN32_DLL.
	  Add AM_PROG_CC_STDC.
	  Add AC_C_CONST.

Thu Nov 29 16:19:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html, docs/windows.html: Updated Windows
	  documentation now that we have shared libraries and Python
	  working.

Thu Nov 29 09:15:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: Added #include <time.h> so it can compile
	  on CentOS 4 (Carl Jones).

Wed Nov 28 14:20:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: Missing comma.

Wed Nov 28 14:21:47 CET 2007 Jim Meyering <meyering@redhat.com>

	* src/virsh.c (vshCloseLogFile): Diagnose close/write failure.

Wed Nov 28 09:00:00 GMT 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xm_internal.c, src/xm_internal.h: Added support for
	  pinning inactive domains for Xen 3.0.3 (Saori Fukuta).

Tue Nov 27 19:16:43 CET 2007 Jim Meyering <meyering@redhat.com>

	When reporting errors, use "conn" whenever possible.
	* src/remote_internal.c: change all error (NULL, ... to error (conn, ...
	  (check_cert_file): Add+use parameter, conn.
	  Adjust callers.
	  (initialise_gnutls): The "conn" parameter *is* used, so remove
	  ATTRIBUTE_UNUSED.

Tue Nov 27 16:40:29 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/site.xsl docs/libvir.html *.html: add boilerplate for
	  a Windows support page

Tue Nov 27 15:29:01 CET 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in: when configuring with --prefix=/usr i.e. the same
	  prefix as the installed libvirt, use the same localstatedir /var
	  (instead of /usr/var) and sysconfdir /etc (instead of /usr/etc) to
	  be able to connect to the system daemon, and use the system local
	  options
	* src/xs_internal.c: avoid error message when non-root cannot open
	  xenstore
	* src/xend_internal.c: avoid error message when non-root cannot
	  directly access xend, in those 2 cases the proxy (or remote code)
	  should implement the access so there is no need to raise the error
	  there.

Mon Nov 26 15:06:19 CET 2007 Daniel Veillard <veillard@redhat.com>

	* doc/*: modified the python page into a bindings page,
	  added the Ruby binding link to all pages

Mon Nov 26 12:12:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, src/console.c: Replace cfmakeraw if not in
	  standard library.

Mon Nov 26 12:03:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* tests/Makefile.am, tests/nodeinfotest.c, tests/qemuxml2argvtest.c,
	  tests/qemuxml2xmltest.c, tests/sexpr2xmltest.c, tests/virshtest.c,
	  tests/xencapstest.c, tests/xmconfigtest.c, tests/xml2sexprtest.c:
	  Miscellaneous fixes to the tests to compile under Cygwin.

Mon Nov 26 11:56:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/qemud.c: If AF_INET6 not defined, don't test for it.

Mon Nov 26 11:54:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/internal.h: Miscellaneous header file fixes to allow
	  libvirtd to build under Cygwin.

Mon Nov 26 11:52:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, proxy/Makefile.am: Disable building of the Xen proxy
	  if configured --without-xen.

Mon Nov 26 11:49:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/bridge.c, src/bridge.h, src/qemu_conf.c, src/qemu_conf.h,
	  src/qemu_driver.c, src/qemu_driver.h, src/test.c: Disable more
	  of qemu if configured --without-qemu.

Mon Nov 26 11:47:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Miscellaneous header file fixes for
	  Cygwin.

Mon Nov 26 11:44:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, qemud/Makefile.am: Check for buggy glibc rpcgen
	  and only run Perl fix-up script for that.

Mon Nov 26 11:42:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Check if -lrpc is needed to get XDR functions.

Mon Nov 26 11:39:59 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, src/internal.h, src/xml.c: <sys/syslimits.h>
	  is needed on Cygwin to get PATH_MAX.  HOST_NAME_MAX and
	  IF_NAMESIZE defined if not in header files.

Mon Nov 26 11:39:04 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Minimum version of GnuTLS we support is 1.0.25.

Thu Nov 22 00:14:04 CET 2007 Jim Meyering <meyering@redhat.com>

	Fix a typo in a variable name.
	* qemud/qemud.c: Check crl_file, not ca_file, for revocation list,
	  in remoteInitializeGnuTLS.

Wed Nov 21 17:29:42 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c: fix the parsing of predefined domains on
	  xen prior to 3.1 to take into accound the fact that disk can
	  be shareable.

Wed Nov 21 11:59:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html, docs/site.xsl: Fix the link to OCaml
	  bindings.

Wed Nov 21 11:36:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/bridge.c, src/qemu_driver.c: Incorrect call to
	  brSetForwardDelay changed to brSetEnableSTP.

Wed Nov 21 11:36:43 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/index.html docs/libvir.html: apply english corrections
	  suggested by Bruce Montague

Tue Nov 20 10:49:28 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virterror.c, src/stats_linux.c, include/libvirt/virterror.h:
	  Renamed the VIR_FROM_LINUX error as VIR_FROM_STATS_LINUX for
	  consistency.

Tue Nov 20 11:06:28 CET 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/virterror.h src/openvz_conf.c src/openvz_driver.c
	  src/stats_linux.c src/virterror.c src/xm_internal.c: patch from
	  Saori Fukuta cleaning up various problems in the error reporting
	  layers

Tue Nov 20 11:03:02 CET 2007 Daniel Veillard <veillard@redhat.com>

	* tests/sexpr2xmltest.c tests/xml2sexprtest.c: warn before exiting
	  if the path environment variable is missing, add the tests for
	  <shareable/> from/to w! ode for disk
	* tests/sexpr2xmldata/sexpr2xml-disk-block-shareable.sexpr
	  tests/sexpr2xmldata/sexpr2xml-disk-block-shareable.xml
	  tests/xml2sexprdata/xml2sexpr-disk-block-shareable.sexpr
	  tests/xml2sexprdata/xml2sexpr-disk-block-shareable.xml:
	  the new tests data

Sun Nov 18 11:24:33 UTC 2007 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am: Re-add quotes around top_{src,build}dir
	variables

Sat Nov 17 13:05:33 UTC 2007 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am: Set abs_top_{build,src}dir based on 'pwd'
	since older automake does not provide these vars

Sat Nov 17 12:10:33 UTC 2007 Daniel P. Berrange <berrange@redhat.com>

	* docs/Makefile.am: Added missing news.xsl to EXTRA_DIST

Sat Nov 17 11:55:33 UTC 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/stats_linux.c: Fixed overflow of left shift on 32-bit platforms

Sat Nov 17 11:04:33 UTC 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Remove protocol.[chx] from EXTRA_DIST.
	  Remove protocol.h and protocol.c from libvirtd_SOURCES.
	  Remove protocol.c dependency.
	* qemud/protocol.c, qemud/protocol.h, qemud/protocol.x: Remove files.
	* qemud/internal.h: Don't include "protocol.h".
	* qemud/qemud.c: Clean up qemudDispatchClientRead.
	s/QEMUD_PKT_HEADER_XDR_LEN/REMOTE_MESSAGE_HEADER_XDR_LEN/
	* qemud/remote.c: In remoteDispatchClientRequest, reflect that the
	client buffer no longer starts with the 4-byte XDR header length.
	* qemud/remote_protocol.h: Regenerate.
	* qemud/remote_protocol.x: Define REMOTE_MESSAGE_HEADER_XDR_LEN.
	* src/Makefile.am: Remove protocol.h, protocol.c from SERVER_SOURCES.

Thu Nov 15 17:43:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/stats_linux.c: Fix parsing of short interface names
	  occurring in the /proc/net/dev file.
	* src/qemu_driver.c: Collect interface stats for QEMU & KVM
	  domains.

Thu Nov 15 17:40:15 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/hvsupport.html, docs/libvir.html: Document HV support
	  for virNodeGetFreeMemory and virNodeGetCellsFreeMemory.
	* src/libvirt.c: Add DEBUG to virNodeGetFreeMemory and
	  virNodeGetCellsFreeMemory.
	* src/xen_internal.c: virXenError* functions now take an
	  additional virConnectPtr argument, and set it where possible.

Thu Nov 15 18:06:15 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html docs/uri.html: update docs about the libvirt
	  daemon startup when using QEmu/KVM.

Thu Nov 15 14:00:04 CET 2007 Jim Meyering <meyering@redhat.com>

	Make "make distcheck" work.
	* Makefile.am: Expand some "*" wildcards, and (for now) disable
	  the relatively unimportant, distuninstallcheck target.
	  Fix a few redirect-directly-to-target bugs.
	  Add a few $(srcdir)/ prefixes and add an uninstall-local rule.
	* docs/Makefile.am: More of the same.  Split some long lines.
	* python/Makefile.am: Likewise.
	* python/tests/Makefile.am: Likewise.
	* qemud/Makefile.am: Likewise.
	* tests/Makefile.am: Remove the directories already listed in SUBDIRS.
	* docs/examples/index.py: Adapt to produce the desired changes in
	  docs/examples/Makefile.am. Also, sort *.c, so results are reproducible,
	  and emit a comment telling emacs and vi that the file is read-only.
	* docs/examples/Makefile.am: Regenerate.

Thu Nov 15 11:54:40 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/stats_linux.c: patch from Jim Paris to fix compilation
	  when Xen isn't installed
	* src/qemu_conf.h: small cleanup of signedness of bitfields
	  from Jim Paris

Wed Nov 14 18:09:31 CET 2007 Daniel Veillard <veillard@redhat.com>

	* doc/libvir.html doc/format.html: add missing docs for
	  <shareable/> on disk devices
	* src/Makefile.am: fix the tst build rule for missing libraries

Wed Nov 14 17:28:31 CET 2007 Jim Meyering <meyering@redhat.com>

	Handle failed strdup and malloc.
	* src/remote_internal.c: Don't dereference NULL after
	failed strdup or malloc in doRemoteOpen.

Wed Nov 14 11:55:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/stats_linux.c, src/stats_linux.h, src_xen_internal.c:
	  Abstract out the Linux-specific statistics.  Fixed parsing
	  of 64 bit numbers.
	* src/Makefile.am: Updated Makefile for new files.

Wed Nov 14 11:36:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c and all internal driver interfaces: Parse the
	  URI only once and pass it to virDrvOpen instead of the
	  unparsed name string.

Wed Nov 14 11:34:35 CET 2007 Jim Meyering <meyering@redhat.com>

	Parse integers more carefully, cont'd.
	* qemud/qemud.c: Replace uses of strtol with uses of xstrtol_i.
	  Avoid overflow for very large --timeout=N values.
	* src/nodeinfo.c: In linuxNodeInfoMemPopulate and
	  linuxNodeInfoCPUPopulate, use xstrtol_i rather than strtol.
	  Unlike in qemud.c, here we allow trailing "isspace", and in
	  the case of "cpuinfo cpu MHz", also allow a "." terminator,
	  since we ignore the decimal and any following digits.
	* src/internal.h: Define xstrtol_ui, too.

	Arrange for tests to pass in a non-srcdir build.
	* tests/Makefile.am: Include the contents of the *data directories
	  in the make-dist-built tarball by adding each of that *data
	  directories to EXTRA_DIST.
	  Also add int-overflow (via $(test_scripts)) to EXTRA_DIST.
	* tests/nodeinfotest.c: Prepend "$abs_top_srcdir/tests" to
	  each input file name.
	* tests/qemuxml2argvtest.c: Likewise.
	* tests/qemuxml2xmltest.c: Likewise.
	* tests/sexpr2xmltest.c: Likewise.
	* tests/test_conf.sh: Likewise.
	* tests/virshtest.c: Likewise.
	* tests/xencapstest.c: Likewise.
	* tests/xmconfigtest.c: Likewise.
	* tests/xml2sexprtest.c: Likewise.

Tue Nov 13 15:33:35 CET 2007 Jim Meyering <meyering@redhat.com>

	Make qemud's install-init rule work in a non-srcdir build.
	* qemud/Makefile.am: In the install-init, remove an unneeded
	$(srcdir)/ prefix.

Mon Nov 12 23:11:35 CET 2007 Jim Meyering <meyering@redhat.com>

	conftest: fix transposed size and count arguments to fwrite.
	* tests/conftest.c: Include <string.h> and <errno.h>.
	  Also include strerror in diagnostic.

Mon Nov 12 14:56:33 CET 2007 Daniel Veillard <veillard@redhat.com>

	Begin fixing uses of strtol: parse integers more carefully.
	Patch from Jim Meyering
	* src/internal.h: Include <errno.h>.
	  Define new static inline function, xstrtol_i.
	* src/virsh.c: Detect integer overflow in domain ID number
	  in vshCommandOptDomainBy. Detect overflow and invalid port
	  number suffix in cmdVNCDisplay.
	* src/xend_internal.c: Parse CPU number more carefully in
	  xenDaemonDomainGetVcpus.
	* tests/int-overflow: New script. Test for the above-fixed bug.
	* tests/Makefile.am: Add int-overflow to TESTS. Define
	  TESTS_ENVIRONMENT, to propagate $abs_top_* variables into the
	  int-overflow script. Adapt the "valgrind" rule not to clobber
	  new TESTS_ENVIRONMENT.

Thu Nov  8 19:06:13 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: initialize a couple of variable to avoid warnings
	  when compiling with Fedora.

Thu Nov  8 18:59:39 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Jim Meyering to use gcc's printf attribute.

Thu Nov  8 17:06:50 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Jim Meyering to correct vshCommandOptInt
	  indentation

Wed Nov  7 14:38:43 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html docs/site.xsl: small updates with references
	  to CIM and OpenVZ
	* po/*: updated translations

Tue Nov 6 19:54:00 CET 2007 Jim Meyering  <meyering@redhat.com>

	Avoid risk of format string abuse (also avoids gcc warnings).
	* src/util.c (ReportError): Use a literal "%s" format string.
	* src/remote_internal.c (server_error): Likewise.
	* src/qemu_conf.c (qemudReportError): Likewise.
	* acinclude.m4: Add -Wformat -Wformat-security to default
	  list of warning flags, to warn about errors such as the
	  above.

Tue Nov  6 17:24:16 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xs_internals.c: patch from Chris Lalancette, forgot to
	  remove the domainDumpXML entry when changing the driver structure

Tue Nov  6 12:42:55 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c src/xs_internal.c src/xs_internal.h: applied patch
	  from Masayuki Sunou to fix xend errors when adding disk
	  devices, due to improper device id lookup.

Tue Nov  6 10:40:13 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Masayuki Sunou to fix parameter
	  validation of virsh schedinfo parameters.

Mon Nov  5 11:11:45 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: patch from Beth Kon to fix a problem when the
	  cpuset parameter for numa uses cpu maxcpu-1

Thu Nov  1 14:32:07 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c: patches from Masayuki Sunou to fix a problem
	  when an HVM domain is started with a CD-Rom config, this should
	  fix #328841

Wed Oct 31 10:36:00 CET 2007 Daniel Veillard <veillard@redhat.com>

	* proxy/libvirt_proxy.c src/proxy_internal.[ch] src/xen_internal.c
	  src/xen_unified.[ch] src/xend_internal.[ch] src/xml.[ch]: last
	  patch for the library NUMA support, allow to serialize CPU pinning
	  to domain configs (but won't work though proxy access), includes
	  many patches from Saori Fukuta.

Fri Oct 26 21:20:44 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Don't call state driver API if callback is NULL.
	* src/remote_internal.c: Reject open attempts if inside the daemon
	to avoid recursively calling self.

Fri Oct 26 21:18:44 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Support CDROM media change for KVM/QEMU

Fri Oct 26 21:17:44 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Refactor shell ecscaping function to reuse
	for monitor escaping

Fri Oct 26 21:14:44 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.h, src/qemu_conf.c: Refactor device parsing code

Fri Oct 26 21:10:44 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: make qemudMonitorCommand responsible for
	adding appropriate line ending instead of the caller

Fri Oct 26 15:40:44 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: fix build when configured without Xen

Wed Oct 24 16:21:02 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: applied patch from Jim Meyering fixing parseNumber
	  to detect overflow, and also reindented the module.

Wed Oct 24 10:38:38 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* po/id.po: Remove again bogus Project-Id-Version field from merge error

Tue Oct 23 17:44:12 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* po/*: updated from translation team

Tue Oct 23 17:30:52 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: fix the build of the proxy broken on previous commit

Mon Oct 22 22:33:59 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c src/xen_unified.c src/xen_unified.h
	  src/xend_internal.c src/xml.c src/xml.h: commited erronously
	  the NUMA patches sent for review on the list in last commit.
	  But that should not affect non NUMA users so early push should
	  not be a problem.

Mon Oct 22 22:27:40 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/format.html docs/libvir.html: documentation cleaups
	  from Jim Paris

Mon Oct 22 15:05:30 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: update to cpuset parsing code for NUMA

Fri Oct 19 17:08:08 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am: fix tst build rule
	* src/buf.c: fix virBufferContentAndFree to make sure the string is
	  always 0 terminated.

Fri Oct 19 11:59:39 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/conf.c: fix bug on negative values in virConfParseLong()
	  raised by Tatsuro Enokura

Fri Oct 19 10:24:52 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/conf.c: documentation cleanups from Jim Meyering
	* tests/conftest.c: Use fwrite, not printf, since the
	  result buffer is not NUL-terminated.
	* tests/qemuxml2argvtest.c: Initialize vm.migrateFrom[0],
	  to avoid "read-uninitialized" error from within
	  qemudBuildCommandLine.

Wed Oct 17 11:27:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* libvirt.spec.in (BuildRequires): Add "qemu" (Jim Meyering).

Wed Oct 17 11:27:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xend_internal.c (sexpr_get): Declare with gcc's printf
	attribute. (Jim Meyering)

Mon Oct 15 17:35:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/driver.h, src/libvirt.c, include/libvirt/libvirt.h.in,
	include/libvirt/libvirt.h, src/xen_unified.c, src/xend_internal.c,
	src/xml.c, src/xml.h: Mark XML param for attach/detach APIs 'const'

Mon Oct 15 15:31:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/test.c, include/libvirt/libvirt.h.in: Remove virDomainRestart
	from the public API (it was not used), and move it into the test
	driver where it is used for purely internal purposes.

Fri Oct 12 14:57:53 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu.conf, src/Makefile.am: Added example config file
	for QEMU driver
	* qemud/libvirtd.conf, qemud/Makefile.am: Added example config
	file for libvirt daemon
	* libvirt.spec.in: Added libvirtd.conf & qemud.conf files

Fri Oct 12 12:05:53 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c, src/qemu_conf.c, src/qemu_conf.h: Add a
	/etc/libvirt/qemu.conf for storing system wide QEMU driver
	default settings, such as VNC server options.

Wed Oct 10 15:44:53 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Reset migration source after failed attempt
	to start a VM. (Jim Paris)

Wed Oct 10 13:48:53 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Fixed procesing of vncunused, and vncdisplay
	parameters in XM style config files for framebuffer config.

Wed Oct 10 13:13:53 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Fix XML -> XM config file conversion to
	include bridge name for virtual networks
	* src/xml.c: Fix memory leak handling XML -> SEXPR conversion
	of virtual network bridge devices

Mon Oct  8 17:01:53 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Beth Kon to fix
	  NUMA topology for cells without CPUs

Thu Oct  4 21:05:59 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fix error handling for NUMA topology
	(patch from Beth Kon)

Wed Oct  3 10:13:59 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* po/id.po: Remove bogus Project-Id-Version field from merge error

Sun Sep 30 23:07:59 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in include/libvirt/libvirt.h docs/*:
	  preparing release of 0.3.3
	* po/*: updated the strings localizations

Sun Sep 30 22:51:11 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* python/generator.py python/libvir.c python/libvirt-python-api.xml:
	  provide bindings for block and interface statistics

Sun Sep 30 12:27:36 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Don't include <bootloader/> for HVM guests
	* tests/sexpr2xmldata/sexpr2xml-no-source-cdrom.xml: revert previous
	change since HVM doesn't use bootloaders

Sun Sep 30 15:20:36 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: use virNodeGetFreeMemory() for freecell without
	  argument
	* src/libvirt_sym.version: export virNodeGetFreeMemory()

Sun Sep 30 14:49:27 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/driver.h src/libvirt.c src/openvz_driver.c src/qemu_driver.c
	  src/test.c src/xen_unified.c src/xend_internal.c: add new API
	  virNodeGetFreeMemory(), extends the driver. Lacks remote and
	  QEmu support though.
	* src/libvirt.c: allows to fix virNodeGetCellsFreeMemory() adding
	  parameter check for startCell.
	* proxy/libvirt_proxy.c src/xend_internal.[ch]
	  include/libvirt/libvirt.h include/libvirt/libvirt.h.in: applied
	  vncpasswd dump patch from Mark Johnson but with the
	  virDomainXMLFlags extension as suggested by Daniel Berrange
	  this changed a couple of internal APIs too
	* tests/sexpr2xmldata/sexpr2xml-no-source-cdrom.xml: fix one of the
	  tests affected by bootloader dump change.

Sat Sep 29 14:30:41 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c, src/xs_internal.c: Solaris hypercall compat
	changes. (Mark Johnson)

Sat Sep 29 14:23:41 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/sexpr.h, src/sexpr.c, src/xml.c, src/xend_internal.c: Allow
	bootloader tag to be empty, to indicate use of default configured
	bootloader path.

Sat Sep 29 14:05:41 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/sexpr.h, src/sexpr.c, src/virsh.c, src/xend_internal.c:
	Remove use of anonymous union members in sexpr code.
	* src/internal.h: Solaris portability fix (Mark Johnson)

Fri Sep 28 16:41:41 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Fix crash processing multiple <input> tags

Fri Sep 28 16:17:41 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h[.in] src/driver.h src/openvz_driver.c
	  src/qemu_driver.c src/remote_internal.c src/test.c
	  src/xen_internal.[ch] src/xen_unified.c src/xend_internal.[ch]
	  src/libvirt.c src/libvirt_sym.version: adding NUMA support patches
	  from Beth Kon adding new virNodeGetCellsFreeMemory entry point
	  and extending the virConnectGetCapabilities one. Fix a couple of
	  issues in the patch and add to exported symbols from shared lib.
	* docs/virsh.pod docs/virsh.1 src/virsh.c: added new command
	  freecell to get the available memory on the node or in a NUMA cell.
	* docs/*: updated and regenerated the documentation

Fri Sep 28 11:20:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html: Clarified configuration required for
	remote over ssh.

Tue Sep 25 14:45:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Fix handling of usernames (thanks to
	Fabian Deutsch for finding and fixing this).

Fri Sep 21 17:14:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h: Detect QEMU flags per-VM,
	not per driver, since different QEMU binaries have their own
	requirements.
	* tests/qemuxml2xmltest.c, tests/qemuxml2argvtets.c: Update
	to changed internal QEMU api/structs.

Fri Sep 21 16:22:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Add a no_tty flag to stop SSH prompting
	for passwords on console
	* docs/libvir.html, docs/remote.html: Document no_tty flag

Fri Sep 21 15:06:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* acinclude.m4: Check all compiler flags link successfully
	instead of just compiling, to deal with broken debian linker
	with stack protector
	* configure.in: Remove redundant -fno-stack-protector workaround

Fri Sep 21 15:06:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Use libxml for parsing & checking URIs

Thu Sep 20 19:37:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/bridge.c, src/qemu_driver.c, configure.in: Try to detect
	the paths of dnsmasq and brctl at compile time.  If found
	then compile them in, otherwise search $PATH at runtime.

	* libvirt.spec.in: BR dnsmasq and bridge-utils so we have their
	paths at compile time.

Thu Sep 20 18:10:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/qemu_driver.c, docs/libvir.html: Support virConnectGetHostname
	and virConnectGetURI for qemu driver.

Thu Sep 20 13:02:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c: Don't try to generate an error message with
	an invalid connection object.

Thu Sep 20 12:59:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xend_internal.c: Error message if we cannot connect
	to xend.

Wed Sep 19 17:42:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix waitpid() call to only be done
	in doRemoteOpen error case (merge error from previous commit)

Wed Sep 19 13:39:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Use pkg-config to locate gnutls if pkg-config
	is available. Add $(GNUTLS_LIBS) $(GNUTLS_CFLAGS) to all the
	relevant make targets

Wed Sep 19 09:48:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Make sure we use pkg-config for libxml, where
	available. Fix newline termination for messages printed with
	xml-config checks

Tue Sep 18 22:22:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Allow customization of UNIX socket permissions
	and group ownership from config file
	* docs/libvir.html: Added docs on UNIX socket perms & group owner
	config parameters

Tue Sep 18 21:34:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Added checks for locating Avahi.
	* qemud/mdns.c, qemud/mdns.h, qemud/Makefile.am: Convenience API to
	bridge between state machine provided by Avahi APIs, and the libvirt
	daemon.
	* qemud/qemud.c, qemud/internal.h: Register the daemon as an mDNS
	service under _libvirt._tcp.
	* docs/libvir.html: Added notes on mdns config params.
	* libvirt.spec.in: Added avahi-devel as a BuildRequires

Tue Sep 18 20:42:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/event.h, src/event.c: Added new APIs definitions for updating
	of existing timers and file handlers
	* qemud/event.h, qemud/event.c, qemud/qemud.c: Added implementation
	of APIs for updating existing timers and file handlers. Allow a
	timeout frequency of 0. Allow frequency of -1 to indicate a disabled
	timer. Prefix all log messages with EVENT:

Tue Sep 18 19:42:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Re-arrange to use new style AC_INIT/AM_INIT_AUTOMAKE
	style calls. Pass -Wno-portability flag to automake to keep quiet about
	GNUmake-isms

Tue Sep 18 19:36:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Don't check for Linux bridge headers if QEMU
	driver is disabled

Tue Sep 18 19:32:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* configure.in: Print out summary of configuration options

Mon Sep 17 23:04:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Track child pid and do waitpid to clean
	up zombies if running over a tunnel

Thu Sep 13 17:58:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Fix handling of <boot> tag for network PXE
	* tests/qemuxml2argvdata/qemuxml2argv-boot-network.xml: Fix test
	for network PXE boot element
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Fixed potential
	SEGV crash in error case cleanup

Wed Sep 12 16:35:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xend_internal.c, src/xml.c, src/xml.h: Properly check buffer
	size in virDomainXMLDevID (Hugh Brock).

Wed Sep 12 11:30:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xend_internal.c, src/xen_unified.c: Removed an annoying
	  warning when using Xen 3.0.3 and inactive domains.

Wed Sep 12 11:25:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: virDrvOpenRemoteFlags was accidentally
	  declared as a global variable, instead of the name an enum.

Mon Sep 10 17:15:29 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/architecture.html docs/errors.html docs/format.html
	  docs/libvir.html: fixing typos spotted by Eduardo Pereira

Mon Sep 10 13:46:05 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Hugh Brock to allow
	  CD Rom device reload by reusing virDomainAttachDevice() with
	  a new definition

Mon Sep 10 11:35:06 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/libvirt.c: fixes a few problems in the documentation
	  pointed out by Toth Istvan.
	* docs/*: regenerated the docs

Wed Sep  5 16:31:00 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html docs/uri.html: remove references to libvirt_qemud
	  and replace them with libvirtd

Mon Sep  3 18:29:05 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_conf.h src/openvz_driver.c: a bit
	  of cleanup on top of previous patches.

Mon Sep  3 17:35:15 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/openvz_conf.h src/openvz_driver.c
	  src/openvz_driver.h: Applied patch from Shuveb Hussain and Anoop
	  Cyriac to extent OpenVZ driver capabilities, especially Create().

Thu Aug 30 15:11:44 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/buf.c: applied patch from Masayuki Sunou fixing a loop
	  due to an error in growing buffers.

Wed Aug 29 14:43:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xen_internal.c (xenHypervisorDomainInterfaceStats): Swap
	  TX & RX network stats so they appear correct from the point
	  of view of the domain.

Wed Aug 29 09:46:17 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: apply patch from Masayuki Sunou to fix the exit value
	  of vncdisplay command.

Mon Aug 27 11:16:48 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Masayuki Sunou to avoid
	  memory corruption on very large XML dumps.

Tue Aug 21 16:48:41 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in include/libvirt/libvirt.h docs/*:
	  preparing release of 0.3.2
	* src/libvirt.c: fix a couple of comments
	* po/*: string localization merge/update

Tue Aug 21 13:52:29 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xs_internal.c: cleanup of memory leaks from Masayuki Sunou
	* src/virsh.c: another memory leaks of virsh schedinfo cleanup from
	  Saori Fukuta
	* po/*: string localization merge/update

Tue Aug 21 10:58:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c (virDomainBlockStats, virDomainInterfaceStats):
	  Added block device and network interface statistics.
	* src/xen_internal.c: Support for stats from Xen domains.
	* qemud/remote.c, qemud/remote_protocol.x, qemud/remote_internal.c:
	  Support for fetching device and network interface stats
	  across remote connections.
	* src/virsh.c: Added 'virsh domblkstat' and 'virsh domifstat'
	  commands to display stats.
	* docs/libvir.html, docs/hvsupport.html: Updated hvsupport
	  documentation.

Tue Aug 21 10:36:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* tests/xencapsdata/*.xml: Fixed tests to include new
	  <migration_features> element in capabilities XML.

Tue Aug 21 10:21:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c (virDomainMigrate): Added virDomainMigrate
	  API call.
	* src/xend_internal.c, src/xen_unified.c: Support for migration
	  of Xen domains.
	* src/xen_internal.c: Xen capabilities indicates level of
	  support for migration.
	* qemud/remote.c, qemud/remote_protocol.x, src/remote_internal.c:
	  Support for migration between remote hypervisors.
	* src/virsh.c: Added 'virsh migrate' command.
	* docs/libvir.html, docs/hvsupport.html: Updated hvsupport
	  documentation.

Tue Aug 21 09:56:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/remote.c, qemud/remote_protocol.x, src/driver.h,
	  src/internal.h, src/libvirt.c, src/libvirt_sym.version,
	  src/qemu_driver.c, src/remote_internal.c, src/test.c:
	  Add a private interface so that libvirt.c coordination
	  functions can detect the availability of features in
	  underlying drivers, using the VIR_DRV_SUPPORTS_FEATURE
	  macro.

Tue Aug 21 09:45:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xend_internal.c: Return the interface device name as
	  <target dev='vifX.Y'/> in domain XML.
	* tests/*: Update XML in regression tests.

Tue Aug 21 09:07:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html: Updated the hvsupport page to show that
	  KVM now supports save and restore operations.

Thu Aug 16 17:41:22 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: patch from Masayuki Sunou to avoid
	  attach-disk/attach-interface when < Xen 3.0.4

Thu Aug 16 15:24:30 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: vshCommandOptInt was broken as it would not
	  detect non-int inputs, problem raised by Masayuki Sunou

Wed Aug 15 12:21:13 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fixed 2 small bugs in setvcpus command, after
	  Atsushi SAKAI pointed out a value checking problem

Tue Aug 14 14:32:51 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/proxy_internal.c: fix the UUID lookup though proxy, by
	  actually sending the UUID string in the request!

Tue Aug 14 09:10:51 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Atsushi SAKAI fixing schedinfo synopsis

Tue Aug 14 09:04:41 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* virsh.1 docs/virsh.pod: typo fixes from Atsushi SAKAI

Tue Aug 14 07:59:21 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/apibuild.py: fix the API generator to work out of a
	  include list instead of an exclude list
	* po/*: updated localization strings

Mon Aug 13 21:46:48 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Implement save & restore APIs for KVM
	guests using the migrate protocol. Patch from Jim Paris

Mon Aug 13 21:33:48 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: added qemudEscapeShellArg() helper function
	for future save impl. Patch from Jim Paris
	* src/util.c, src/util.h: Added saferead/safewrite convenience
	functions for doing read/write safe from signals. Patch from
	Jim Paris

Mon Aug 13 21:26:48 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Add support
	for passing -incoming option to QEMU for migration/restore. Patch
	from Jim Paris

Mon Aug 13 21:18:48 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/util.h, src/util.c: Allow a file descriptor to be supplied
	for STDIN when calling virExec(), or if -1, redirect from /dev/null
	* src/qemu_driver.c, src/openvz_driver.c: Pass in -1 for new stdin
	parameter above where neccessary. Patch from Jim Paris

Mon Aug 13 20:13:48 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Use \r instead of \n for monitor commands to
	avoid bug where QEMU \n gets translated to \r\n,then causing QEMU
	to process the command twice. Patch from Jim Paris.

Mon Aug 13 11:55:48 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/qemu_driver.c: patch from Jim Paris removing memory leak
	* AUTHORS: updated with Shuveb and Jim

Fri Aug 10 14:25:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c, src/xen_internal.h, src/xen_unified.c:
	Add impls of the DomainGetOSType, DomainLookupByID and
	DomainLookupByName drivers using the HV for speed
	* src/xs_internal.c, src/xs_internal.h: Add helper method to
	lookup a domain name based on its ID

Thu Aug  9 14:27:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c, src/openvz_conf.c, src/qemu_conf.c,
	src/test.c, src/xm_internal.c, src/xend_internal.c: Use
	virUUIDFormat() / virUUIDGenerate / virUUIDParse apis.
	* qemu/internal.h: Remove unused UUID_LEN constants
	* src/openvz_conf.h, src/qemu_conf.h: Remove duplicated
	UUID length constants
	* src/xml.c, src/xml.h: Remove virParseUUID api
	* src/uuid.h, src/uuid.c: Add virUUIDFormat() api.
	* proxy/Makefile.am: Include uuid.o

Tue Aug  7 16:35:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/Makefile.am: gnutls_1_0_compat.h to list of sources
	  (bug reported by Jan Michael).

Tue Aug  7 16:24:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: Include <time.h> (bug reported by Jan Michael).

Tue Aug  7 15:28:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Fix build bug introduced by earlier
	  patch.

Tue Aug  7 14:18:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/qemud.c: Fix --config/-f option to libvirtd.

Tue Aug  7 13:58:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* acinclude.m4, configure.in: ./configure option
	  --disable-stack-protector.
	* src/gnutls_1_0_compat.h: Compatibility with GnuTLS 1.0.
	* src/bridge.c: If no bridge ioctls, give an error at runtime.

Thu Aug  2 12:49:08 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: changes from Masayuki Sunou to improve error reporting
	  on device XML errors.

Tue Jul 31 10:24:23 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/xml.c, tests/qemuxml2argvtest.c,
	tests/qemuxml2xmltest.c: Fix a couple of memory leaks

Mon Jul 30 14:40:23 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Validate requested architecture and reject
	unsupported ones

Mon Jul 30 12:15:43 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: add report of ACPI/APIC for Xen fully virt,
	  patch from David Lutterkort
	* tests/xencapsdata/xen-i686-pae-hvm.xml
	  tests/xencapsdata/xen-ia64-be-hvm.xml
	  tests/xencapsdata/xen-ia64-hvm.xml
	  tests/xencapsdata/xen-x86_64-hvm.xml: this also affects a few tests

Mon Jul 30 11:59:51 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/qemu_conf.[ch] src/qemu_driver.c: add qemu/kvm drivers report
	  ACPI/APIC features for i686 and x86_64, patch from David Lutterkort

Fri Jul 27 19:19:31 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Added impl of networking APIs. Cleanup all other
	existing APIs. Add missing domain APIs.
	* src/remote_internal.c: Remove hack for network APIs + test
	driver now it has its own impl
	* src/libvirt.c, src/driver.h, src/qemu_driver.c: Added a
	'name' field to network driver
	* docs/testnode.xml, docs/testnetdef.xml, docs/testnetpriv.xml:
	Added example XML for network APIs

Thu Jul 26 10:37:31 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c docs/virsh.pod virsh.1: added a ttyconsole command,
	  this should fix bug #239687

Wed Jul 25 19:16:43 EST 2007 Daniel P. berrange <berrange@redhat.com>

	* scripts/coverage-report.pl: Ignore data from inlined macros
	in /usr/include files

Wed Jul 25 19:13:43 EST 2007 Daniel P. berrange <berrange@redhat.com>

	* src/nodeinfo.h, src/nodeinfo.c: Generic impl of virNodeGetInfo
	* src/qemu_driver.c, src/openvz_driver: Switch to generic impl
	of virNodeGetInfo
	* src/internal.h: Add STREQLEN STRNEQLEN
	* src/Makefile.am: Add nodeinfo.{c,h}
	* docs/apibuild.py: Ignore nodeinfo files
	* tests/nodeinfotest.c, tests/Makefile.am: Test case for the
	nodeinfo.c APIs
	* tests/nodeinfodata/*: Data files for the test suite

Tue Jul 24 17:32:23 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in NEWS docs/* po/*: preparing release 0.3.1
	* src/libvirt.c python/generator.py: some cleanup and warnings
	  from Richard W.M. Jones

Tue Jul 24 10:29:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h: Added support for the VNC
	'listen' parameter in XML. Move -nographics flag to start of
	command line to avoid issues with QEMU default monitor settings.
	* tests/qemuxml2argvtest.c, tests/qemuxml2xmltest.c: Re-enable
	VNC & SDL tests now they are working correctly
	* tests/qemudxml2argvdata/*.args: Move -nographics arg to new
	location due to qemu_conf.c changes

Tue Jul 24 10:24:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Fixed crash when cleaning up after failed
	attempt to start a VM.

Tue Jul 24 10:20:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/remote.c: Always immediately free virDomainPtr objects
	to avoid them hanging around cached until client exits

Tue Jul 24 11:18:11 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/network.rng docs/Makefile.am libvirt.spec.in: added Relax-NG
	  grammar for network descriptions that David Lutterkort posted in
	  April, it needs an update though

Tue Jul 24 10:15:33 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* po/*: update translations and regenerate .pot

Mon Jul 23 13:59:12 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: keep monitor filehandle open, and set
	close-on-exec flag for logfiles.

Mon Jul 23 11:36:12 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/virsh.pod virsh.1: update to document VIRSH_DEFAULT_CONNECT_URI
	  environment variable as suggested by David Lutterkort

Fri Jul 20 12:53:35 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: and nother one again from Saori Fukuta

Fri Jul 20 11:02:28 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: some error handling improvements from Saori Fukuta

Thu Jul 19 18:21:47 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/openvz_conf.c src/openvz_conf.h
	  src/openvz_driver.c src/qemu_driver.c src/util.c src/util.h:
	  cleanup patches from Shuveb Hussain, with new util module for
	  common code shared between drivers.

Thu Jul 19 16:35:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, src/xen_internal.c: Newer Xen uses
	  <xen/sys/privcmd.h>.  Added detection code for this in
	  configure.in.

Thu Jul 19 15:38:44 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: rewrite of range check in credit scheduler
	  initially suggested by Atsushi SAKAI

Wed Jul 18 17:45:08 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c: Remove double free of XML property upon
	error cleanup

Wed Jul 18 17:15:08 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am: Added QEMU tests
	* tests/qemuxml2argvdata/*: Data files for QEMU tests
	* tests/qemuxml2argvtest.c: Test XML -> argv conversion
	* tests/qemuxml2xmltest.c: Test XML -> XML roundtrip

Wed Jul 18 17:11:08 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xmlrpctest.c, src/xml2sexprtest.c: More void * to
	const void * conversions

Wed Jul 18 16:42:08 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h, src/xm_internal.c,
	src/xend_internal.c, src/xml.c: Added support for input devices
	using <input type='mouse|pointer' bus='ps2|xen|usb'/> element.
	* tests/sexpr2xmltest.c, tests/xmconfigtest.c,
	tests/xml2sexprtest.c: Add new tests for input devices
	* tests/test_utils.c, src/test_utils.h: the virTestRun callback
	uses a const void * instead of void *
	* tests/virshtest.c, tests/xencaptest.c: Switch to const void *
	* tests/sexpr2xmldata/*, tests/xmconfigdata/*, tests/xml2sexprdata/*
	Updated data files to take account of new input device syntax

Wed Jul 18 12:10:08 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/test.c include/libvirt/libvirt.h include/libvirt/libvirt.h.in:
	  cleanup of unused virDeviceMode

Tue Jul 17 16:39:18 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/openvz_conf.c src/libvirt.c: cleanup, avoid some warnings,
	  and reuse the existing uuid generation function.

Tue Jul 17 15:24:27 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in src/Makefile.am src/driver.h src/libvirt.c:
	  applied patch from Shuveb Hussain to plug the developping
	  OpenVZ support. Disabled by default.
	* src/openvz_conf.[ch] src/openvz_driver.[ch]: added new
	  OpenVZ driver files. Avoid a redefinition of readline().

Mon Jul 16 17:36:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* docs/libvir.html, docs/remote.html: Re-write notes on IPV6
	support in the remote daemon

Mon Jul 16 16:59:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h, src/xend_internal.c,
	src/xm_internal.c, src/xml.c: Added support for the <clock/>
	element to switch between UTC and localtime in guests
	* tests/sexpr2xmltest.c, tests/xmconfigtest.c,
	tests/xml2sexprtest.c, tests/sexpr2xmldata/*,
	tests/xml2sexprdata/*, tests/xmconfigdata/*: Added test
	cases for new <clock/> element, and adapted existing expected
	data files where needed.
	* docs/libvir.html, docs/format.html: Added docs about the
	new <clock/> element

Fri Jul 13 14:25:16 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: applied modified patch from Masayuki Sunou for
	  device hot plug description with a wrong root element.

Fri Jul 13 10:28:53 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virterror.c src/xml.c include/libvirt/virterror.h:
	  patch from Masayuki Sunou to check Ethernet MAC addresses
	  in XML configs
	* po/*: string update and merge

Thu Jul 12 17:48:40 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html docs/remote.html: update the remote page,
	  add an index
	* docs/pki_check.sh: shell script to check the PKI and client/server
	  environment.

Thu Jul 12 11:15:17 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Explicitly check certificate/key files
	before trying to load them so we can get improved error reports
	back.

Thu Jul 12 11:02:17 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_conf.c, src/qemu_conf.h, src/qemu_driver.c: Pass
	around the virConnectPtr when available so errors get reported
	against that rather than the global error location.

Thu Jul 12 11:02:17 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Fix cleanup when client access checks fail
	so we don't accidentally register a dead client with the
	event loop. Force close the virConnectPtr object if it is
	still open when a client connection goes away

Thu Jul 12 11:00:17 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Add explicit checks for existance of x509
	certificate & key files to get better error reporting than
	GNU TLS offers when it can't load a file

Thu Jul 12 10:57:17 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: applied patch from Christian Ehrhardt to
	  fix Xen hypervisor alignment problems on PPC64
	* AUTHORS: added Christian

Thu Jul 12 09:34:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Removed --with-qemud-pid-file option since
	  it is no longer used.

Thu Jul 12 09:34:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c, src/xen_unified.c: If compiled with
	  --enable-debug=yes then we now trace libvirt calls on
	  stderr.

Wed Jul 11 10:43:25 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: patch from Masayuki Sunou fixing leaks in
	  virDomainParseXMLDiskDesc

Mon Jul  9 14:24:12 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in include/libvirt/libvirt.h
	  docs/* po/*: prepared release of 0.3.0

Mon Jul  9 13:23:26 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xm_internal.c src/xend_internal.c src/buf.[ch]: add
	  new function virBufferEscapeString() to format a string while
	  escaping its content for XML, and apply it to a couple of
	  obvious places, should fix bug #206653
	* po/*: updated strings, and added new bosnian localization.

Fri Jul  6 17:50:00 EST 2007 Daniel P.Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Use virFreeDomain and virFreeNetwork
	instead of free(), to ensure the objects are removed from
	the cache

Fri Jul  6 16:19:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c, src/qemu_driver.c: If the virNetworkLookup*
	  functions cannot find a network, then they now throw
	  VIR_ERR_NO_NETWORK error.

Fri Jul  6 16:08:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/proxy_internal.c, src/proxy_internal.h,
	  src.xen_internal.c, src/xen_internal.h,
	  src/xen_unified.c, src/xen_unified.h,
	  src/xend_internal.c, src/xend_internal.h,
	  src/xm_internal.c, src/xm_internal.h,
	  src/xs_internal.c, src/xs_internal.h: The interface
	  between xen_unified.c and its underlying driver now uses
	  a custom structure (struct xenUnifiedDriver) instead
	  of reusing virDriver.
	* src/xen_unified.c: virDomainLookup* functions in Xen
	  now throw VIR_ERR_NO_DOMAIN if the domain does not exist.
	* src/xs_internal.c: Fix indentation.

Fri Jul  6 17:06:52 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fix an error in the default help string, bug #247197

Fri Jul  6 16:00:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/hash.c, src/internal.h: Remove virGetDomainByID function
	  as it is not used or exported.
	* src/proxy_internal.c, src/qemu_driver.c, src/remote_internal.c,
	  src/test.c, src/xend_internal.c, src/xs_internal.c: Fix
	  all callers to virGetDomain and virGetNetwork functions -
	  the callers do not need to set virterror since it is already
	  set inside the functions.

Fri Jul  6 15:54:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* include/libvirt/virterror.h, src/virterror.c, src/libvirt.c:
	  Add VIR_ERR_NO_DOMAIN and VIR_ERR_NO_NETWORK errors, which
	  indicate that there is no domain/network from vir*Lookup* functions.
	* src/qemu_driver.c: Use VIR_ERR_NO_DOMAIN in lookup functions.
	* src/test.c: Use VIR_ERR_NO_DOMAIN in lookup functions.

Thu Jul  5 18:02:28 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: fix typo in function comment
	* po/*: updated the localizations
	* qemud/libvirtd.init.in: LSB'ization of the init script and
	  couple of fixups

Thu Jul  5 09:47:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c, src/xen_unified.c: Move code converting NULL
	and 'xen' into 'xen://' from the Xen driver into the main libvirt.c
	entry point. We need this conversion done at the top level, so that
	the network driver open func gets a valid URI in Xen case

Thu Jul  5 09:46:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fixed typo in setting flags for network
	opening.

Wed Jul  4 14:17:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xm_internal.c: configCache not getting refilled if the
	  connection was closed (affected the remote case mainly),
	  and error messages added to xenXMConfigCacheRefresh.

Wed Jul  4 10:14:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/conf.c, src/test.c, src/xen_internal.c: Readd checking
	  of errors from virBuffer functions.
	* src/sexpr.c: Add comment about use of _GNU_SOURCE.
	* src/virsh.c: Remove use of _GNU_SOURCE / isblank.
	* src/xml.c, tests/Makefile.am: Minor cleanup.

Mon Jul  2 09:35:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_driver.c: Change 'qemu' to 'QEMU' to get compatability
	with previous releases reporting of driver type. Allow QEMU to
	handle qemu:///session for root users too. Fix network lookup
	functions to use networkPrivateData instead of privateData
	* src/remote_internal.c: Add auto-spawn of daemons for networking.
	Make network activate for Xen / Test drivers. Make the network
	functions use networkPrivateData instead of privateData

Fri Jun 29 15:46:34 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: applied patch from Masayuki Sunou to remove leaks
	  of domains references in some commands.

Fri Jun 29 15:18:36 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/apibuild.py docs/newapi.xsl: fix generation of XML and
	  stylesheet
	* docs/*: regenerated
	* src/bridge.c src/bridge.h src/buf.c src/iptables.c src/libvirt.c
	  src/qemu_driver.c src/qemu_driver.h src/uuid.c src/uuid.h: cleanup,
	  addd comments, made functions static and fixe a few bugs

Tue Jun 29 13:44:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/site.xsl, docs/libvir.html, docs/hvsupport.html:
	  Document which libvirt versions supported various
	  hypervisor calls.

Tue Jun 27 18:32:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Remove Makefile & Makefile.in from -devel
	packages to avoid multilib conflicts

Tue Jun 26 19:56:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/driver.c, qemud/driver.h, qemud/conf.c, qemud/conf.h,
	qemud/bridge.c, qemud/bridge.h, qemud/uuid.c, qemud/uuid.h,
	qemud/iptables.c, qemud/iptables.h: Removed files now in
	the main library
	* src/qemu_driver.c, src/qemu_driver.h, src/qemu_conf.c, src/qemu_conf.h,
	src/bridge.c, src/bridge.h, src/uuid.c, src/uuid.h,
	src/iptables.c, src/iptables.h: Add files previously in
	the daemon
	* src/qemu_internal.c, src/qemu_internal.h: Remove obsolete
	QEMU driver code

Tue Jun 26 19:35:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/libvirtd.sysconf, qemud/libvirtd.init.in: Added config
	to turn on/off remote support in daemon
	* qemud/conf.c, qemud/conf.h, qemud/driver.c, qemud/driver.h
	Finally switch over to be an internal driver.
	* qemud/dispatch.c, qemud/dispatch.h: Remove obsolete files
	* qemud/protocol.*: Remove all except packet header.
	* src/xml.c: Don't compile virXMLError for libvirt_proxy
	* src/remote_internal.c: Pick up QEMU uris too

Tue Jun 26 19:05:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_internal.c: Fix typo in checking for read only
	connection request

Tue Jun 26 19:04:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/libvirtd.init.in, qemud/Makefile.am, libvirt.spec.in
	Rename the daemon from libvirt_qemud to libvirtd

Tue Jun 26 19:02:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/libvirtd.in, qemud/libvirtd.init.in, qemud/Makefile.am
	rename the init script to not clash with forthcoming daemon
	name change.

Tue Jun 26 18:57:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am, qemud/bridge.c, configure.in, libvirt.spec.in
	Don't use libsysfs for bridge APIs, call brctl directly.
	* qemud/driver.c: Set the STP and forward-delay params if provided

Tue Jun 26 18:56:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c: Don't try to handle URIs with a hostname

Tue Jun 26 18:53:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/internal.h, src/libvirt.c, src/driver.h, src/libvirt_sym.version
	Added internal driver API hooks for global shutdown/startup/reload
	* qemud/driver.c, qemud/driver.h, qemud/internal.h, qemud/qemud.c
	Adapt to make use of new driver API for startup/shutdown

Tue Jun 26 18:47:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/event.h, src/event.c, src/Makefile.am, src/libvirt_sym.version:
	Provide an internal API for drivers to register callbacks for
	monitoring file handles & generating timer notifications.
	* qemud/driver.c, qemud/event.c, qemud/event.h, qemud/qemud.c:
	Adapt to make use of internal driver API for events.

Tue Jun 26 18:41:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemud/conf.h, qemud/dispatch.c, qemud/driver.c,
	qemud/driver.h: Move code related to looking up VMs/networks
	into the conf.c

Tue Jun 26 18:35:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemud/dispatch.c, qemud/driver.c, qemud/driver.h
	Change API contract of all driver methods to make official
	internal driver API.

Tue Jun 26 18:30:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/buf.c, qemud/buf.h: Remove obsolete files
	* src/xml.c: remove virBuffer functions
	* src/buf.c, src/buf.c, src/Makefile.am: Re-add virBuffer functions
	* proxy/Makefile.am, qemud/Makefile.am, qemud/conf.c,
	qemud/driver.c, src/conf.c, src/test.c, src/xen_internal.c,
	src/xend_internal.c, src/xm_internal.c, src/xmlrpc.h,
	tests/xmlrpc.test: Adapt to deal with new location of headers
	for virBuffer functions.

Tue Jun 26 18:21:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemud/driver.c, qemud/buf.c, qemud/buf.h:
	Rename the buffer functions to match those in src/ directory.

Tue Jun 26 18:18:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemud/uuid.c, qemud/uuid.h: Rename the
	UUID functions to not include QEMU in name.

Tue Jun 26 18:10:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemud/conf.h, qemud/dispatch.c, qemud/driver.c,
	qemud/driver.h, qemud/internal.h, qemud/qemud.c: Split the
	struct qemud_server into two parts, moving QEMU stuff out into
	struct qemud_driver. Move all QEMU related data structures
	and manipulation code into conf.c file

Tue Jun 26 16:50:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am, qemud/conf.c, qemud/dispatch.c, qemud/driver.c,
	qemud/driver.h, qemud/internal.h, qemud/qemud.c: Switch over to
	use regular libvirt virError objects & APIs for QEMU error
	reporting purposes

Tue Jun 26 16:43:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/driver.c, qemud/driver.h, qemud/qemud.c: Move code
	handling global startup, shutdown & reload into driver.c

Tue Jun 26 16:41:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/driver.c, qemud/driver.h, qemud/internal.h,
	qemud/qemud.c: Move VM & network process lifecycle management
	out of qemud.c and into the main driver.c

Tue Jun 26 15:11:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/dispatch.c, qemud/driver.c, qemud/driver.h: Move
	code for generating capabilities XML into driver.c file
	alongside other driver APIs

Tue Jun 26 14:52:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/event.c, qemud/event.h, qemud/Makefile.am: Generic
	standalone event loop implementation for monitoring file
	handles & timers.
	* qemud/qemud.c, qemud/internal.h: Adapt to use the generic
	event loop

Tue Jun 26 14:40:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c, python/Makefile.am: Python bindings
	  fixed, and now building virConnect.getHostname and
	  virConnect.getURI.  Fixed a problem which stopped
	  libvirt.py from being (re-)built.  Rearranged
	  python/Makefile.am to make it cleaner and clearer.

Tue Jun 26 12:40:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* include/libvirt/libvirt.h.in, src/libvirt.c: (and numerous
	  other files) Added support for virConnectGetHostname
	  and virConnectGetURI calls.

Mon Jun 25 16:55:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* include/libvirt/libvirt.h.in, src/libvirt.c, src/libvirt_sym.version,
	  python/generator.py: Added virDomainGetConnect and
	  virNetworkGetConnect to allow us to get the "hidden"
	  connection associated with each domain or network.

Mon Jun 25 14:30:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* include/libvirt/libvirt.h, include/libvirt/libvirt.h.in,
	  src/test.c: Remove unused virDomainKernel structure.

Mon Jun 25 14:03:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Partial revert - defining enum transport
	  as a typedef broke the build.

Mon Jun 25 09:40:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Made cosmetic changes to the code and
	  comments to allow 'make -C docs rebuild' to succeed parsing
	  this file.

Mon Jun 25 09:19:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/site.xsl: Added link to OCaml bindings.

Mon Jun 25 09:19:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/remote.c, src/remote_internal.c: Fix virDomainGetVcpus
	  in the remote case.
	* src/libvirt.c: Allow virConnectListDomains,
	  virConnectListDefinedDomains, virConnectListNetworks and
	  virConnectListDefinedNetworks to work in the case where
	  they are called with maxids/maxnames == 0.
	* src/remote_internal.c: Fix virDomainGetMaxVcpus in remote
	  case so that it copies sufficient data.
	* src/xen_unified.c: Remove autostart functions.

Fri Jun 22 14:15:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/remote.c, qemud/remote_protocol.x, src/remote_internal.c:
	  Add support for setting scheduler parameters over remote
	  connections.

Fri Jun 22 12:40:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/internal.h: Added STREQ and STRCASEEQ macros for clearer
	  equality testing of strings.
	* src/xen_internal.c: Fix handling of the scheduler parameters
	  field string so that the field doesn't contain garbage
	  after the string.

Fri Jun 22 12:14:40 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* qemud/driver.c: apply patch from Jim Meyering to handle realloc
	  failure without leaking.

Thu Jun 21 16:56:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/virsh.pod: Fixed a few typos and POD directives.

Thu Jun 21 16:48:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c: Fix virConnectGetMaxVcpus in the
	  remote case when type parameter is NULL.
	* src/xend_internal.c: Proper error reporting in
	  xenDaemonDomainDumpXML function.

Thu Jun 21 11:35:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/remote_interal.c: fix marshalling of 'id' field for
	virDomainPtr objects on the wire

Thu Jun 21 16:59:02 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* virsh.1 docs/virsh.pod docs/Makefile.am: updated the pod file
	  to reflect the current set of commands, added a rule in the Makefile
	  to regenerate the man page, and regenerated.

Thu Jun 21 09:38:12 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/virsh.pod: commit of original POD file for virsh man page
	  from Andrew Puch April 2006

Wed Jun 20 18:23:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c, src/qemu_internal.c, src/test.c,
	  src/xen_unified.c, src/xend_internal.c,
	  src/libvirt.c, include/libvirt/virterror.h:
	  VIR_ERR_NO_SUPPORT means the function is not supported by
	  the hypervisor.  VIR_ERR_NO_CONNECT means the connection
	  failed.  VIR_ERR_CALL_FAILED is deprecated.  Drivers which
	  decline a URI now no longer produce an error.  Make
	  xen_unified.c ignore naked URI strings like "foo".

Wed Jun 20 18:21:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: 'virsh help command' now works even if we could
	  not get a connection to the hypervisor.  Rearranged the list
	  of commands to be in alphabetical order.

Wed Jun 20 10:54:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c src/test.c src/xen_unified.c: Fix URI processing
	  so that local file URIs work again.  Move remote driver to
	  last in the list, and fix all drivers so they decline remote
	  URIs (Daniel Berrange).

Tue Jun 19 20:07:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xend_internal.c: Recognise xen:/// as the standard
	  URI for connecting to a local Xen hypervisor.

Tue Jun 19 17:02:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html docs/remote.html docs/uri.html: Documented
	  all supported URI formats.

Tue Jun 19 15:42:26 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/site.xsl docs/libvirt.html docs/uri.html docs/*.html:
	  adding a placeholder for the new URIs page, update the
	  stylesheet to generate a new page, rebuilt.

Tue Jun 19 13:12:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/remote.html: Check in the updated documentation file
	  for the web site.

Tue Jun 19 10:30:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/virsh.c: vcpupin command now documented properly and
	  gives clearer error messages if the cpulist is wrong
	  (Masayuki Sunou).

Tue Jun 19 11:11:18 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: drop the release information as this
	  is usually garbage ending up polluting minor and major numbers.
	* src/virsh.c: applied patch from Masayuki Sunou providing a pair
	  of alternate attach/detach commands

Mon Jun 18 16:59:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* docs/libvir.html (Remote): Updated certificate documentation
	  to use GnuTLS certtool instead of CA.pl / openssl.

Mon Jun 18 10:32:14 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: applied SetMem cleanup patch from Mark Johnson

Fri Jun 15 16:21:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Solaris header file fixes (Mark Johnson).

Fri Jun 15 14:42:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/test.c, src/virsh.c, src/xend_internal.c, src/xm_internal.c:
	  Replace calls to deprecated {,r}index with str{,r}chr.

Fri Jun 15 08:53:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/internal.h, src/virsh.c: Replace _N with N_ so that
	  Solaris builds work (Mark Johnson).
	* src/virsh.c: Add a couple of missing error messages (Mark
	  Johnson).
	* python/types.c: Fix NULL pointer deref on DEBUG build
	  (Mark Johnson).
	* src/virsh.c: Spelling fix (Mark Johnson).

Thu Jun 14 21:30:28 EST 2007 Daniel Berrange <berrange@redhat.com>

	* libvirt.spec.in: Change way extra_release is inserted to
	work with Fedora 7 where %dist is always defined

Thu Jun 14 21:15:28 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/Makefile.am: Fix generation of coverage files by
	excluding files for server protocol

Wed Jun 13 11:30:28 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Saori Fukuta for messages
	* *.po: updated with the patch from Saori Fukuta and merge from
	  the i18n CVS base.

Mon Jun 11 14:49:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/examples/index.py: Autogenerate Makefile.am and
	  .cvsignore in this directory with corrected LDADDS and
	  including some generated subdirectories which CVS should
	  ignore.

Mon Jun 11 14:10:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* libvirt.spec.in: BuildRequires gnutls-devel and
	  set the remote PIDfile when configuring.
	* qemud/Makefile.am: Distribute the Perl scripts.
	* qemud/qemud.c: Only use QEMUD_DEBUG when ENABLE_DEBUG
	  is defined.

Mon Jun 11 13:25:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* RENAMES: Suggested list of file renames.

Mon Jun 11 13:24:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/examples/.cvsignore: Ignore .deps and .libs subdirectories.

Mon Jun 11 13:22:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html, docs/remote.html: Updated docs to reflect
	  access control lists now based on Distinguished Names.

Mon Jun 11 13:18:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in: Add '--with-remote' flag.  Add compatibility
	  code for versions of libxml2 supporting xmlURI.query_raw.
	  Check for GnuTLS library.

Mon Jun 11 12:49:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/Makefile.am, qemud/dispatch.c, qemud/dispatch.h,
	  qemud/internal.h, qemud/protocol.c,
	  qemud/protocol.h, qemud/protocol.x, qemud/qemud.c:
	  libvirt_qemud server-side modifications to use
	  XDR-based protocol instead of homebrew (Dan Berrange).
	  QEMUD server modified to dispatch calls from remote
	  clients (Richard Jones).  Added TLS support (Richard Jones).
	  Added TCP & IPv6 support (Richard Jones).
	  Additional configuration file, command-line handling, and
	  usage (Richard Jones).
	* qemud/conf.c: Remove unnecessary header file.

Mon Jun 11 12:48:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/qemu_internal.c: QEMU client-side modifications to
	  use XDR-based protocol instead of homebrew.  (Dan Berrange)

Mon Jun 11 12:45:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/remote.c, qemud/remote_generate_stubs.pl,
	  qemud/remote_dispatch_localvars.h,
	  qemud/remote_dispatch_proc_switch.h,
	  qemud/remote_dispatch_prototypes.h: Server side of
	  the remote patch, deals with call dispatch.

Mon Jun 11 12:41:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/remote_internal.c, src/remote_internal.h,
	  src/driver.h, src/libvirt.c, src/Makefile.am: Client side
	  of the remote patch - adds a remote driver.

Mon Jun 11 12:34:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/remote_protocol.x, qemud/rpcgen_fix.pl,
	  qemud/remote_protocol.c, qemud/remote_protocol.h: Client/server
	  protocol used by remote.

Fri Jun  8 13:06:01 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in include/libvirt/libvirt.h
	  docs/*: prepared release of 0.2.3

Fri Jun  8 11:35:55 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* po/*: new merge of localization strings

Thu Jun  7 14:20:30 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/xm_internal.c: Fixed handling of bridge devices
	when converting XM configs to XML
	* tests/xmconfigdata/test-fullvirt-*: Added explicit
	bridge device to test suite

Thu Jun  7 10:47:30 EST 2007 Daniel Berrange <berrange@redhat.com>

	* autobuild.sh: Ensure build fails if tests fail

Thu Jun  7 10:08:30 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/xm_internal.c: Fix boot device XML -> config conversion
	* test/xmconfigdata/test-fullvirt-new-cdrom.xml,
	test/xmconfigdata/test-fullvirt-old-cdrom.xml fix syntax for
	boot device

Thu Jun  7 15:48:30 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xm_internal.c src/xml.c: add support
	  for arguments to bootloader, patch from Hugh Brock
	* tests/sexpr2xmltest.c tests/xml2sexprtest.c
	  tests/sexpr2xmldata/sexpr2xml-pv-bootloader.sexpr
	  tests/sexpr2xmldata/sexpr2xml-pv-bootloader.xml
	  tests/xml2sexprdata/xml2sexpr-pv-bootloader.sexpr
	  tests/xml2sexprdata/xml2sexpr-pv-bootloader.xml: add specific
	  regression tests

Thu Jun  7 15:02:44 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: do not die if the daemon is not running on a Xen
	  system (shows up as root only) and emit a warning instead
	* src/virterror.c include/libvirt/virterror.h docs/*: add
	  the new warning.

Wed Jun  6 16:37:36 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: patch from Saori Fukuta to avoid (type ioemu)
	  on Xen-3.1 and HVM guests devices to avoid breaking paravirt
	  drivers there

Wed Jun  6 14:22:36 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: added a logging option to a file based on
	  Nobuhiro Itou patch
	* src/xen_internal.c: small TODO comment from Atsushi SAKAI

Wed Jun  6 09:20:23 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* po/*: merge all po from Red Hat/Fedora translations, and
	  ran 'make update-po'

Tue Jun  5 22:47:09 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: fix from Hugh Brock to allow compiling
	  with -Werror after the previous patch

Tue Jun  5 14:03:38 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/driver.h src/libvirt.c src/libvirt_sym.version
	  src/proxy_internal.c src/qemu_internal.c src/test.c
	  src/virsh.c src/xen_internal.c src/xen_internal.h src/xen_unified.c
	  src/xend_internal.c src/xm_internal.c src/xs_internal.c:
	  Applied patches from Atsushi SAKAI to add the scheduler API,
	  with patch from Rich Jones for error handing, and a number
	  of cleanups and more error checking from me

Mon Jun  4 10:41:25 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: apply patch from Masayuki Sunou about an uninitialized
	  string when attaching a device

Fri Jun  1 16:02:12 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: added a comment about (type ioemu) not needed
	  for interfaces on xen 3.1 as pointed by Saori Fukuta

Tue May 29 15:56:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* python/generator.py, python/libvir.c, python/libvir.py:
	  Wrap the virGetVersion call as Python libvirt.getVersion.

	* src/libvirt.c: Change virGetVersion so that the driver name
	  is case insensitive.

Tue May 29 15:41:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* TODO: Added a note about requiring C++ compiler because of a
	  possible problem with libtool autoconf macros.
	* docs/examples/Makefile.am, proxy/Makefile.am, qemud/Makefile.am,
	  src/Makefile.am, tests/Makefile.am: Pass $(WARN_CFLAGS) when
	  linking, so if -fstack-protector is there, gcc will link to
	  the stack protector library.
	* tests/xencapstest.c: Allow this test to compile when Xen
	  libraries are not enabled.

Tue May 29 15:54:17 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c src/xen_internal.c src/xend_internal.c: memory leaks
	  fixed by a patch from Masayuki Sunou

Wed May 23 16:07:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* src/virsh.c: Add attach-device and detach-device commands to
	virsh, and tidy up the way it reads whole files.  Patch from
	Masayuki Sunou, Mark McLoughlin, Richard Jones.

Mon May 21 20:38:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Allow xenXMDomainDefineXML to overwrite
	an existing guest config to match semantics of XenD and QEMU
	drivers. Patch from Hugh Brock.

Fri May 18 14:36:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemud/internal.h, qemud/qemud.c: Save VM output
	in a logfile
	* libvirt.spec.in: added /var/log/libvirt/qemud directory

Mon May 14 11:00:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c: Fix initialization of var to prevent stack
	overflow. Make sure we initialize the brCtl in case there
	is no virtual network running

Thu May 11 10:20:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Fix boot device XML syntax

Thu May 11 10:20:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Ignore old style VNC config for HVM
	guests on Xen 3.0.5 or later

Thu May 11 09:34:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Added dep on dnsmasq

Thu May 11 13:23:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* .cvsignore, qemud/uuid.c: Add some generated files to .cvsignore.
	  Remove an unused #include from uuid.c.

Thu May 10 17:00:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* docs/libvir.html, docs/libvirt.css, docs/remote.html:
	  Added documentation for TLS certificates and libvirtd.conf.
	  CSS changes makes the tables look nicer.  remote.html is
	  a generated file.

Tue May  8 11:49:00 BST 2007  Richard W.M. Jones  <rjones@redhat.com>

	* src/hash.c, src/internal.h, src/libvirt_sym.version: Export
	  __virGetDomain and __virGetNetwork for use by the libvirtd.
	  The double underscores indicate that these interfaces are
	  not officially supported parts of the libvirt API or ABI.

Tue May  8 11:14:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/hash.c, src/internal.h, src/xs_internal.c: Remove
	  unused fields from internal _virDomain structure.

Thu May  3 12:09:41 EST 2007 Daniel P. Berange <berrange@redhat.com>

	* qemud/conf.c, qemud/internal.c: Read upto 8k from QEMU
	help output. Support the <on_reboot> attribute to set the
	-no-reboot flag in QEMU

Thu May  3 18:00:41 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fix help for dumpxml and net-dumpxml commands
	  based on Chris Wright feedback

Thu May  3 15:03:00 BST 2007 Richard Jones <rjones@redhat.com>

	* src/virterror.c, include/libvirt/virterror.h: Added
	  VIR_FROM_REMOTE, VIR_ERR_RPC, VIR_ERR_GNUTLS_ERROR
	  for remote errors.

Wed May  2 18:42:00 BST 2007 Richard Jones <rjones@redhat.com>

	* src/libvirt.c, src/qemu_internal.c: Allow network
	  drivers to DECLINE to take accept a call.  Only fail
	  outright if the network driver reports an error.
	* src/qemu_internal.c (qemuNetworkOpen): Fix path to
	  driver used in the non-root case.

Wed May  2 18:38:00 BST 2007 Richard Jones <rjones@redhat.com>

	* src/proxy_internal.c, src/qemu_internal.c, src/test.c,
	  src/xen_unified.c, src/xend_internal.c, src/xs_internal.c:
	  During virConnectOpen, be careful to call __virRaiseError
	  with conn = NULL so that the error message is not
	  discarded.

Wed May  2 17:55:12 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/libvirtd.in: synchronously restart the daemon in
	order to avoid https://bugzilla.redhat.com/238492

Wed May  2 12:16:35 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_unified.c: Disable xm_internal.c driver on Xen
	newer than 3.0.3

Wed May  2 11:50:35 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Use --strict-order when running dnsmasq

Mon Apr 30 18:33:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c, src/driver.h, src/proxy_internal.c,
	  src/qemu_internal.c, src/test.c, src/xen_internal.c,
	  src/xend_internal.c, src/xs_internal.c,
	  proxy/libvirt_proxy.c: Remove VIR_DRV_OPEN_QUIET.

Mon Apr 30 18:02:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/proxy_internal.c (xenProxyGetCapabilities): Add support
	  for virConnectGetCapabilities across Xen proxy.

Mon Apr 30 18:00:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xen_unified.c: In the non-root case keep track of the
	  Xen underlying drivers which opened correctly and only
	  try methods on those opened drivers.

Mon Apr 30 17:58:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/libvirt.c (virConnectNumOfDefinedDomains): Documentation
	  fix (thanks to Jan Michael).

Thu Apr 26 12:20:35 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fix virshStrdup to not crash if NULL is passed.

Tue Apr 24 15:43:04 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/internal.h src/xend_internal.c: a better fix from Shigeki Sakamoto
	  and raising errors on memory shortage.

Mon Apr 23 09:38:16 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/internal.h src/xend_internal.c src/xml.c: applied 2 bug fixes
	  from Shigeki Sakamoto about large buffers.

Thu Apr 19 12:09:15 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* docs/libvirt.rng: fix duplicate x86_64 arch

Thu Apr 19 09:45:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* docs/libvir.html: Change &nbsp; to space.

Thu Apr 19 09:55:28 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* libvir.rng: applied patch to fix regexp constructs from Robin Green

Wed Apr 18 16:16:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* docs/libvir.html: Documentation for the remote patch.

Wed Apr 18 11:12:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* src/test.c, src/libvirt.c, src/virterror.c,
	  include/libvirt/virterror.h: Add a VIR_FROM_TEST error class
	  and ensure that test driver errors are from this class.
	  Tidy up the error messages generated by the test driver when
	  user doesn't add a path to the URL and avoid open ("/").

Wed Apr 18 11:57:28 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/remote.html docs/site.html docs/*.html: added a stub for
	  the remote page, added it to stylesheet and regenerated

Tue Apr 17 11:30:46 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* docs/* NEWS libvirt.spec.in: prepare release of 0.2.2
	* docs/apibuild.py: do not scan xen_unified for APIs.

Mon Apr 16 09:11:04 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c: Check for existance of QEMU binary path. Fix check
	for -no-kqemu flag to work with x86_64 on i386

Mon Apr 16 09:09:04 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_internal.c: Implement virDomainGetOSType driver method
	for QEMU guests

Mon Apr 16 08:30:04 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py, python/libvir.py: Ensure that connection
	info is passed into virError object when a virNetwork or virDomain
	operation fails

Sun Apr 15 15:57:04 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/driver.c: Fixed integer overflow in calculating CPU time
	for qemu guests - use long long throughout.

Fri Apr 13 10:07:04 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Back out accidental commit of code which
	added an <os> block for dom0.

Fri Apr 13 10:00:04 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fixed a bad messaging mechanism preventing localization
	  and raised by Thomas Canniot

Thu Apr 12 19:51:00 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c: Updated structs to work with new Xen 3.0.5
	hypercall ABI. Mask out HVM bit when determining domain status.
	Limit number of iterations when counting active IDs to 65000
	* src/xen_unified.c: Fix checking of return value for the
	domainGetVCpus method.
	* src/xend_internal.c: Added an impl of the DomainGetOSType
	method which works with inactive domains too. Don't do a
	redundant ping test against GetVersion, since we now already
	fetch config file format number which serves as a ping test.
	Allow the kernel SEXPR field to be missing for domain0, or if
	using a bootloader. Mark interface as type=bridge, if there
	is a bridge device listed, but no explicit script to fix inactive
	domains. Allow multiple boot devices to be provided for HVM
	* src/xml.c: Allow multiple boot devices to be provided for HVM.
	Support new style graphics config for HVM in xen 3.0.5
	* src/xs_internal.c: Don't hardcode domain type of 'linux',
	since we now have a fallback driver with xend that can make
	the correct diagnosis for inactive domains.

Thu Apr 12 15:18:00 BST 2007 Richard Jones <rjones@redhat.com>

	* src/libvirt.c: set VIR_CONNECT_RO on read-only connections.
	  Patch by S.Sakamoto.

Wed Apr 11 18:04:00 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xml.c: applied patch from Nobuhiro Itou
	  to handle CDRom devices with no device name
	* tests/sexpr2xmltest.c tests/xml2sexprtest.c
	  tests/sexpr2xmldata/sexpr2xml-no-source-cdrom.sexpr
	  tests/sexpr2xmldata/sexpr2xml-no-source-cdrom.xml
	  tests/xml2sexprdata/xml2sexpr-no-source-cdrom.sexpr
	  tests/xml2sexprdata/xml2sexpr-no-source-cdrom.xml: added regression
	  tests for this case based on Nobuhiro Itou test inputs.

Tue Apr 10 19:17:29 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c, qemu/internal.h, qemud/iptables.c, qemud/iptables.h,
	qemud/qemud.c: Some adjustment to IPTables rules to tighten up traffic
	flow to/from virtual networks & avoid accidentally NAT'ing wrong packets.
	Fixed XML dump when using auto-generated bridge device name.

Tue Apr 10 19:15:29 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* python/libvir.c, python/libvirt-python-api.xml: Added manual
	impl of the vir*GetAutoStart API methods since generator fails.

Tue Apr 10 20:39:29 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: fixed some typos reported by translator
	  Nikolay Sivov should fix #235904

Tue Apr 10 13:58:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* src/xen_unified.c (xenUnifiedRegister): Comment the
	  xenUnifiedRegister function to avoid error message
	  when building docs/.  Patch from Atsushi SAKAI.

Tue Apr 10 12:18:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* src/xen_unified.h, src/xen_unified.c: Fix indentation.

Fri Apr  6 17:33:13 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/test.c: converted to new XPath APIs
	* src/xml.c: fixed a return comment

Fri Apr  6 14:27:13 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.[ch]: first patch to clean up XPath accesses with new
	  routines, only xml.c is cleaned up, other modules to follow.

Wed Apr  4 15:18:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* src/xen_unified.c et al: Unified Xen driver.  Architecture
	  described here:
	  https://www.redhat.com/archives/libvir-list/2007-March/msg00396.html

Wed Apr  4 10:30:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* configure.in, qemud/Makefile.am: Set QEMUD_PID_FILE macro
	  correctly (expand ${prefix} in Makefile).
	* qemud/qemud.c: Add command line help.
	* ChangeLog: Remove a CVS '>>>>' conflict line which had
	  been committed inadvertently.

Mon Apr  2 13:54:17 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: applied patch from Atsushi SAKAI to clarify
	  that memory values are in kilobytes

Wed Mar 30 17:25:33 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/iptables.c: As suggested by danpb, make libvirt_qemud
	handle SIGHUP by re-loading the iptables rules.

Wed Mar 30 17:24:48 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/iptables.c: Re-factor things a little so that we
	maintain the rules in memory even when we're not going
	to write them to disk.

Wed Mar 30 17:21:08 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/iptables.c: Remove the target interface parameter
	from iptablesPhysdevForward(). This rule is intended to
	allow frames to be forwarded across the	bridge from the
	supplied bridge port. In this context, the --out parameter
	would match the outgoing bridge port, which will never
	be network->def->forwardDev.

Wed Mar 30 17:17:15 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/iptables.c: ensure iptablesContext is zereod out
	when allocating so we don't try and free an invalid pointer.

Wed Mar 28 12:23:00 BST 2007 Richard W.M. Jones  <rjones@redhat.com>

	* python/generator.py: Python bindings now throw exceptions
	  in almost all cases where an error is encountered in the
	  underlying libvirt code.

Wed Mar 28 10:47:16 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: applied patch from Masayuki Sunou fixing the
	  erroneous value of the hypercall XEN_V2_OP_SETMAXMEM
	* libvirt.spec.in: applies changes from Jeremy Katz for libvirt
	  spec and also another fix from Michael Schwendt fixing rhbz#233874

Tue Mar 27 10:46:00 EDT 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c: Fixed bridged config to refer to 'bridge' attribute
	instead of 'dev' attribte on the <source> element, thus complying
	with schema.

Tue Mar 27 10:39:00 EDT 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xen_internal.c: Fix handling of PAE flags in capabilities XML
	generation & merge duplicate (arch,os-type) entries.
	* tests/xencapstest.c: Added a test suite for various Xen capabilities
	data sets
	* tests/xencapsdata/*: Added data files for Xen capabilities tests
	* configure.ac, tests/Makefile.am: Added tests/xencapsdata/ directory

Tue Mar 27 11:26:00 BST 2007 Richard W.M. Jones <rjones@redhat.com>

	* qemud/qemud.c: If using FORTIFY_SOURCE, remove warning
	  warn_unused_result by counting errors found in signal
	  handler and logging them in the main loop.

Mon Mar 26 11:29:43 CEST 2007 Daniel Veillard <veillard@redhat.com>

	* acinclude.m4: applied patch from Jim Meyering to avoid clobbering
	  user specified CFLAGS

Fri Mar 23 17:14:10 CET 2007 Daniel Veillard <veillard@redhat.com>

	* TODO qemud/conf.c src/virsh.c src/xend_internal.c src/xs_internal.c:
	  replaced all sprintf instances by snprintf ones

Fri Mar 23 09:12:00 UTC 2007 Richard W.M. Jones <rjones@redhat.com>

	* src/xen_internal.c: Fix detection of host PAE capabilities,
	  nul-terminate the token in the output XML and a couple of
	  cleanups for determining structure sizes.

Thu Mar 22 19:38:38 CET 2007 Daniel Veillard <veillard@redhat.com>

	* qemud/iptables.c qemud/qemud.c src/conf.c src/hash.c src/libvirt.c
	  src/virsh.c src/xm_internal.c: change malloc/memset(0) pairs to
	  using calloc()

Thu Mar 22 16:25:10 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/*.html: repair the damages made by Amaya on the content
	  of documentation following feedback from Simon Hernandez

Thu Mar 22 11:35:05 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: applied patch from Masayuki Sunou to avoid a bug
	  when using a wrong CPU number in vcpupin and report the error

Thu Mar 22 10:47:46 CET 2007 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: one more extra fix for autostart dir from
	  Florian La Roche, should fix #233409

Wed Mar 21 11:29:06 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/buf.c: Remove redundant (and broken) call to realloc()
	which caused a buffer overflow

Wed Mar 21 16:31:29 CET 2007 Daniel Veillard <veillard@redhat.com>

	* qemud/buf.c src/xml.c: clarified virBufferGrow (and bufferGrow)
	  routines documentation and fixes a couple of places where this
	  was misused as pointed by Daniel Berrange.

Wed Mar 21 10:52:06 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* acinclude.m4: Always use -Wp,-D_FORTIFY_SOURCE=2 -fexceptions
	-fstack-protector --param=ssp-buffer-size=4
	-fasynchronous-unwind-tables if supported by the compiler. Check
	all warnings flags for compiler support

Tue Mar 20 10:00:06 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c: Fixed buffer overflow in code building up
	command line args for qemu networking

Tue Mar 20 16:40:06 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: add error messages for negative memory size as
	  pointed out by Masayuki Sunou

Tue Mar 20 16:30:29 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: applied patch from Atsushi SAKAI fixing
	  direct hypervisor calls on some recent Xen versions

Tue Mar 20 15:58:10 CET 2007 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: missing /etc/libvirt/qemu/networks/autostart

Mon Mar 19 15:19:06 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: applied patch from Jim Meyering to add printf-style
	  function checking in virsh.c and fix one warning raised

Mon Mar 19 15:15:51 CET 2007 Daniel Veillard <veillard@redhat.com>

	* qemud/protocol.h src/internal.h: applied patch from Jim Meyering
	  removing global variables (using named enum instead).

Mon Mar 19 11:13:58 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: patch from Atsushi SAKAI, fixing virsh access
	  as root when libvirt_qemud is not running
	* TODO: updated

Mon Mar 19 10:44:25 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: patch from Masayuki Sunou, checking that byte
	  values passed to virsh memory commands are positive.

Fri Mar 16 20:30:20 CET 2007 Daniel Veillard <veillard@redhat.com>

	* NEWS libvirt.spec.in docs/libvir.html docs/news.html: preparing
	  release of libvirt-0.2.1

Fri Mar 16 19:32:01 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/*: updated the format section, augmented Networking with
	  description provided by Daniel Berrange
	* po/*: regenerated

Fri Mar 16 16:01:54 CET 2007 Daniel Veillard <veillard@redhat.com>

	* qemud/conf.c qemud/driver.h qemud/internal.h src/internal.h
	  src/sexpr.h src/test.c src/xm_internal.c src/xml.c src/xml.h:
	  applied patch from Richard Jones adding check to printf-like
	  functions and fixing the problems raised

Fri Mar 16 15:55:01 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c tests/sexpr2xmltest.c tests/xmconfigtest.c: avoid
	  warnings when compiling without Xen

Fri Mar 16 11:43:08 CET 2007 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: patch from Tatsuro Enokura to fix
	  virNetworkDefine binding

Thu Mar 15 14:57:20 EST 2007 Daniel P Berrange <berrange@redhat.com>

	* src/xen_internal.c: Fixed off by one error in extracting
	the regex match data - the first match is the whole string.
	So the substrings start at position 1. Fixed indentation of
	<features> XML. Use memset to clear guest_archs and thus
	ensure no uninitialized data for valgrind to complain about.

Thu Mar 15 14:14:20 EST 2007 Daniel P Berrange <berrange@redhat.com>

	* src/qemud_internal.c: Paranoia ensure the XML returned by
	the getCapabilities call is NULL terminated before strduping
	to protect from malicious / buggy server
	* qemud/dispatch.c: Packet length for getCapabilities call
	should be the size of the reply body, not the size of the
	XML string.

Thu Mar 15 14:14:20 EST 2007 Daniel P Berrange <berrange@redhat.com>

	* src/xen_internal.c: Fix missing NULL initializer

Thu Mar 15 13:20:20 EST 2007 Daniel P Berrange <berrange@redhat.com>

	* libvirt.spec.in: Don't include default network XML in /etc
	filelist. Instead only install it froma %post script. This
	ensure that if an admin deletes the default network it doesn't
	get recreated upon RPM updates.

Thu Mar 15 18:20:03 CET 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h[.in] include/libvirt/virterror.h
	  proxy/libvirt_proxy.c qemud/Makefile.am qemud/conf.c qemud/conf.h
	  qemud/dispatch.c qemud/internal.h qemud/protocol.h
	  src/driver.h src/internal.h src/libvirt.c src/libvirt_sym.version
	  src/proxy_internal.c src/proxy_internal.h src/qemu_internal.c
	  src/test.c src/virsh.c src/virterror.c src/xen_internal.c
	  src/xen_internal.h src/xend_internal.c src/xm_internal.c
	  src/xml.h src/xs_internal.c: applied patch from Richard Jones
	  adding virConnectGetCapabilities(), plus various small little
	  fixes
	* docs/*: fixed the api extractor script and regenerated


Thu Mar 15 16:21:46 CET 2007 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: fix the python binding generation for
	  virNetworkLookup...() functions, which were clashing with
	  equivalent virConnLookup...() equivalents, as reported by
	  Tatsuro Enokura

Thu Mar 15 15:26:20 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c src/xen_internal.c: applied patch from Atsushi SAKAI
	  to better handle the case where there is no limit in the domain
	  upper memory size
	* docs/architecture.html docs/format.html docs/intro.html
	  docs/libvir.html: started to update the documentation to reflect
	  the current state

Thu Mar 15 08:40:33 CET 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in proxy/Makefile.am proxy/libvirt_proxy.c
	  src/Makefile.am src/libvirt.c src/qemu_internal.c src/test.c
	  src/xen_internal.c src/xen_internal.h src/xend_internal.c
	  src/xm_internal.c src/xml.c src/xs_internal.c
	  tests/Makefile.am tests/sexpr2xmltest.c tests/xmconfigtest.c:
	  allow selective compilation of Xen,QEmu/KVM and test support
	  in or out at configure time. Also allows to compile on a system
	  without Xen development installed. All drivers are selected by
	  default.

Wed Mar 14 14:12:32 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Kazuki Mizushima, an
	  inversion between shutoff and shutdown flags
	* po/* doc/*: automatic update

Tue Mar 13 18:04:14 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Use the --dhcp-leasefile arg to dnsmasq to
	ensure multiple instances of dnsmasq can co-exist without
	splaterring each other's leases.

	* qemud/bridge.c: Use a single ifname arg instead of two separate
	ifnameOrFmt & ifname args to simply use by callers

	* qemud/conf.c: Autogenerate a MAC address if none is provided.
	Added support for ethernet, bridge, mcast, client and server
	networking config types in XML parser, generator and command
	line args. Use the 'vlan' attribute for all QEMU nics to ensure
	they don't all appear on same virtual LAN. Ensure order of
	QEMU NICs matches order they are declared in the XML. Tweak
	existing XML generation of 'network' type to match syntax
	used by Xen for specifying tap device name. Add support for
	creating isolated networks, or networks forwarding to an
	explicit named physical device.

	* qemud/default-network.xml: Add <forward/> to make default network
	automatically forward to any active physical device.

	* qemud/internal.h: Added struct fields for new types of network
	config, and for tracking network forward device.

	* qemud/iptables.h, qemud/iptables.c: Allow an optional target
	device name to be passed in to restrict IP tables forwarding
	rules.

	* qemud/Makefile.am: Create $sysconfdir/lib/libvirt for DHCP
	leases file

	* libvirt.spec.in: Include %{_sysconfdir}/lib/libvirt for DHCP
	leases file

Mon Mar 12 23:17:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Don't run UUID generation on first install,
	instead run it if there is no <uuid> in the default network.
	This ensures RPM upgrades get a UUID inserted

Mon Mar 12 12:32:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Generate a random UUID for the default network
	for each RPM installation. Mark /etc directories as %dir as needed
	and make files mode 0700 to protect passwords for VNC server

Mon Mar 12 10:09:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Generate a fixed, but random UUID in the default
	network config file when installing it

Fri Mar  9 15:46:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt_sym.version, src/conf.h, src/conf.c: Export virConf*
	symbols for private use by libvirt daemon. Prefixed symbols with
	__ to indicate privateness, and not present in any installed header
	files. Patch from Rich Jones.

Fri Mar  9 10:41:11 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py, python/libvir.c, python/libvirt_wrap.h,
	python/libvirt-python-api.xml, python/types.c: Added new bindings
	for all the virNetwork related APIs

Fri Mar  9 14:43:11 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: bad pointer/int mismatch fixes from Richard Jones

Thu Mar  8 22:07:14 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c: Fix double free in XML parsing routine

Thu Mar  8 18:31:14 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Make sure to create $PREFIX/var/run/libvirt
	so that the system daemon can create its socket

Thu Mar  8 16:32:14 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* autobuild.sh: Make all compiler warnings fatal for automated
	build & test harness

Thu Mar  8 16:30:41 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Add some macro magic to allow Release field
	to incorporate an automated build number for testing - a no-op
	for normal RPM builds.

Thu Mar  8 10:14:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_internal.c: Fix inverted check on file handle to
	avoid opening connection twice. Avoid SEGV if uri->scheme is
	NULL. Don't run autostart for system instance.

Thu Mar  8 09:47:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: Refactored driver registration to avoid
	type-punning problems by casting different structs. Also
	fix network driver opening to open read-only when needed.

Thu Mar  8 15:10:12 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/internal.h src/xend_internal.c src/xm_internal.c src/xml.c:
	  add a check for minimal size of Xen Dom0, track places where we
	  had arbitrary minimal memory requirement and use a predefined
	  macro to clean this up.

Thu Mar  8 08:45:46 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Added an explicit --readonly option to virsh
	to override the simple Xen-specific heuristic when running
	as non-root. Patch from Rich Jones

Thu Mar  8 09:54:46 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: applied patch from Nobuhiro Itou to allow the
	  VNC port 5900 to be used with xend, it's an edge case.

Thu Mar  8 09:22:29 CET 2007 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/driver.h src/libvirt.c src/libvirt_sym.version
	  src/proxy_internal.c src/qemu_internal.c src/test.c src/virsh.c
	  src/xen_internal.c src/xen_internal.h src/xend_internal.c
	  src/xm_internal.c src/xs_internal.c: applied patch from
	  Masayuki Sunou to add and entry point to check the maximum
	  number of virtual CPU supported by a virtualization mechanism
	* doc/*.html doc/libvirt-*.xml: regenerated the interfaces descriptions
	  and associated docs.

Wed Mar 07 11:53:22 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/default-network.xml: add a default network

	* qemud/Makefile.am: install it, and the autostart symlink

	* libvirt.spec.in: update

Tue Mar 06 17:02:12 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/hash.c: virGetDomain and virGetNetwork require that both
	name and UUID are non-NULL. (Patch from Rich Jones)

Tue Mar 06 16:52:12 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* include/libvirt/libvirt.h.in, python/libvir.c, src/driver.h
	src/libvirt.c, src/qemu_internal.c, src/test.c, src/virsh.c,
	src/xend_internal.c, src/xm_intenral.c: Change const char **
	to char **const to fix compiler warnings
	* python/Makefile.am: Don't warn about redundant decls
	* python/libvirt_wrap.h: Ensure PyGILState is always initialized
	* tests/reconnect.c: Added ATTRIBUTE_UNUSED annotation
	  All patches from Richard Jones

Tue Mar 06 14:21:12 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c, src/xml.c, src/xm_internal.c: Support
	the 'keymap' attribute for VNC configuration. Based on patch
	signed off by: Takahashi Tomohiro
	* tests/sexpr2xmldata/, tests/xml2sexprdata/: Update to test
	handling of keymap attribute

Tue Mar 06 11:47:12 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemud.c: Unlink read-only socket upon startup (patch
	from Rich Jones)

Mon Mar 05 12:19:42 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_internal.c: Remove bogus ATTRIBUTE_UNUSED annotation
	from qemuOpenConnection (from Rich Jones)

Mon Mar 05 12:07:42 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Parse QEMU stderr immediately at startup to
	identify monitor, and then wait for monitor prompt. Re-arrange
	order of file descriptor watches/processing to avoid re-entrancy
	problems.
	* qemud/driver.c: Make handling of monitor commands slightly
	more robust. Added support for 'paused' CPU state in status
	* qemud/internal.h, qemud/conf.c: Added support for 'paused'
	CPU state

Mon Mar 05 16:39:54 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: don't try and listen to a null socket
	path when run as a session daemon. Noticed by Rich Jones

Mon Mar 05 11:33:18 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/driver.c: fix a couple of invalid free() calls

Mon Mar 05 11:07:38 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* libvirt.spec.in: BuildRequires: /sbin/iptables and
	run configure with the --with-init-script and
	--with-qemud-pid-file parameters.

	* configure.in: it's --with-qemud-pid-file, not
	--with-pid-file

Mon Mar 05 10:52:02 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* libvirt.spec.in: sync some of the chanes from dist-cvs
	so that this looks pretty much as it should do for the
	next release.

Fri Mar 02 15:16:23 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Change lookup by UUID to request a path
	of /xen/domain/[uuid] directly for new XenD, rather than iterating
	over domains sequentially. Derived from patch by
	Tatsuro Enokura <fj7716hz@aa.jp.fujitsu.com>

Fri Mar 02 09:21:23 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Fix output of VNC display in the case where
	there is no explicit listen attribute in the XML

Thu Mar 01 18:22:23 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Instead of looking for string 'Cannot'
	in POST response, look for 'xend.err' which is likely to catch
	many more error replies from XenD. Signed-off-by: Kazuki Mizushima

Thu Mar 01 16:17:48 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* acinclude.m4: add LIBVIRT_COMPILE_WARNINGS, copied from
	GNOME but with a few more flags we'd been using.

	* configure.in: use that instead of setting CFLAGS
	directly.

	* proxy/Makefile.am, python/Makefile.am, qemud/Makefile.am,
	  src/Makefile.am, tests/Makefile.am: use $(WARN_CFLAGS)

Thu Mar 01 16:00:12 IST 2007 Mark McLoughlin <markmc@redhat.com>

	Fix from Richard W.M. Jones <rjones@redhat.com>

	* proxy/libvirt_proxy.c: include locale.h

Tue Feb 27 10:49:35 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Check POST reply for 'Cannot' to detect
	failure of core dump on Domain-0. Signed-off-by: Kazuki Mizushima

Tue Feb 27 10:35:35 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Fix SEGV when doing tab-completion of commands
	which have no arguments (eg, nodeinfo<TAB>).

Tue Feb 27 10:25:35 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: Fix command line argument parsing to make
	the '-t' argument work. Signed-off-by: Saori Fukuta

Tue Feb 27 10:20:43 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Only hardcode port = 5900+domid if
	running against old XenD < 3.0.3, because in newer XenD
	port is guarenteed to be available in XenStore if the VNC
	server is running.

Mon Feb 26 15:33:08 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c, qemud/uuid.[ch]: move qemudParseUUID()
	into uuid.c

Mon Feb 26 15:31:23 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/uuid.[ch]: add uuid generation code

	* qemud/Makefile.am: build it

	* qemud/conf.c: generate a UUID if not specified in the XML

Mon Feb 26 15:20:56 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: qemudAutostartConfigs(): print the detailed
	error message from a guest/network autostart failure.

Mon Feb 26 14:20:18 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: check for malloc failure in GenerateXML()
	and GenerateNetworkXML()

	* qemud/driver.c: free the XML output after returning it
	from the DumpXML() commands.

Fri Feb 23 12:14:34 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/driver.c, qemud/internal.h, qemud/qemud.c, qemud/conf.c,
	qemud/conf.h: Added code to detect QEMU version number. Adapt
	command line construction code to use correct options for VNC
	and KQEMU based on version number

Fri Feb 23 10:52:23 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/Makefile.am: Fix up name of init script in EXTRA_DIST
	target.
	* libvirt.spec.in: Update path to libvirt_qemud and add the
	init script & post/pre scripts to register with chkconfig

Fri Feb 23 14:32:54 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: don't load config files unless they have
	a ".xml" suffix, e.g. backup files ... we spew a warning
	later if we do.

Fri Feb 23 12:49:11 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/libvirtd.in: add init script for libvirt_qemud

	* qemud/Makefile.am: install it unless we were configured
	with --with-init-scripts=none

	* configure.in: add --with-init-scripts to allow us
	have different flavour init scripts

Fri Feb 23 12:46:44 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: add --pid-file and default to writing
	out a PID file to /var/run/libvirt_qemud.pid in daemon
	mode.

	* configure.in: add --with-pid-file arg

Fri Feb 23 12:45:08 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/Makefile.am: install libvirt_qemud in /usr/sbin
	instead of /usr/libexec

	* src/Makefile.am, src/qemu_internal.c: pass the correct
	path to libvirt

Fri Feb 23 10:26:24 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/virsh.c: in "start" and "net-start" use e.g.
	vshCommandOptDomainBy() so that we actually get an
	error message if the domain/network isn't found.

Fri Feb 23 09:11:53 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: actually autostart guests/networks at startup
	as appropriate.

Fri Feb 23 09:08:02 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/internal.h: put the config directory paths in
	an array in order to make them easier to initialize,
	but still expose pointers to each of them as members
	in the server struct.

	* qemud/qemud.c: cleanup the config directory path
	initialization.

Fri Feb 23 09:03:19 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/driver.c: maintain the autostart flag on disk
	using symlinks from the "autostart" directories to
	the corresponding config files.

	* qemud/internal.h: add paths to the autostart links
	to the vm/network structures and paths to the autostart
	dirs to the server struct.

	* qemud/qemud.c: initialize the server autostart dir
	patches.

	* qemud/conf.h: expose qemudEnsureDir()

	* qemud/conf.c: check the autostart symlinks when
	loading config files at startup.

Fri Feb 23 09:00:13 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/protocol.h: add the (domain/network)(Get/Set)Autostart
	requests and replies to the protocol.

	* src/qemu_internal.c: hookup the qemu driver autostart
	methods

	* qemud/dispatch.c, qemud/driver.[ch], internal.h: add
	the daemon side, but just set an in-memory autostart
	flag for now.

Fri Feb 23 08:51:05 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/virsh.c: add "autostart" and "net-autostart" commands
	and cleanup the "list" and "net-list" commands a bit.

Fri Feb 23 08:49:12 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* include/libvirt/libvirt.h.in, src/libvirt.c add
	virDomainGetAutostart(), virDomainSetAutostart(),
	virNetworkGetAutostart() and virNetworkSetAutostart().

	* src/libvirt_sym.version: export the API

	* src/driver.h: add methods to the driver vtables.

	* src/proxy_internal.c,	src/qemu_internal.c,
	  src/test.c, src/xen_internal.c, src/xend_internal.c,
	  src/xm_internal.c, src/xs_internal.c: set those
	methods to NULL

Fri Feb 23 08:41:34 IST 2007 MarkMcLoughlin <markmc@redhat.com>

	* qemud/conf.[ch]: significantly re-factor qemudLoadConfigXML()
	so that "parse the XML", "assign the def to a VM" and
	"save the XML" operations are in separate functions.
	Add qemudRemoveInactiveVM() and qemudRemoveInactiveNetwork().
	Report errors when loading config files at startup. Check
	that a domain/network's name matches the config filename.

	* qemud/driver.c: update the Create() and Define() functions
	to explicitly parse/assign/save. Also, fix bug where if
	Create() failed, we would free the VM without removing it
	from the inactive list.

	* qemud/qemud.c: use qemudRemoveInactiveVM/Network()

Fri Feb 23 08:40:52 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/driver.[ch], qemud/dispatch.c: fix the fact that
	qemudDispatchDomainStart() doesn't report an error if the uuid
	lookup fails and also move the uuid lookup into the driver
	so that it matches the way we do Destroy().

Fri Feb 23 08:37:23 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c,	qemud/driver.c, qemud/internal.h,
	qemud/qemud.c: Merge the ->activevms and ->inactivevms
	into a single ->vms list in order to make things
	easier to manage. Likewise for networks. Also add
	qemudIsActiveVM() and qemudIsActiveNetwork() inline
	functions.

Thu Feb 22 14:06:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c, src/xend_internal.c: Re-arrange VM creation
	commands to ensure we destroy stillborn domains if device hotplug
	fails to complete. Fix deletion of inactive VMs from internal
	cache of domain configs.

Thu Feb 22 11:45:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/xs_internal.c: Refuse to do shutdown / reboot on
	Dom0 guest. Signed-off-by: Kazuki Mizushima
	<mizushima.kazuk@jp.fujitsu.com>

Thu Feb 22 10:37:08 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: fix another xml property leak.

Tue Feb 20 19:08:58 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: use strerror(errno) in some error messages
	to make them a bit more useful

Tue Feb 20 19:07:12 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: don't free active networks/vms if we
	fail to save the new config

Tue Feb 20 18:25:42 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* virsh.c: cmdNetworkList() re-indent this.

Tue Feb 20 17:49:22 IST 2007 Mark McLoughlin <markmc@redhat.com>

	Fix a few leaks

	* qemud/qemud.c: qemudCleanup(): free the socket
	structures

	* qemud/conf.c: fix various leaks in the xml parsing

	* qemud/iptables.c: fix a typo causing a leak

Tue Feb 20 16:49:53 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c, qemud/qemud.c: only create config dirs
	when actually trying to write out config.

Tue Feb 20 09:56:35 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/bridge.c: change the fix for the alignment warning
	a little.

Tue Feb 20 09:03:05 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: clean up qemudInitialize() and qemudListen()
	so as to coalesce the two "system vs. user" code paths and
	fix up some problems noticed by dan.

Mon Feb 19 16:59:18 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: don't shutdown guest and networks on
	SIGHUP

Mon Feb 19 16:58:53 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: handle SIGQUIT.

Mon Feb 19 09:38:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/bridge.c, qemud/conf.c: Fixed int -> char casts to deal
	with endianness / alignment issues on IA64 platforms. Patch
	from Atsushi SAKAI <sakaia@jp.fujitsu.com>

Fri Feb 16 18:28:32 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c, qemud/dispatch.c, qemud/internal.h
	qemud/conf.c, qemud/driver.c, configure.in: add a
	qemudLog() function which uses syslog() if we're in daemon
	mode, doesn't output INFO/DEBUG messages unless	the
	verbose flag is set and doesn't output DEBUG messages
	unless compiled with --enable-debug. Also, make a first
	pass through fatal errors and add error messages for them.

Fri Feb 16 18:26:55 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/internal.h, qemud/qemud.c: improve signal handling
	and handle SIGHUP by shutting down all guests and networks
	and re-loading configs, and handle SIGINT and SIGTERM
	by shutting down cleanly.

Fri Feb 16 18:24:08 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c, qemud/bridge.c, qemud/iptables.c: fix
	our FD_CLOEXEC usage so that all fds which should be
	closed on exec are marked as such and that we leave
	exec() to do the actual closing.

Fri Feb 16 18:23:15 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: fix qemudEnableIpForwarding() to not leak
	an fd if writing to /proc/sys/net/ipv4/ip_forward fails.

Fri Feb 16 11:56:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* tests/Makefile.am: Fixed linkage of test suites

Fri Feb 16 11:03:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/driver.h, src/proxy_internal.c, src/qemu_internal.c,
	src/test.c, src/xen_internal.c, src/xend_internal.c,
	src/xm_internal.c, src/xs_internal.c: Remove the unused
	'init' method from the internal driver API (from Rich Jones)

Fri Feb 16 10:36:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/internal.h, qemud/qemud.c, libvirt.spec.in: Remove
	mistaken references to gnutls.

Thu Feb 15 19:07:24 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: fix <interface type='network'> output

Thu Feb 15 19:06:56 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: fix the <graphics> output - we weren't
	handling sdl

Thu Feb 15 19:06:22 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: fix a couple of typos

Thu Feb 15 19:05:48 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: fix segfault

Thu Feb 15 19:04:10 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.h: move qemudFreeVMDef() down a bit

Thu Feb 15 16:00:05 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/bridge.c: don't output bridge parameters if they
	are the default.

Thu Feb 15 15:56:32 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.[ch], qemud/dispatch.c, qemud/internal.h,
	  qemud/qemud.c, qemud/driver.c: allow re-defining network
	configs; basically copying dan's patch for domains.

Thu Feb 15 15:47:46 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: fix a couple of qemud_vm_def leaks

	* driver.c: simplify qemudDomainDefine()

Wed Feb 14 17:01:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/qemud.c: Ensure we create the main libvirt config
	directory at startup

Wed Feb 14 16:47:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* qemud/conf.c: Fixed generation of <features> block, and
	don't include ID, or VNC port in inactive XML generation

Wed Feb 14 16:45:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_internal.c: Fixed path to the libvirt_qemud
	daemon for auto-start

Wed Feb 14 19:53:33 CET 2007 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: spec cleanup and missing BuildRequires
	* qemud/Makefile.am: avoid -Werror

Wed Feb 14 19:06:26 CET 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in NEWS include/libvirt/libvirt.h docs/* docs/apibuild.py:
	  prepare release of 0.2.0, update doc, avoid console module for API.
	* po/*: regenerated

Wed Feb 14 12:35:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* libvirt.spec.in: Added dep on libsysfs-devel. Pre-create
	the qemu config dir & socket dir.

Wed Feb 14 12:19:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemu_internal.c, qemud/qemud.c: Move configs into
	/etc/libvirt/qemu or $HOME/.libvirt/qemu and the socket into
	$HOME/.libvirt/qemud-sock or /var/run/libvirt/qemud-sock

Wed Feb 14 12:19:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: blacklist  vshRunConsole method from
	the python bindings

Wed Feb 14 12:17:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* po/libvirt.pot, po/*.po: Updated the i18n strings wrt to
	the recent code changes

Wed Feb 14 11:58:24 EST 2007 Daniel P. Berrange <berrange@redhat.com>

	* src/qemud.c, src/conf.c, src/internal.c, src/driver.c: Change
	the handling of the internal VM config to allow replacing of the
	config for a VM which is running.

Wed Feb 14 16:53:25 IST 2007 Mark McLoughlin <markmc@redhat.com>

	Fix from Richard W.M. Jones <rjones@redhat.com>

	* virsh.c: add a colon after the connect arg to
	getopt_long()

Wed Feb 14 16:48:24 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/qemu_internal.c: correctly register the network
	driver

Wed Feb 14 16:35:56 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* autogen.sh: run autoheader before automake

Wed Feb 14 16:23:25 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/iptables.[ch]: add code for managing iptables
	rules.

	* qemud/Makefile.am: add iptables.[ch].

	* qemud/qemud.c: add and remove iptables rules as
	appropriate.

	* qemud/conf.c: when starting a guess, add a rule
	allowing it to forward packets across the networks
	bridge.

	* qemud/internal.h: add iptables context ptr

	* configure.in: add --with-iptables-dir and
	--with-iptables-prefix to allow us to put our rules
	in a chain with the given prefix and save the rules
	in files in the given dir so as to integrate with
	the proposed "service iptables restart" solution
	in:

	   https://bugzilla.redhat.com/227011

Wed Feb 14 16:21:18 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/xml.c: with <interface type="network"> connect the
	Xen guest to the appropriate bridge.

Wed Feb 14 16:17:51 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* include/libvirt/libvirt.h.in, src/libvirt.c: add
	virNetworkGetBridgeName() to allow finding out what
	bridge to connect to in order to join a network.

	* src/driver.h: add networkGetBridgeName() to vtable.

	* qemud/protocol.h: add the request and reply to
	the qemud protocol.

	* qemud/dispatch.c, qemud/driver.[ch]: handle them
	here.

	* src/qemu_internal.c: implement GetBridgeName()
	in the qemu driver.

	* src/libvirt_sym.version: add new symbol.

Wed Feb 14 16:14:32 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/xend_internal.c, src/xm_internal.c: pass the
	connection to virDomainParseXMLDesc()

	* src/xml.[ch]: make virDomainParseXMLDesc accept
	a virConnectPtr so that we can use it later to
	lookup the bridge associated with a network

	* tests/xml2sexprtest.c: just pass NULL here, it's
	safe

Wed Feb 14 16:08:55 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: add support for connecting a qemu
	guest to a bridge using a tap device in order to
	connect it to a virtual network.

	* qemud/internal.h: add <interface type="network">
	config and track tapfds so as to not close them
	on exec.

	* qemud/qemud.c: don't close tapfds on exec and
	disconnect the iface when the guest shuts down.

Wed Feb 14 16:04:48 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c, qemud/internal.h: add dhcp config

	* qemud/qemud.c: start dnsmasq to provide dns/dhcp
	for virtual networks.

Wed Feb 14 16:02:23 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* configure.in: add --disable-bridge-params, check
	for libsysfs and various kernel headers

	* bridge.[ch]: add code for managing bridges

	* qemud/Makefile.am: add bridge.[ch] and link against
	libsysfs if enabled.

	* qemud/conf.c: add support for bridge config.

	* qemud/internal.h: add various bridging bits

	* qemud/qemud.c: implement qemudStartNetworkDaemon()
	and qemudShutdownNetworkDaemon().

Wed Feb 14 15:55:02 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.[ch]: implement parsing and saving network
	configs.

	* qemud/driver.c: flesh out the stubs

	* qemud/internal.h: add networks list etc. to
	struct qemud_server

	* qemud/qemud.c: add qemudStartNetworkDaemon() and
	qemudShutdownNetworkDaemon() stubs.

Wed Feb 14 15:52:34 EST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/protocol.h: add the protocol for virtual networks

	* qemud/dispatch.c: implement the protocol

	* qemud/driver.[ch]: add stubs for the driver

	* qemud/internal.h: add struct qemud_network

	* src/qemu_internal.c: add a virtual networks driver

Wed Feb 14 15:43:28 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/virsh.c: add the net-* commands.

Wed Feb 14 15:37:17 IST 2007 Mark McLoughlin <markmc@redhat.com>

	Note: potential ABI break here, but people should
	only really be using virError structs returned from
	libvirt itself.

	* include/libvirt/virterror.h: add virNetwork
	to virError

	* src/internal.h, src/virterror.c: add network param
	to __virRaiseError()

	* src/conf.c, src/hash.c, src/libvirt.c, src/proxy_internal.c,
	src/qemu_internal.c, src/sexpr.c, src/test.c, src/xen_internal.c,
	src/xend_internal.c, src/xm_internal.c, src/xml.c, src/xmlrpc.c,
	src/xs_internal.c: update.

Wed Feb 14 15:33:05 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* include/libvirt/libvirt.h.in: add the networks APIs

	* include/libvirt/virterror.h: add some error codes

	* src/driver.h: add network driver vtable

	* src/hash.c: add networks hash

	* src/internal.h: add virNetwork

	* src/libvirt.c: hook up the APIs to the network
	driver

	* src/libvirt_sym.version: add the new APIs

	* src/virterror.c: handle the new error codes

Wed Feb 14 15:07:26 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/conf.h: fix merge error - remove the argc argument
	from qemudBuildCommandLine()

Wed Feb 14 15:03:22 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/virsh.c: Re-name some of the VSH_DOMBYFOO stuff
	to VSH_BYFOO in order to re-use it for the network stuff.

Wed Feb 14 14:58:35 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/hash.c, src/internal.h: Re-name virConnect->domains_mux
	to virConnect->hashes_mux since it will also be used to
	protect the networks hash.

Wed Feb 14 14:57:52 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: qemudSaveConfig() will always report a
	more specific error, so	we should avoid overwriting
	this error.

Wed Feb 14 14:54:25 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/qemud.c: Re-factor out qemudExec() so that it can
	be used to launch dnsmasq.

	* qemud/conf.c: don't return argc from qemudBuildCommandLine()
	as exec() doesn't need it.

Wed Feb 14 14:52:12 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: Re-factor bits of conf.c so that:

	  - qemudMakeConfigPath() can be re-used given another configDir
	  - split qemudEnsureConfigDir() out of qemudSaveConfig() so
	    that it may be re-used to create another configDir
	  - split qemudScanConfigDir() out so that qemudScanConfigs()
	    can scan multiple configDirs

Wed Feb 14 14:50:22 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c: handle an unspecified MAC address,
	fix the argv freeing code in qemudBuildCommandLine()
	and fix copy and paste error in qemudGenerateXML()

Wed Feb 14 14:42:38 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/internal.h: add virConnect->qemud_fd so that
	xen and qemu don't share the handle member.

	* src/hash.c, src/qemu_internal.c: update

Wed Feb 14 14:40:52 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* qemud/conf.c, qemud/dispatch.c, qemud/driver.c,
	  qemud/qemud.c: include autoconf's config.h

Wed Feb 14 14:39:18 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* conf.[ch]: rename from config.[ch] so we can use
	autoconf's config.h

	* Makefile.am: update

	* driver.c, qemud.c: upd.

Wed Feb 14 14:33:22 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* autogen.sh: run autoheader

	* config.h.in: remove

Tue Feb 13 19:46:35 EST 2007 Daniel Berrange <berrange@redhat.com>

	* autobuild.sh: Run coverage tests during automated build
	* autogen.sh: Point aclocal at m4 directory explicitly
	* configure.in: Added command line arg to enable coverage
	* Makefile.am: Added scripts directory
	* src/Makefile.am: Build with coverage testing if requested
	and add target for extracting coverage data
	* scripts/*: Helper tools for coverage testing
	* tests/Makefile.am: Make tests link to object files instad
	of the static library to ensure single output dest for
	coverage data when running tests

Tue Feb 13 19:29:35 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/qemu_internal.h, src/qemu_internal.c, src/Makefile.am,
	src/driver.h, src/libvirt.c: Added a new driver to talk to
	the QEMU daemon

	* src/virterror.c, include/libvirt/virterror.c: Added new
	error domain for QEMU.

	* qemud/*: Added a daemon service for managing QEMU machines
	via the libvirt qemu_internal driver

	* src/virsh.c: use a read-write connection by default for QEMU
	urls.

	* configure.in, Makefile.am: Added qemud subdirectory.

Thu Feb  8 12:59:14 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/xml.c, src/xend_internal.c, src/xend_internal.h: Remove
	obsolete / unused code.

Wed Feb  7 11:30:14 EST 2007 Daniel Berrange <berrange@redhat.com>

	* autobuild.sh, src/Makefile.am: Added a control file for
	automating build and test processes

Wed Feb  7 07:43:21 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/xml.c, tests/xml2sexprdata/*.sexpr: Also include the
	vcpu info in the (image (hvm))  part of the SEXPR for fully
	virt guests, so it gets passed on into QEMU.

Wed Feb  7 07:40:21 EST 2007 Daniel Berrange <berrange@redhat.com>

	* configure.in, tests/Makefile.am: Only enable the low level
	Xen tests if XenD is actually running & accessible via the
	UNIX socket

Sun Jan 28 14:44:23 EST 2007 Daniel Berrange <berrange@redhat.com>

	* sc/console.c, src/console.h, src/virsh.c: Rename the
	virRunConsole method to vshRunConsole to avoid it getting
	picked up in auto-generated python bindings

Fri Jan 26 07:59:52 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/virshtest.c: Fixed up for new way test driver enumerates
	domains

Fri Jan 26 06:53:52 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/virshc: Added 'console' and 'vncdisplay' commands to
	the virsh tool
	* src/console.c, src/console.h: Impl of a simple interactive
	serial console

Fri Jan 26 12:48:13 CET 2007 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: Richard W.M. Jones pointed out a missing option
	  in getopt_long()

Fri Jan 26 12:09:49 CET 2007 Daniel Veillard <veillard@redhat.com>

	* autogen.sh: applied patch from Richard W.M. Jones to not
	  output instructions if configure failed

Mon Jan 23 14:36:18 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* include/libvirt/libvirt.h.in: add VIR_UUID_BUFLEN and
	VIR_UUID_STRING_BUFLEN

	* libvirt/proxy/libvirt_proxy.c, libvirt/src/hash.c,
	libvirt/src/internal.h,	libvirt/src/libvirt.c,
	libvirt/src/proxy_internal.c, libvirt/src/test.c,
	libvirt/src/virsh.c, libvirt/src/xend_internal.c,
	libvirt/src/xm_internal.c, libvirt/src/xml.c,
	libvirt/python/libvir.c: use them

Mon Jan 23 12:28:42 IST 2007 Mark McLoughlin <markmc@redhat.com>

	Issues pointed out by Karel Zak <kzak@redhat.com>

	* src/virsh.c: fix up some syntax strings, use BUFSIZ
	and free names returned from virConnectListDefinedDomains()

Mon Jan 22 15:41:52 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/virsh.c: Fix crash in 'connect' command by ensuring
	we always strdup the connection URI string.

Mon Jan 22 16:23:52 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/internal.h: virDomain.handle refers to the "id"
	in the API, so re-name to virDomain.id to avoid
	confusion.

	* src/hash.c, src/libvirt.c, src/proxy_internal.c, src/test.c,
	src/xen_internal.c, src/xend_internal.c, src/xm_internal.c,
	src/xml.c, src/xs_internal.c: update for rename.

Mon Jan 22 16:17:25 IST 2007 Mark McLoughlin <markmc@redhat.com>

	* src/driver.h: remove Free(), GetName(), GetID() and
	GetUUID() driver methods.

	* src/proxy_internal.c,	src/test.c, src/xen_internal.c,
	src/xend_internal.c, src/xm_internal.c,	src/xs_internal.c:
	Update driver vtables.

Mon Jan 22 16:24:54 CET 2007 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/*.html include/libvirt/libvirt.h:
	  preparing release of 0.1.11
	* docs/Makefile.am libvirt.spec.in: package libvirt.rng in
	* po/*: translation update

Fri Jan 19 15:28:13 EST 2007 Daniel Berrange <berrange@redhat.com>

	* tests/xmconfigtest.c: Test suite to check conversion from
	XML to XM config files, and the reverse
	* tests/xmconfigdata/*.xml: Source XML files for the test
	suite
	* tests/xmconfigdata/*.cfg: Source XM config files for the
	test suite
	* configure.ac, tests/Makefile.am: Added xmconfigdata subdir
	* tests/xmconfigdata/Makefile.am: Include config files when
	doing a make dist.

Fri Jan 19 15:23:13 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/xm_internal.c: Finished off the conversion from XML
	to XM config files, and the reverse, to deal with all known
	libvirt guest config options.

Fri Jan 19 15:07:13 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/conf.c: Free stored config parameters, when free'ing
	the virConfPtr object. For values, only free the object
	corresponding to the values' type

Thu Jan 18 16:12:13 EST 2007 Daniel Berrange <berrange@redhat.com>

	* docs/testnode.xml, docs/testdomfc4.xml: Tweak memory settings to
	be more realistic for testing purposes

Thu Jan 18 16:05:13 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/test.h, src/test.c: Implement full inactive domain management
	support in mock hypervisor to allow testing of apps wanting inactive
	domains.

Thu Jan 18 13:37:02 EST 2007 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Tweak some of the new inactive domain methods
	to only run when XenD is >= 3.0.4, so it falls back correctly to
	the src/xm_internal.c driver.

Wed Jan 10 16:20:02 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvirt.rng: udated for the upcoming KVM and QEmu support

Wed Jan 10 11:06:36 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvirt.rng: went through the existing tests with the RNG and
	  fixed or added a number constructs

Tue Jan  9 17:28:18 CET 2007 Daniel Veillard <veillard@redhat.com>

	* docs/libvirt.rng: first version of the Relax-NG schemas to validate
	  XML instances

Wed Dec 20 15:56:38 CET 2006 Daniel Veillard <veillard@redhat.com>

	* po/*: updated localization files
	* configure.in NEWS libvirt.spec.in docs/libvir.html docs/news.html
	  include/libvirt/libvirt.h: preparing release of 0.1.10

Tue Dec 19 12:26:53 EST 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/xm_internal.c: Maintain hash of config filenames, separate from
	hash mapping domain names to config files. This deals with case of two
	config files specifying same named guest, which although not recommended
	seems to be encountered 'in the wild'.

Mon Dec 18 23:11:53 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: Dan Berrange pointed out a ref count bug
	  rhbz#143946 , patch applied

Thu Dec 14 10:58:00 CET 2006 Daniel Veillard <veillard@redhat.com>

	* po/*.po po/libvirt.pot: merged new ms transations, updated
	  with the current source.

Wed Dec 13 17:24:03 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Implement the ListDefinedDomains,
	NumOfDefinedDomains, DomainCreate ,DomainDefineXML, DomainUndefine
	APIs to manage inactive domains when running with Xen 3.0.4.  Make
	GetMaxMemory,  SetMaxMemory, SetMemory, GetInfo, SetVCPUs & DumpXML
	work with inactive domains. Cache xendConfigVersion when first
	connecting to Xend.
	* src/xend_internal.h: Prototypes for new APIs
	* src/xm_internal.c: Updated for new way of getting xendConfigVersion
	data
	* src/internal.h: Added xendConfigVersion field for virConnect struct

Tue Dec 12 09:05:03 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Added support for vnclisten parameter
	in generated XML
	* src/xml.c: Support new style paravirt framebuffer graphics
	configuration from xen 3.0.4 tree. Also add support for setting
	vncpasswd & vnclisten address SEXPR values, based on passwd
	and listen XML attributes.
	* tests/sexpr2xmltest.c: Whitespace cleanup.
	* tests/xml2sexprtest.c: Added test cases for new style paravirt
	framebuffer graphics configuration
	* tests/xml2sexprdata/xml2sexpr-pv-vfb*: Data files for new
	tests for graphics
	* tests/sexpr2xmldata/sexpr2xml-pv-vfb-*.xml: Added listen address
	attribute

Thu Dec  7 12:28:03 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Add bounds checking in xenDaemonListDomains to
	avoid overflowing the 'ids' array.

Wed Dec  6 17:46:03 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Support parsing of new paravirt framebuffer
	graphics configuration from xen 3.0.4 tree.
	* test/sexpr2xmltest.c: Added test cases for new & old framebuffer
	config parsing in paravirt & fullyvirt.
	* test/sexpr2xmldata/sexpr2xml-pv-vfb-*: New test data files

Wed Dec  6 17:40:03 EST 2006 Daniel Berrange <berrange@redhat.com>

	* test/xml2sexprdata/xml2sexpr-curmem.xml, test/xml2sexprdata/xml2sexpr-curmem.sexpr:
	Fix test case to reflect recent change to bootloader/image handling

Wed Dec  6 15:06:28 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: the structure passed to the vcpuinfo hypercall
	  had changed between version 1 and version 2 too, the leading domain
	  field disapeared since it goes in the including op. Fixes redhat
	  bugs #217370 and #217743

Mon Dec  4 17:47:03 CET 2006 Daniel Veillard <veillard@redhat.com>

	* po/ca.po po/fr.po po/hi.po: merging more localizations coming
	  from Red Hat

Wed Nov 29 13:13:39 CET 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in libvirt.spec.in docs/libvir.html docs/news.html
	  include/libvirt/libvirt.h: preparing libvirt-0.1.9 release
	* po/*.po: more updates and fix all the .po to not barf when msgfmt
	  tries to process them

Tue Nov 28 13:15:00 CET 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in: update for ALL_LINGUAS
	* po/*.po: updated with strings from Red Hat translators

Mon Nov 27 23:27:26 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: patch for rhbz#214741, when using pygrub
	  do not push the os image information for domain creation
	  via xend

Wed Nov 22 17:57:58 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs//*: regenerated
	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in src/driver.h
	  src/libvirt.c src/proxy_internal.c src/test.c src/virsh.c
	  src/xen_internal.c src/xend_internal.c src/xm_internal.c
	  src/xs_internal.c: added support for dumping core of domains
	  assuming a xend with the latest patch to do so.

Tue Nov 21 18:05:33 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xs_internal.c: Michel Ponceau pointed out a bug in
	  xenStoreDomainGetNetworkID refactoring

Mon Nov 20 16:51:43 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c src/xs_internal.c src/xs_internal.h: cleanup for the
	  dynamic device code to isolate as a separate function
	  xenStoreDomainGetNetworkID() the access to the XenStore

Thu Nov 16 19:36:12 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xm_internal.c: Add support for device_model parameter to
	make HVM guests work. Also support serial console in HVM, since
	it needs to be explicitly turned on, unlike PV.

Thu Nov 16 18:16:42 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xml.c: Mark 'msg' parameter in XML error handler as unused.
	Fix device id lookup code to use unsigned integers avoid type
	mis-matches.

Thu Nov 16 13:09:42 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/Makefile.am: Added new xm_internal.c source file
	* src/libvirt.c: Call the xenXMRegister() method to activate
	the XM backend
	* src/driver.h: Added a unique id for XM driver backend
	* src/internal.h:  Increase number of drivers allowed
	* src/xm_internal.h, src/xm_internal.c: New driver for
	managing inactive domains from /etc/xen config files

Thu Nov 16 18:18:12 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/driver.h src/libvirt.c src/libvirt_sym.version
	  src/proxy_internal.c src/test.c src/xen_internal.c
	  src/xend_internal.c src/xml.c src/xml.h src/xs_internal.c:
	  intagrated patch from Michel Ponceau to add hot-plug devices
	  support to the API, integrated in driver API and fixed
	  a few small things. Still a TODO in src/xml.c about
	  moving xenstore direct accesses to a new routine.

Wed Nov 15 18:23:13 EST 2006 Daniel Berrange <berrange@redhat.com>

	* python/generator.py, python/libvir.c, python/libvirt-python-api.xml:
	Added binding for virConnectListDefinedDomains API.

Wed Nov 15 15:08:13 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xen_internal.c, src/xs_internal.c, src/xend_internal.c,
	src/proxy.c: Don't try to invoke APIs if domain is is < 0, letting
	these inactive domains be handled by other driver backend.
	* src/xend_internal.h: make xend_config_version() api available
	to other drivers

Wed Nov 15 14:59:13 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/hash.c, src/hash.h: Added three new methods for iterating
	over hashtable entries, virHashForEach, virHashRemoveSet &
	virHashSearch.

Wed Nov 15 14:52:01 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/conf.c, src/conf.h: Add two new APIs virConfNew() and
	virConfSetValue() for creating & populating new config objects
	in memory instead of from a file

Wed Nov 15 14:42:01 EST 2006 Daniel Berrange <berrange@redhat.com>

	* python/libvir.c, python/libvirt_wrap.h, python/types.h: Ensure
	that  unsigned longs are marshalled to python Long type instead
	of Int, to avoid 32-bit integer wraparound

Tue Nov 14 18:42:01 EST 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Added support for parsing non-bridge style
	networking configs for guests.
	* src/xml.c: Ensure the <ip address> element gets serialized to
	the SEXPR for non-bridged networks.
	* tests/xml2sexprtest.c, tests/sexpr2xmltest.c: Added new tests
	covering different networking configs
	* tests/xml2sexprdata/, tests/sexpr2xmldata/: Added more data
	files for new test cases

Mon Nov 13 17:18:00 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xml.c: fix for shareable drive support
	  rhbz#214908

Fri Nov 10 17:53:41 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xml.c: Fix memory leak, by freeing xmlParserContextPtr object

Fri Nov 10 11:19:32 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xml.c: add an extra element currentMemory
	  to the XML description and handle its serialization back and
	  forth between XML and S-Expr
	* tests/sexpr2xmltest.c tests/xml2sexprtest.c
	  tests/sexpr2xmldata/sexpr2xml-curmem.*
	  tests/xml2sexprdata/xml2sexpr-curmem.*: added specific regression
	  tests for this, this didn't disturb any of the other tests.

Thu Nov  9 15:39:19 CET 2006 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: changed the generator to generate a reference
	  from Domain class instances to the Connect they were issued from
	  should fix rhbz#204490
	* docs//*: rebuilt

Thu Nov  9 10:22:43 CET 2006 Daniel Veillard <veillard@redhat.com>

	* tests/reconnect.c: fixed the reconnect test when running as non-root

Wed Nov  8 13:03:41 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/virshdata/nodeinfo-custom.txt, docs/testnode.xml: Reduce amount
	of RAM in test node to a sensible size to avoid integer wraparound on
	32-bit archs.

Wed Nov  8 13:00:56 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/test.c, src/test.h: Added implementation of the virDomainGetOSType
	driver method to the test hypervisor backend.

Wed Nov  8 16:58:56 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/virterror.h src/virterror.c src/xend_internal.c
	  src/xml.c: give proper indication of the failures raised by the
	  XML parser on not well formed XML, should fix rhbz#208545

Wed Nov  8 14:01:11 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/proxy_internal.c src/xs_internal.c: fix the
	  patch for rhbz#214264 in the case of Domain 0 on Xen and push the
	  defaulting to "linux" down to the xen specific parts.

Tue Nov  7 16:17:23 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* python/generator.py: Pass in connection object when generating
	an exception
	* python/libvir.py: Allow raw error object to be passed into the
	python exception object.
	* python/libvir.c: Added binding for virGetLastError and
	virConnGetLastError

Tue Nov  7 15:58:43 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Ensure that virConnectPtr object is passed
	around to all functions which can throw errors, so that errors get
	correctly associated with the connection, rather than global error
	variables.

Tue Nov  7 16:33:43 CET 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: libvirt-devel depends on pkgconfig
	* proxy/libvirt_proxy.c src/libvirt.c src/proxy_internal.[ch]
	  src/xs_internal.[ch]: the virtGetOsType entry point was calling
	  the xenstore directly instead of going though driver, refactored
	  and implemented a specific new RPC with the proxy when this is
	  called as non-root fixes rhbz#214264 .

Tue Oct 31 10:31:34 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: when getting informations about a non
	  existant domain, it is not a good idea to raise the HTTP
	  404 GET error, the handling is better done somewhere up in
	  the stack.

Tue Oct 24 15:31:23 EDT 2006 Daniel P.Berrange <berrange@redhat.com>

	* python/generator.py, python/libvir.c: Drop python interpreter
	lock when calling into C functions, and re-grab when invoking
	error callback.
	* python/libvirt_wrap.h: Convenience macros for grabbing / dropping
	the python interpreter lock in threaded environment.


Mon Oct 16 17:10:15 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* config.h.in configure.in libvirt.spec.in docs/libvir.html
	  docs/news.html include/libvirt/libvirt.h: preparing release of
	  libvirt-0.1.8
	* src/xen_internal.c: fixed a compilation problem

Thu Oct 12 17:31:13 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: one of the fix for system with page size != 4k
	  was missing

Thu Oct 12 13:37:24 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: applied patch from Philippe Berthault
	  fixing the vcpu number initialization

Wed Oct 11 17:16:44 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: applied patch from Peter Vetere so that
	  crashed domains ain't reported as shut off.

Wed Oct 11 16:23:58 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* virsh.1: fixed some typo and unclear language pointed out by
	  Noriko Mizumoto

Mon Oct  9 09:34:42 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/xml.c, src/xend_internal.c: Added support for a <driver>
	element in disk specification, allowing use of alternate Xen
	drivers such as blktap.
	* tests/xml2sexprtest.c, tests/sexpr2xmltest.c: Added tests for
	new <driver> element, and blktap driver impl.
	* tests/xml2sexprdata/*, tests/sexpr2xmldata/*: New / updated
	data files for new <driver> element

Fri Oct  6 10:33:20 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Fixed memory leak in xend_get_config_version
	routine.
	* src/xml.c: Fixed memory leaks in XML parsing routines relating
	to VNC port, HVM boot devices, HVM floppy & CDROM, HVM features,
	disk device type.
	* tests/Makefile.am: Use --leak-check=full when running valgrind
	to detect all leaks, in addition to memory corruption checks
	* tests/sexpr2xmltest.c, tests/xml2sexprtest.c: Fixed memory leaks
	in test harness leading to valgrind false-positives.

Mon Oct  2 23:16:06 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: Daniel Berrange fixed some mlock size problem
	  doing a bit of cleanup too

Fri Sep 29 17:31:36 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: add #include <locale.h> to be able to compile without
	  optimization

Fri Sep 29 17:16:40 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: fix for system with page size != 4k

Fri Sep 29 13:05:12 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* docs/bugs.html docs/libvir.html: added pointers on how to report
	  bugs in bugzilla as suggested by markmc
	* src/xend_internal.c: first step for #208545 raise an error at the
	  libvirt level

Fri Sep 29 11:27:36 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* docs/* libvirt.spec.in configure.in NEWS: preparing release of 0.1.7

Thu Sep 21 10:19:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xen_internal.c: Fork different version of getdomaininfo struct for
	Xen 3.0.2, and 3.0.3 because the shared_info_frame field is different
	size on between these versions on 32-bit platforms. Make callers use
	appropriate struct version matched to hypervisor version, hiding detail
	in macros to aid readability. Cleanup whitespace to remove tabs. Disable
	xenHypervisorGetVcpus completely in proxy since its not used.

Thu Sep 21 10:19:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Check if the physical CPU will fit in the maplen
	provided by the caller when populating VCPU<->CPU mapping. This is because
	XenD will return data for 32 physical CPUs, even if the box only has 4
	CPUs. The caller of course will only have allocated a map big enough for
	the actual number of physical CPUs. We simply check against maplen param
	supplied by caller & discard info about CPUs which don't fit. Also santise
	whitespace.

Fri Sep 22 11:02:48 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* docs/* libvirt.spec.in configure.in NEWS: preparing release of 0.1.6

Thu Sep 21 10:19:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* Makefile.am: Added po directory
	* autogen.sh: Call autopoint to install the gettext infrastructure
	* src/*.c, proxy/*.c: Pass all strings through gettext for translation.
	Set up the text domains in libvirt, proxy & virsh at startup.
	* libvirt.spec.in: Include compiled .po files in distro
	* tests/virshdata/*.txt: Tweak expected data to take account of
	some text changes.

Thu Sep 21 10:19:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* docs/*.html: re-generated documentation to pull in latest
	APIs

Thu Sep 21 10:19:01 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am: add a tst target to ease building test progs
	* src/xend_internal.c: fix the reconnection problem to xend pointed
	  by Philippe Berthault
	* tests/Makefile.am tests/reconnect.c: add a specific test case

Tue Sep 19 16:59:53 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: applied patch from Jim Fehlig, about
	  one of the content of the hypercall structures in 3.0.2

Thu Sep 14 10:33:23 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xml.c: Append :disk for normal disk devices being created
	when Xen >= 3.0.3, even though its technically optional
	* src/xend_internal.c: Strip the :disk trailing component when
	generating XML when Xen >= 3.0.3. We don't want to expose
	that postfix in the <target> element, since its already set in
	the device attribute on <disk> element.
	* tests/sexpr2xmldata/*, tests/xml2sexprdata/*: Update to test
	for handling of :disk postfix in sexpr/XML
	* tests/virshtest.c, tests/sexpr2xmltest.c, tests/xml2sexprtest.c:
	Cast size_t arg to an int to avoid format warnings from printf

Tue Sep 11 20:37:28 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xml.c: Added support for setting VNC port when creating
	domains with new (version 2) style XenD config
	* tests/xml2sexprtest.c: Added test for setting VNC port
	* tests/xml2sexprdata/*vncunused*: Data files for new VNC test

Tue Sep 11 20:23:42 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* docs/Makefile.am: Added test XML files to EXTRA_DIST
	* tests/confdata/Makefile.am: Fix typo to ensure config
	files needed by test are distributed

Tue Sep 11 20:11:05 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c, src/xml.c: Added support for new 3.0.3
	style XenD cdrom configuration for HVM guests.
	* configure.in, tests/Makefile.am: Added new test directories
	* tests/xml2sexprdata*, tests/sexpr2xmldata*: Removed config files
	for test suite.
	* tests/xml2sexprdata/*, tests/sexpr2xmldata/*: New home for test
	suite config files

Tue Sep  5 13:50:05 MYT 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in docs//* include/libvirt/libvirt.h libvirt.specx.*:
	  preparing release 0.1.5
	* proxy/libvirt_proxy.c src/xen_internal.c: tiny fixes

Tue Sep  5 13:24:30 MYT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: finished to convert to the new hypervisor
	  calls the xenHypervisorGetVcpus entry point, though it is untested

Mon Sep  4 14:13:24 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xen_internal.h: Added missing return(-1) statements
	in xenHypervisorGetVcpus and xenHypervisorPinVcpu methods.
	#ifndef out the pause/resume/etc methods from proxy code

Sun Sep  3 12:50:12 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/conf.c: Allow '_' in variable names, and don't fail if there
	is a trailing ',' at the end of a list.
	* tests/confdata/fc4.conf, tests/confdata/fc4.out: Expand test
	config to include a '_' in a name, and a trailing ',' in a list.

Sun Sep  3 12:47:42 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* tests/.cvsignore, tests/confdata/.cvsignore: Ignore autogenerated
	files from config data testsuite.

Sun Sep  3 12:34:23 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/virsh.c: use the return value of virConnectListDomains when
	iterating over list of ids/names, because it is not neccessarily
	the same as the value returned by virConnectNumOfDomains. Use qsort
	to sort active domains by Id, and inactive domains by name, since
	there is no guarenteed sort ordering when listing domains. For inactive
	domains display a '-' instead of '-1' to make it clear they have no
	sensible ID number.

Sat Sep  2 22:28:18 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: converting to handle the new incompatible
	  hypercalls while still able to detect older versions, lot of
	  work, seems okay, there is just one function not yet converted
	* src/xs_internal.c: dropping virConnectCheckStoreID()

Wed Aug 30 09:34:45 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/virsh.c: Added --all & --inactive flags to list command to control
	inclusion of inactive domains in listing. Added start, define, undefine
	commands to allow management of inactive domains.

Wed Aug 30 09:30:23 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/driver.h: Defined new driver entry points for ListDefinedDomains,
	NumOfDefinedDomains, DomainStart, DomainUndefine, DomainDefineXML.
	* src/xen_internal.c, src/xend_internal.c, src/xs_internal.h,
	src/test.c, src/proxy_internal.c: Added NULL entries for new driver
	backend APIs.
	* src/libvirt.c: Hook up new driver entry points to corresponding
	public API.
	* src/libvirt_sym.version: Added  virConnectNumOfDefinedDomains and
	previously missing virConnectListDefinedDomains
	* include/libvirt/libvirt.h: Added virConnectNumOfDefinedDomains

Tue Aug 29 23:48:43 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/conf.c: add missing entry point virConfGetValue()

Tue Aug 29 23:28:31 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* TODO libvirt.spec.in: update
	* configure.in include/libvirt/virterror.h src/Makefile.am
	  src/conf.c src/conf.h src/virterror.c src/xen_internal.c:
	  adding a subset of Xen config file parser, and serializer
	* tests/Makefile.am tests/conftest.c tests/test_conf.sh
	  tests/confdata/Makefile.am tests/confdata/fc4.conf
	  tests/confdata/fc4.out: adding test program for config in and out

Tue Aug 29 13:14:20 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Add handling of HTTP 500 error code
	which can be returned by XenD do indicate failure error when
	performing the requested operation (Identified by Pete Vetere).

Tue Aug 29 15:41:46 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* python/libvir.c: Pete Vetere pointed out a bug in string cast
	  when handling errors in Python

Sat Aug 26 16:36:15 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/sexpr.c src/sexpr.h src/xend_internal.c src/xml.c: applied
	  patch from Jeremy Katz to add graphical console for PV Xen guests

Sat Aug 26 00:17:24 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* docs/site.xsl docs/*.html: add links to virt-manager

Fri Aug 25 17:42:12 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/virsh.c: Allow VIRSH_DEFAULT_CONNECT_URI to be set to
	override the default Xen connection attempt in favour of a
	different backend. Fix 'virsh list' so that it doesn't assume
	there is always a Domain-0 (a Xen-ism).

Thu Aug 24 16:43:47 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* tests/virshtest.c: Test suite for validating output / operation
	of various virsh commands.
	* tests/virshdata/*.txt: Known good output for validating results
	during testing
	* tests/testutils.h, tests/testutils.c: Added convenience method
	for forking a child process & capturing its output.
	* tests/Makefile.am: Enable POSIX / XOpen standards

Thu Aug 24 11:03:42 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* tests/Makefile.am: Added a 'valgrind' target which simply
	calls 'make check', but wrapping execution with valgrind to
	detect any errors

Thu Aug 24 10:04:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* tests/xml2sexpr.c, tests/sexpr2xml.c: New tests suites for
	validating the SEXPR<->XML conversion
	* tests/*.sexpr, tests/*.xml: Data files for test suite
	* src/xend_internal.h, src/xend_internal.c: Expose the method
	for converting SEXPR -> XML to allow use by unit tests
	* src/xs_internal.c: Check if connection is NULL before
	deferencing it - test suite passes in NULL.

Mon Aug 21 13:00:03 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/virsh.c: check return code of virConnectListDomains in case
	there was a failure, and stop the 'list' command immediately
	rather than continuing with bogus domain ID data.

Fri Aug 18 15:22:23 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xml.c: fix networking in paravirt guests - only set the
	'(type ioemu)' option for HVM.

Thu Aug 17 19:42:50 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: fix virParseUUID()

Wed Aug 16 19:07:52 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in doc//* include/libvirt/libvirt.h
	  include/libvirt/libvirt.h.in: preparing release of 0.1.4,
	  regenerated docs, fixed a few things
	* src/proxy_internal.c src/test.c src/xend_internal.c:
	  a few trivial fixes

Wed Aug 16 12:33:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/virsh.c: Added 'setvcpus', 'setmem', 'setmaxmem'
	commands to virsh shell. Allow full read-write connection
	to non-Xen test hypervisor.

Wed Aug 16 11:38:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/test.c, src/test.h: Allow a hypervisor config to be
	loaded from an external XML file. Implement drivers for
	setMemory, setMaxMemory, createLinux, dumpXML, setVcpus.
	* docs/testnode.xml, docs/testfc4.xml, docs/testfv0.xml:
	Example config for using with test driver

Wed Aug 16 11:36:21 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c, src/xml.c, src/xml.h: Refactored the
	sexpr_uuid method into a re-usable virParseUUID method which
	can be used by any backend

Wed Aug 16 11:31:59 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/libvirt.c: Remove some duplicated changes for VIR_DOMAIN_RO
	accidentally left in place from last checkin. Tell the drivers to
	be 'quiet' when opening a RW connection, to stop XenD driver
	complaining when we open the test driver.

Wed Aug 16 17:24:59 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/virterror.h src/libvirt.c src/virterror.c: enforce
	  blocking operations with side effect on read-only connections. Adds
	  a new error code and message.

Tue Aug 15 11:55:15 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xml.c, src/xend_internal.c: Added a <features> block
	to XML allowing enablement of guest CPU / system features.
	Currently support PAE, ACPI, APIC for HVM domains.
	* docs/libvir.html: Documented new <features> block and those
	features enabled for HVM guests

Mon Aug 14 10:55:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* docs/libvir.html, docs/format.html: Updated description of
	HVM boot device, and disk device configuration to match up
	new new behaviour from previous changes

Fri Aug 11 09:37:02 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/libvirt.c: Avoid duplicated attempts to shutdown or
	pause a domain if the first attempt succeeded.
	* src/xend_internal.c, src/xml.c: When parsing UUID from
	SEXPR also allow for format without any embedded '-'. The
	ioemu: prefix is no longer required for HVM domains. It is
	added when generating SEXPR, and removing when parsing SEXPR
	never appearing in XML. CDROM & floppy devices for HVM domains
	are now included in XML under <devices><disk> tag. The <disk>
	tag now has a 'device' attribute allowing one of 'floppy',
	'cdrom', 'disk' to be specified. If the <console> tag is present
	in XML, HVM domains get a serial console activated. <boot>
	tag now expects one of 'fd' 'hd' or 'cdrom' when specifying
	boot device preference. Increased size of XML doc buffer from
	1k to 4k to deal with large numbers of devices

Fri Aug 11 13:08:01 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in: updated python detection code from latest libxml2 one
	* docs//*: rebuilt the docs

Thu Aug 10 15:28:52 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: markmc pointed out that using number(xpath) could lead
	  to NaN and following comparison would be wrong in a couple of places
	  if the element looked at was missing.

Wed Aug  9 10:17:03 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/driver.h, src/libvirt.c: Made the virDomainGetXMLDesc
	method use the driver backends.
	* src/xend_internal.c: Surround all functions which are not
	needed for proxy with #ifndef PROXY. Refactor XML generator
	functions to allow calling from proxy based on domain id
	instead of virDomainPtr object
	* src/xs_internal.c, src/xs_internal.h: Change signature
	of method for extracting VNC port & console TTY to use domain
	id instead of virDomainPtr. Surround functions not used by
	proxy in #ifndef PROXY
	* src/xml.c:Surround functions not used by proxy in #ifndef PROXY
	* src/test.c, src/xen_internal.c: Added NULL entry for new
	driver method for fetching XML
	* src/proxy_internal.c, src/proxy_internal.h, proxy/libvirt_proxy.c:
	Added implmentation of virDomainGetXMLDesc driver method which
	goes via proxy.

Tue Aug  8 23:24:51 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/driver.h src/libvirt.c src/proxy_internal.c src/test.c
	  src/xen_internal.c src/xend_internal.c src/xend_internal.h
	  src/xml.c src/xs_internal.c: cleanups, force the new vCPU
	  and affinity entry point to go though the driver framework,
	  and fix a few warning showing up in my pedantic environment.

Mon Aug  7 18:33:45 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Added details of serial console TTY to XML
	representation of domain. Fetch VNC port from xenstore if it is
	available (only in xen 3.0.3 or later).
	* src/xs_internal.c, src/xs_internal.h: Added APIs for retrieving
	the serial console TTY and VNC server port from xenstore.
	* docs/libvir.html: Document 'port' attribute for VNC graphics,
	and '<console>' element for serial console.

Mon Aug  7 21:57:41 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated with new items

Mon Aug  7 14:57:12 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Corrected string length calculation when
	  appending a CDROM boot device element. Fixes corrupt XML structure.

Mon Aug  7 11:06:20 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: Added a 'port' attribute to the '<graphics>'
	tag when display type is VNC, providing the port number on which
	the VNC server is listening.

Mon Aug  7 18:47:48 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h.in: previous change to libvirt.h should
	  have gone on .in too

Fri Aug  4 20:19:23 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/libvirt.c: Fix off-by-one in validated VCPU number (it is
	zero based, not one based).
	* include/libvirt/libvirt.h: Add some convenience macros for
	calculating neccessary CPU map lengths & total host CPUs
	* src/virsh.c: Add 'vcpuinfo' and 'vcpumap' commands

Fri Aug  4 14:45:25 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* python/generator.py: fix the generator when handling long integers
	  Dan Berrange reported problems due to this when using
	  virDomainSetMemory bindings

Fri Aug  4 11:49:44 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt/libvirt.h include/libvirt/libvirt.h.in
	  src/libvirt.c src/libvirt_sym.version src/xen_internal.c
	  src/xen_internal.h src/xend_internal.c src/xend_internal.h:
	  applied patch from Michel Ponceau and Philippe Berthault for
	  virtual CPU and affinity support plus a bit of cleanup.

Tue Aug  1 16:22:52 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: xen is now built for ia64, c.f. RH#199685

Fri Jul 28 16:18:30 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/virterror.c: Hugh Brock pointed out that error message
	  for bad argument were wrong and incomplete, this should fix it and
	  a few other problems in error reporting

Mon Jul 24 14:34:15 IST 2006 Mark McLoughlin <markmc@redhat.com>

	* libvirt.spec.in: sync changes from fedora CVS

Thu Jul 20 09:05:15 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* proxy/Makefile.am src/xen_internal.c src/xend_internal.c: cleanup
	  code when compiled for the proxy, changed the command line macro and
	  remove warnings.

Wed Jul 19 17:26:48 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/*.c: Bulk replace 'informations' with 'information' to
	correct English spelling

Thu Jul 13 23:33:48 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: applied patch from Peter Vetere to pass down the
	  UUID from the XML description if present when creating the domain.

Tue Jul 11 18:03:51 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/* NEWS: preparing release of
	  libvirt-0.1.3
	* src/xend_internal.c: uninitialized var and disable TCP slow start

Mon Jul 10 14:19:52 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* docs/format.html docs/libvir.html docs/news.html: updated the XML
	  format documentation to cover the new HVM domains.

Mon Jul 10 12:27:17 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xml.c: patches from Jim Fehlig for HVM
	  guests, plus XML format changes and merge from Mark McLoughlin

Fri Jul  7 09:47:14 EDT 2006 Daniel Berrange <berrange@redhat.com>

	* src/xend_internal.c: changed xenDaemonLookupByID to simply do
	an sexpr GET on /xend/domain/[ID] instead of listing all names
	and iterating over /xend/domain/[NAME]. Reduces the running time
	and number of GETs from O(n^2) to O(n).

Wed Jul  5 17:11:32 IST 2006 Mark McLoughlin <markmc@redhat.com>

	* xml.c: allow a <domain> to not have any <disk> devices - e.g.
	when using an NFS root.

Thu Jul  6 10:32:14 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: fixed xenDaemonOpen() to try both unix and
	  http accesses by default and to use the provided URI otherwise,
	  applied Jim Fehlig patch working around xend connection close bug
	* autogen.sh: fixed package name

Wed Jul  5 17:11:32 IST 2006 Mark McLoughlin <markmc@redhat.com>

	* xml.c: make the entire <os> node optional if a bootloader
	is specified. If we pass an image config to xend, the
	bootloader gets ignored anyway.

Wed Jul  5 16:51:45 IST 2006 Mark McLoughlin <markmc@redhat.com>

	* xml.c: only set bootloader flag when we actually get
	a bootloader

Tue Jul  4 13:50:55 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in proxy/Makefile.am: do the chown at the rpm packaging
	  level, to allow build as non-root
	* src/xml.c: fix bug #197583 raised by markmc

Mon Jul  3 15:41:58 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS docs/* configure.in libvirt.spec.in include/libvirt/libvirt.h:
	  preparing release of 0.1.2
	* src/proxy_internal.c: don't warn on open if using http and not the
	  proxy.

Mon Jul  3 13:54:03 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in proxy/Makefile.am src/proxy_internal.c
	  src/xen_internal.c: fixing the proxy installation, integrate in
	  the spec file and fix a few bugs in the proxy, seems to behave
	  correctly now.
	* docs/apibuild.py docs/*: fixing the doc and API generator

Mon Jul  3 11:21:10 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* proxy/libvirt_proxy.c src/proxy_internal.[ch] src/xend_internal.[ch]:
	  finished the last entry point missing for the proxy code.

Fri Jun 30 16:31:47 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* proxy/libvirt_proxy.c src/proxy_internal.c: more bug fixes,
	  virsh starts to work normally over the proxy. Still one entry
	  point missing but it's minor.

Thu Jun 29 23:57:35 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* proxy/libvirt_proxy.c src/proxy_internal.c src/xen_internal.c
	  src/xen_internal.h src/xend_internal.c src/xend_internal.h:
	  implemented id based lookup and other cleanups, virsh starts to
	  work, but still some TODOs

Thu Jun 29 22:19:51 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/proxy_internal.c src/proxy_internal.h src/driver.h src/libvirt.c
	  src/Makefile.am: moved proxy/proxy.h and proxy/proxy_client.c as
	  proxy_internal.[ch] and integrated them as a new driver.
	* proxy/Makefile.am proxy/libvirt_proxy.c src/xen_internal.c
	  src/xen_internal.h src/xend_internal.c: various related cleanups.

Thu Jun 29 14:53:01 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* proxy/libvirt_proxy.c proxy/proxy.h proxy/proxy_client.c: more
	  progresses on the proxy implementation.
	* src/xend_internal.c src/xend_internal.h: exported one routine

Wed Jun 28 19:23:25 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in Makefile.am proxy/Makefile.am proxy/libvirt_proxy.c
	  proxy/proxy.h proxy/proxy_client.c src/internal.h src/xen_internal.c
	  src/xend_internal.c: started working on a proxy to access xend
	  for unpriviledged users to avoid opening xend HTTP service to
	  serve those read-only operations.

Mon Jun 26 16:05:27 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/examples/* include/Makefile.am
	  include/libvirt/virterror.h python/generator.py python/libvir.c
	  python/libvirt_wrap.h src/driver.h src/internal.h src/test.h
	  src/virsh.c src/virterror.c src/xend_internal.c src/xend_internal.h
	  src/xml.c src/xml.h: moved the includes from include/ to
	  include/libvirt to reflect the installed include tree. This
	  avoid using "" in the includes themselves.

Wed Jun 21 14:41:04 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS libvirt.spec.in docs/*: preparing release of 0.1.1

Wed Jun 21 13:02:30 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/driver.h src/libvirt.c src/test.c src/xen_internal.c
	  src/xend_internal.c src/xs_internal.c: add driver numbers and
	  tweak a bit suspend/resume/destroy operation to avoid doing
	  them directly though the hypervisor if other succeeded first.

Wed Jun 21 12:23:15 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: try to autodetect the Xen hypervisor version
	  used and switch automatically. A bit nasty though.

Tue Jun 20 16:14:26 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c: fix breakage introduced in Xen changeset 10277

Fri Jun 16 15:08:42 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xen_internal.c src/xen_internal.h src/xs_internal.c: fix
	  a TODO in xs_internal.c pointed out by Philippe Berthault

Fri Jun 16 12:44:02 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/xen_internal.c src/xend_internal.c: more driver
	  related cleanups, nearly finished

Thu Jun 15 14:57:39 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/xend_internal.c src/xend_internal.h
	  src/xs_internal.c: more cleanups for the driver architecture

Wed Jun 14 18:59:30 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/test.h, src/test.c: Added implementation of the reboot
	and shutdown methods for domains.

Wed Jun 14 11:20:23 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/libvirt.c: connect virDomainDestroy, virDomainSuspend,
	virDomainResume, virDomainShutdown & virDomainReboot to the
	driver backends.

Wed Jun 14 15:51:00 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/xend_internal.c src/xend_internal.h: cleaned up
	  virConnectListDomains and virConnectNumOfDomains, implemented xend
	  driver entry point for them.

Wed Jun 14 13:10:03 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: Daniel P. Berrange pointed out a bug in virConnectOpen

Tue Jun 13 14:06:01 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: use 'double' instead of 'float' when calculating
	'CPU time' field for dominfo command, to ensure no unneccessary
	loss of precision converting from nanoseconds to seconds.

Tue Jun 13 18:35:22 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/xen_internal.c src/xend_internal.c
	  src/xs_internal.c: fix the connection and GetType initialization.

Tue Jun 13 16:37:27 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* docs//*: rebuilt the documentation
	* src/driver.h src/libvirt.c src/test.c src/xen_internal.c
	  src/xend_internal.c src/xs_internal.c: started to fix some of
	  the driver related problem raised by Daniel Berrange, added a
	  ver version field to drivers.

Mon Jun 12 17:22:24 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/xend_internal.c: Call 'xenDomainGetVersion' when trying
	to open a connection, as a sort of "ping" test to verify the
	Xen daemon connection - fail the open method, if the "ping" is
	not successful.

Mon Jun 05 22:31:20 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/test.c, src/test.h: New 'mock' hypervisor driver providing
	a way to write predictable unit tests which exercise libvirt APIs.
	* src/libvirt.c, src/Makefile.am: Integrate test hypervisor driver

Fri May 26 11:59:20 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/hash.c, src/internal.h: Switch the uuid parameter in virGetDomain
	  to be of type 'unsigned char' since its a raw UUID we're passing in,
	  not a printable one.
	* src/libvirt.c: Remove bogus "unsigned char" -> "char" type casts. Hook
	  up the "domainLookupByID", "domainLookupByUUID", "domainLookupByName"
	  and "domainGetInfo" driver backend functions.

Mon May 29 17:02:26 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/libvirt_sym.version: added in missing symbols referenced by python
	  bindings (patch by Daniel P. Berrange)
	* tests/Makefile.am: fixed include dirs to make VPATH builds work
	  (patch by Daniel P. Berrange)

Mon May 29 16:33:39 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/virsh.c: improved vshCommandOptDomain(), added <name> to the
	  connect command and minor changes to Daniel B.'s patch

Fri May 26 11:40:20 EDT 2006 Daniel P. Berrange <berrange@redhat.com>

	* src/virsh.c: added 'domuuid' command to display printable UUID
	  string for a domain. Added '--connect' argument to allow the name
	  of the hypervisor connection passed to virConnect to be set.

Mon May 22 15:34:20 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/virsh.c: added UUID: to the dominfo command, vshPrint() refactoring,
	  added support for domain look up by UUID
	* virsh.1: added information about UUID, fixed list of commands and
	  domains statuses
	* src/libvirt.c include/libvirt.h.in src/libvirt_sym.version: added
	  virDomainGetUUIDString() and virDomainLookupByUUIDString()

Wed May 10 15:50:32 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/virterror.c include/virterror.h: added VIR_FROM_RPC
	* src/xmlrpc.c: added checks and _virRaiseError()

Wed May 10 13:17:00 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/xml.c src/xml.h: added virBufferNew() and virBufferStrcat()
	* tests/xmlrpctest.c: added performace tests for virBufferStrcat() and
	  virBufferVSprintf()
	* src/xmlrpc.c: used virBufferStrcat()

Tue May  9 16:37:22 CEST 2006 Karel Zak <kzak@redhat.com>

	* tests/Makefile.am tests/xmlrpctest.c tests/testutils.h: added test
	  directory with basic test utils
	* tests/test_xmlrpc.sh tests/xmlrpcserver.py tests/xmlrpctest.c: added
	  simple XML-RPC tests agains Python SimpleXMLRPCServer
	* src/xmlrpc.c src/xmlrpc.h: minor refactoring, fixed gcc warnings
	* src/xml.c src/xml.h: added virBufferFree()

Fri Apr 28 18:31:49 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/hash.c src/internal.h src/libvirt.c src/virterror.c
	  src/xml.h include/libvirt.h[.in] include/virterror.h: started
	  adding new APIs, some still TODO, and not tested yet

Thu Apr 27 14:17:04 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c src/xend_internal.c TODO: added uuid to the XML
	  serialization

Wed Apr 26 08:32:38 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: applied patch from Jeremy Katz to not require a
	  root entry in XML nor try to extract it from command line
	  informations.

Wed Apr 26 07:45:28 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* docs//* : fixed perl binding URL to point to CPAN as provided by
	  Daniel P. Berrange.

Tue Apr 25 17:56:32 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in: patch for ncurses fallback from Jim Fehlig

Tue Apr 25 17:10:10 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/examples/Makefile.am
	  docs/examples/index.py docs/examples/python/*: integrated
	  examples for Python from David Lutterkort

Tue Apr 25 13:37:22 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Jim Fehlig when parsing
	  domain S-Expr the kernel may not be provided (Dom0)

Mon Apr 24 18:23:29 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/hash.c src/internal.h: add virGetDomainByID() to speed up
	  some processing but not used yet
	* src/libvirt.c src/xen_internal.c src/xen_internal.h: added domain
	  listing and number queries entry points based on the hypervisor
	  which should speed up some processing as root.

Thu Apr 20 14:31:13 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: fix an uninitialized memory access in error
	  reporting.

Thu Apr 13 17:19:25 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt.h include/libvirt.h.in doc/*: added new entry point
	  virDomainSetMemory to set up the target memory use for a domain
	* src/driver.h src/libvirt.c src/xen_internal.c src/xend_internal.[ch]
	  src/xs_internal.[ch]: added a new entry point in the drivers for this,
	  also fixed the xen store entry, as changing
	  /local/domain/$$/memory/target affects the target memory not the max,
	  apparently max is not visible at the xenstore level (or I missed it)

Mon Apr 10 15:15:13 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in libvirt.spec.in docs/*: documented and
	  regenerated for release of 0.1.0
	* Makefile.am virsh.1: added man page from Andrew Puch

Mon Apr 10 09:32:29 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c src/xml.c: applied patch from Jim Fehlig
	  for lifecycle events
	* docs/format.html docs/libvir.html: added the associated docs for
	  the new constructs
	* TODO: small update

Sun Apr  9 13:10:34 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* TODO src/hash.[ch] src/internal.h src/libvirt.c src/xend_internal.c
	  src/xs_internal.c: implementing domain pointers unification, thread
	  safety and reference counting for domain and connections, this was
	  the last critical change needed before making further progresses at
	  the API level. Still a couple fo things TODO for this, unification
	  at the Python level and adding UUID to hash. All domain/connect alloc
	  and free routines are now centralized in hash.c
	* docs/APIchunk1.html docs/libvirt-api.xml docs/libvirt-refs.xml
	  docs/html/libvirt-libvirt.html: regenerated the docs, that doesn't
	  change the API.

Thu Apr  6 11:32:46 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/virsh.c: use stdout for standard outputs, improve
	 allocation checks

Wed Apr  5 09:32:54 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* src/hash.c: tiny fix
	* src/internal.h: starting to work on reentrancy
	* src/libvirt.c: applied patch from Jim Fehlig to fix
	  virDomainLookupByID when run as root.

Tue Apr  4 22:49:33 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/virsh.c: rename dstate, idof and nameof to domstate,
	  domname and domid

Tue Apr  4 12:41:53 CEST 2006 Karel Zak <kzak@redhat.com>

	* src/virsh.c: add new command "nodeinfo"
	* include/libvirt.h.in: fix typo (virNodeInfo.memory is in kB)
	* docs/FAQ.html docs/libvir.html src/virsh.c: rename command
	  "dinfo" to "dominfo"

Mon Apr  3 14:46:39 EDT 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt.h[.in] src/driver.h src/libvirt.c
	  src/libvirt_sym.version src/*_internal.[ch]: added an entry
	  point for reboot and corresponding driver plug
	* src/virsh.c: added a reboot option using it
	* docs/*: regenerated

Thu Mar 30 16:38:18 EST 2006 Daniel Veillard <veillard@redhat.com>

	* src/xend_internal.c: applied patch from Daniel P. Berrange,
	  plus a bit of code cleanup

Thu Mar 30 16:04:47 EST 2006 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: allocation check (Jim Meyering) and adding a
	  new create command
	* src/xend_internal.c src/xml.c: trying to cope with the new
	  xvda domains states generated on FC5, but Dom0 bootloader
	  really break the model, so that doesn't work.

Thu Mar 30 12:15:46 EST 2006 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: catching memory allocation error and existing, as
	  pointed by Jim Meyering

Wed Mar 29 16:36:24 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* doc/*: rebuilt

Wed Mar 29 13:34:25 EST 2006 Daniel Veillard <veillard@redhat.com>

	* python/libvir.c: fixed a bug in the new wrapper
	* python/tests/Makefile.am python/tests/node.py: added a new test for
	  the new API
	* python/tests/create.py: remove a debug

Wed Mar 29 14:43:56 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt.h[.in] include/virterror.h src/driver.h
	  src/internal.h src/libvirt_sym.version src/xen_internal.c
	  src/xs_internal.c: added a new entry point to get node hardware
	  informations virGetNodeInfo, and associated driver hook.
	* src/xend_internal.c: implemented the node and version information
	  hooks for the Xen Daemon
	* python/libvir.c python/libvirt-python-api.xml python/generator.py:
	  also added Python bindings for the new call

Tue Mar 28 16:40:08 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* python/libvir.c: call the initialize entry point
	* src/libvirt_sym.version: add initialize entry point
	* src/libvirt.c: make sure we always initialize the lib
	* python/tests/*.py: start updating exemple for exception
	  handling as pointed by Jim Meyering

Tue Mar 28 11:49:59 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* doc/site.xsl doc/libvir.html doc/*: added informations about
	  the Perl bindings, regenerated
	* python/libvirt_wrap.h: added a missing include.

Mon Mar 27 17:22:16 CEST 2006 Daniel Veillard <veillard@redhat.com>

	* doc/*: updated module list and rebuilt
	* include/libvirt.h include/libvirt.h.in: added intialization function
	* include/virterror.h src/virterror.c: one more error code
	* src/internal.h: first part of Jim's format checking
	* src/libvirt.c src/xen_internal.[ch] src/xend_internal.[ch]
	  src/xs_internal.[ch]: initialization and registration of drivers

Sat Mar 25 11:45:06 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am: add  driver.h to SOURCES as pointed by Jim Meyering
	* doc/*: rebuilt

Sat Mar 25 11:38:29 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/virterror.c: add message as pointed by Jim Meyering

Fri Mar 24 23:57:56 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/virterror.h: fix typos pointed by Jim Meyering

Fri Mar 24 23:36:05 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/virterror.h: applied patch from Daniel Berrange for out of
	  tree compiles.

Fri Mar 24 14:17:52 CET 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.pc.in: applied patch from Daniel Berrange to fix --cflags

Fri Mar 24 14:03:26 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am: fix out of tree build

Thu Mar 23 16:40:37 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xs_internal.c src/xs_internal.h include/virterror.h
	  src/virterror.c: created a new module related to Xen Store accesses
	* src/libvirt.c src/xen_internal.[ch] src/xend_internal.[ch]:
	  nearly completed the separation of the code from the different modules

Wed Mar 22 14:43:16 CET 2006 Daniel Veillard <veillard@redhat.com>

	* python/tests/create.py: add one more image path
	* src/libvirt.c src/xend_internal.c src/xend_internal.h: more work
	  on the xend refactoring

Wed Mar 22 13:34:32 EST 2006 Daniel Veillard <veillard@redhat.com>

	* python/tests/create.py: adapt to new naming scheme in FC5

Tue Mar 21 00:40:29 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/driver.h src/xen_internal.c: just add a driver block for
	  the Xen hypervisor direct access module. Need to convert
	  xend_internal.[ch] and make one for the Xenstore now ...

Mon Mar 20 18:43:19 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/driver.h src/internal.h src/libvirt.c src/xen_internal.c
	  src/xen_internal.h docs/apibuild.py: starting the refactoring,
	  first the direct Xen hypervisor module. New header describing the
	  entry points of a driver.

Wed Mar 15 13:10:25 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/hash.c src/hash.h src/internal.h src/libvirt.c src/sexpr.c
	  src/sexpr.h src/virsh.c src/virterror.c src/xen_internal.c
	  src/xen_internal.h src/xend_internal.c src/xend_internal.h
	  src/xml.c src/xml.h: applied cb/indent to homogenize the source
	  style, as a first pass.

Fri Mar 10 11:07:58 CET 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in: applied patch for --with-xen-distdir option from
	  Ronald Aigner
	* docs/site.xsl docs/*.html: added link to Bugzilla

Sat Mar  4 09:59:13 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: another patch from David Lutterkort fixing a typo
	  when generating physical block devices descriptions.

Sat Mar  4 09:56:18 CET 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.spec.in: applied patch from David Lutterkort adding
	  missing reqs for readline.

Tue Feb 28 15:21:48 CET 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in libvirt.spec.in include/libvirt.h docs/*:
	  preparing release 0.0.6

Tue Feb 28 14:57:25 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/errors.html docs/libvir.html docs/*: added a page about
	  error handling and regenerated the docs

Tue Feb 28 13:12:50 CET 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* python/Makefile.am python/generator.py python/libvir.c
	  python/libvir.py: improved python binding, raise exception
	  when an instance creation or lookup fails, and add support
	  for the global error handler, per conn handler still needed
	* python/tests/error.py python/tests/Makefile.am: adding a
	  regression test

Mon Feb 27 17:36:29 EST 2006 Daniel Veillard <veillard@redhat.com>

	* doc//*: rebuilt

Mon Feb 27 17:33:16 EST 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated, and added python hooks for error handling
	* include/virterror.h src/virterror.c src/xml.c: error interception
	  and reporting should be done.

Mon Feb 27 16:42:46 EST 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/xen_internal.[ch]: virConnectOpenReadOnly()
	  should not emit error when failing to open the hypervisor proc
	  entry point.

Mon Feb 27 16:32:55 EST 2006 Daniel Veillard <veillard@redhat.com>

	* include/virterror.h src/libvirt_sym.version: exported
	  virDefaultErrorFunc()
	* src/sexpr.c src/xen_internal.c src/virterror.c include/virterror.h:
	  adding more error reporting though the code, nearly complete.
	* src/sexpr.c: added specific error function to avoid an error report.

Mon Feb 27 14:56:57 EST 2006 Daniel Veillard <veillard@redhat.com>

	* include/virterror.h src/virterror.c src/xend_internal.c: more work
	  plugging in the error system in the code.

Mon Feb 27 17:25:48 CET 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* include/virterror.h src/internal.h src/libvirt.c src/virterror.c
	  src/xend_internal.c: commiting a first pass at adding error handling
	  in the code, not finished, but it starts to work, need more coverage
	  and testing.

Fri Feb 24 23:33:55 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/internal.h src/libvirt.c src/libvirt_sym.version
	  src/virterror.c include/Makefile.am include/virterror.h: adding
	  the public APIs for errors, callbacks and synchronous. The boring
	  stuff is still left to do, plugging it. Also need to be exposed
	  at the python level.
	* doc//*: rebuilt

Fri Feb 24 22:17:12 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/index.py docs/search.php: fixing the search engine.

Fri Feb 24 13:25:36 CET 2006 Daniel Veillard <veillard@redhat.com>

	* python/generator.py python/libvir.c python/libvirt-python-api.xml:
	  UUID strings can contain zeroes, so the autogenerated conversion
	  functions don't work.

Thu Feb 23 06:24:46 EST 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c: fixing a bug before the release of 0.0.5
	* python/generator.py python/libvir.c python/libvirt-python-api.xml:
	  also fixing the binding for getting a domain UUID
	* python/tests/Makefile.am python/tests/uuid.py: added a test
	  for the new UUID API

Thu Feb 23 11:41:06 CET 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in docs/libvir.html docs/news.html: preparing the
	  release of 0.0.5
	* include/libvirt.h.in: fixed APIs definition

Thu Feb 23 05:31:46 EST 2006 Daniel Veillard <veillard@redhat.com>

	* python/tests/Makefile.am: added the create.py in the regression tests

Thu Feb 23 05:13:03 EST 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvirt.h[.in] src/libvirt.c src/xend_internal.[ch]
	  src/libvirt_sym.version: added virDomainLookupByUUID and
	  virDomainGetUUID to be able to use the persistant UUID names
	* docs//*: rebuilt the docs following the API extension

Wed Feb 22 11:53:45 CET 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in docs/Makefile.am docs/devhelp/*:
	  added devhelp docs support, based on libxml2 stylesheets

Wed Feb 22 09:57:11 CET 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* libvirt.spec.in: package the examples in the doc
	* src/Makefile.am: forgot to add xml.h

Tue Feb 21 22:00:11 CET 2006 Karel Zak <kzak@redhat.com>

	* TODO: added virsh part

Tue Feb 21 09:14:07 EST 2006 Daniel Veillard <veillard@redhat.com>

	* Makefile.am: extended make tests to run those in docs/examples
	* docs/examples/suspend.c docs/examples/*: added an example of
	  suspend/resume and regenerated

Tue Feb 21 14:21:39 CET 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* python/tests/Makefile.am: fix a small PYTHONPATH bug
	* docs//*: fixed the xsl a bit for toc names, added doc for
	  the python bindings, regenerated

Tue Feb 21 00:06:30 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvirt.c src/xend_internal.c src/xend_internal.h: move the
	  XML dump function around to make sure all entry points are centralized
	  in libvirt.c and also avoid doc generation troubles.
	* docs/examples/Makefile.am docs/examples/index.py: fix the makefile
	  a bit.
	* TODO: updated
	* docs/format.html: added a description of the XML used for the
	  domains.
	* docs//*: rebuilt

Mon Feb 20 21:48:55 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/examples/examples.xsl docs/examples/index.html
	  docs/site.xsl: integates the examples page in the web site
	* docs//* : fixed generator and rebuilt the docs
	* python/tests/basic.py python/tests/create.py: couple cleanups

Mon Feb 20 12:20:32 EST 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* include/libvirt.h include/libvirt.h.in: cleanup
	* src/libvirt.c: remove debugging output
	* src/xend_internal.c src/xml.c src/xml.h: reimplement
	  virDomainGetXMLDesc() based on xend interface, now work as user too.

Fri Feb 17 08:17:36 EST 2006 Daniel Veillard <veillard@redhat.com>

	* python/tests/create.py: trying to make test more generic, but it's
	  difficult since it requires a system image
	* src/libvirt.c src/xend_internal.c: fixed the shutdown API which
	  was broken due to a bad reason at the xend level.

Thu Feb 16 17:47:00 EST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in src/Makefile.am: adding dependency to libxml2
	* include/libvirt.h* src/libvirt.c src/xend_internal.[ch]
	  src/xml.[ch]: added XML parsing for Xen domain descriptions
	  needed for creates, plugged in a converter to s-exp and
	  xend call. Modified the virDomainCreateLinux() to reflect
	  that XML based description. Seems to work.
	* python/tests/create.py: added a test case which seems to work
	  not tested much yet
	* docs/*: regenerated

Wed Feb 15 08:20:23 EST 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in libvirt.spec.in include/libvirt.h.in python/Makefile.am
	  src/Makefile.am: fix rpm packaging problems whith head, more
	  LIBVIR -> LIBVIRT changes.

Tue Feb 14 15:29:01 EST 2006 Daniel Veillard <veillard@redhat.com>

	* Makefile.am configure.in python/Makefile.am python/tests/Makefile.am
	  python/tests/basic.py: added first python test script and
	  a 'make tests' target

Fri Feb 10 16:45:50 CET 2006 Daniel Veillard <veillard@redhat.com>

	* libvirt.pc.in: Karel pointed out the name hadn't been updated

Fri Feb 10 11:30:41 EST 2006 Daniel Veillard <veillard@redhat.com>

	* python/libvir.c: fixed one more problem prior to 0.0.4

Fri Feb 10 11:21:53 EST 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS configure.in docs/libvir.html docs/news.html include/libvirt.h
	  libvirt.spec.in: preparing 0.0.4 release

Fri Feb 10 11:09:11 CET 2006 Daniel Veillard <veillard@redhat.com>

	* README TODO config.h.in libvirt.pc.in: more cleanups.

Fri Feb 10 09:42:45 CET 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS docs/*: regenerated and updated the docs post 0.0.3 release

Fri Feb 10 09:39:23 CET 2006 Daniel Veillard <veillard@redhat.com>

	* autogen.sh configure.in: fixed snapshot autogeneration, had to
	  tweak a few things

Wed Feb  8 11:43:43 EST 2006 Daniel Veillard <veillard@redhat.com>

	* //* : renamed the project libvirt , this affects all makefiles,
	  the specs, the icons, the docs, etc ...
	* configure.in: prepare for 0.0.3

Fri Feb  3 15:47:32 CET 2006 Karel Zak <kzak@redhat.com>

	* src/virsh.c: fix order of the save command options

Tue Jan 31 19:12:19 CET 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in docs/examples/*: starting to add examples. the XSLT
	  still need to be fixed for web site

Tue Jan 31 11:22:51 CET 2006 Daniel Veillard <veillard@redhat.com>

	* python/*: update of the python bindings, fix names, add
	  missing features like list of domains and domain info extraction

Tue Jan 31 11:21:56 CET 2006 Daniel Veillard <veillard@redhat.com>

	* configure.in libvir.spec.in NEWS docs/*: commiting the state of 0.0.2
	  release

Sun Jan 29 11:55:13 CET 2006 Daniel Veillard <veillard@redhat.com>

	* NEWS docs/news.xsl: added stylesheet to generate NEWS file
	* docs/*: updated docs preparing for the release

Sun Jan 29 09:52:03 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/site.xsl docs/*.html: credits to Diana Fong for graphics
	  and web site design

Sat Jan 28 21:24:05 CET 2006 Daniel Veillard <veillard@redhat.com>

	* python/libvir.c: fix a stupid bug in python bindings (DomainDestroy
	  is still mishandled though)

Fri Jan 27 09:58:31 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c src/xml.c: applied patch from Anthony Liguori
	  to remove the XenStore transactions as this is not needed
	  anymore.

Thu Jan 26 13:10:43 CET 2006 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* docs/search.php: use the new web site design
	* python/generator.py: fix a generation bug on python keyword

Tue Jan 24 11:44:53 CET 2006 Karel Zak <kzak@redhat.com>

	* src/libvir_sym.version: add virDeomainRestore and virDomainSave
	* src/virsh.c: support '=' in options, fix command grammar
	* src/libvir.c: add conn->xshandle checks

Tue Jan 24 14:09:37 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c: Karel pointed out handle was lost in
	  virConnectOpenReadOnly()

Mon Jan 23 23:53:07 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/site.xsl docs/*.png docs/*.html: update the images from Diana,
	  added favicon to page.
	* src/libvir.c: reorganized the include imports.

Mon Jan 23 14:23:16 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/*: augment and try to complete the doc in its current state

Sun Jan 22 17:26:20 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/*: started to augment and update the documentation

Sat Jan 21 23:33:46 GMT 2006 Daniel Veillard <veillard@redhat.com>

	* docs//*: mostly finished the revamp in the plane, starts to look good

Fri Jan 20 16:48:05 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/* : total revamp of the web site based on Diana Fong design
	  but not completely integrated yet

Fri Jan 20 10:57:44 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h include/libvir.h.in src/libvir.c: revamped the
	  restore API (though it would be better if it was returning
	  a domain pointer in case of success)
	* src/virsh.c: added save and restore to the commands, tested,
	  the option handling need work though

Thu Jan 19 11:21:57 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c src/xend_internal.c src/xend_internal.h: continue
	  the integration of more xend based accesses, virsh seems to work
	  without accessing the xen store now.

Wed Jan 18 19:57:53 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c: small change w.r.t. reboot.

Wed Jan 18 11:32:04 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h include/libvir.h.in src/libvir.c: more integration
	  of libxend capabilities, including checkpointing and restoring
	  in a file.
	* docs//*: regenerated the docs

Tue Jan 17 17:53:43 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h[.in]: added VIR_DOMAIN_CRASHED status, small
	  doc fix
	* src/virsh.c: fix a integer being formatted as %s in idof
	* src/internal.h src/libvir.c src/xend_internal.[ch]: started to
	  integrated the xend back-end, especially for getting informations
	  about a domain.

Fri Jan 13 17:39:24 CET 2006 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h.in include/libvir.h src/internal.h src/libvir.c
	  src/xend_internal.c src/xend_internal.h: starting to plug the
	  xend code in, replacing structures mostly, but not finished.

Thu Jan 12 16:36:21 CET 2006 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/xend_internal.c src/xend_internal.h:
	  added more of Anthony Liquori libxend code, commented and reformatted
	  this still need to be plugged, it's still dead code ATM.

Wed Jan 11 14:57:01 CET 2006 Daniel Veillard <veillard@redhat.com>

	* docs/libvir.html: grammatical fix
	* src/Makefile.am src/sexpr.c src/sexpr.h: starting to integrate
	  Anthony Liquori libxend code
	* src/libvir.c: fix an uninitialized value

Wed Dec 21 17:58:45 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/architecture.* docs/*: added a section on the architecture
	  and regenerated the docs.

Mon Dec 19 19:04:11 CET 2005 Daniel Veillard <veillard@redhat.com>

	* NEWS docs/libvir.html docs/news.html: preparing 0.0.1 release

Mon Dec 19 17:32:22 CET 2005 Daniel Veillard <veillard@redhat.com>

	* Makefile.am configure.in libvir.spec.in python/*: added a first
	  version for python bindings, heavilly based on libxml2/libxslt
	  way of doing things, maybe this need to be revisited. Added packaging
	  too.
	* src/hash.h: fixed the Copyright notice.

Fri Dec 16 19:35:29 CET 2005 Karel Zak <kzak@redhat.com>

	* src/xml.c src/internal.h src/libvir.c: struct checks cleanup,
	  add macros VIS_IS_DOMAIN(), VIR_IS_CONNECT() and VIR_IS_CONNECTED_DOMAIN()

Fri Dec 16 14:26:05 CET 2005 Daniel Veillard <veillard@redhat.com>

	* libvir.spec.in src/Makefile.am: cleaned up the spec file, removed
	  static libraries, adding virsh as an installed program

Fri Dec 16 13:59:35 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/libvir_sym.version: oops forgot to export the new symbol

Fri Dec 16 13:15:04 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h include/libvir.h.in src/internal.h src/libvir.c:
	  adding the virDomainShutdown() API
	* src/virsh.c: adding a shutdown command
	* docs/*: regenerated

Fri Dec 16 01:43:18 CET 2005 Karel Zak <kzak@redhat.com>

	* include/libvir.h.in: add missing declaration of virDomainGetXMLDesc()
	* include/libvir.h.in src/libvir.c src/virsh src/libvir_sym.version: add
	  virDomainGetOSType()
	* src/internal.h src/libvir.c src/xml.c: add internal function virDomainGetVM(),
	  move virDomainGetVMInfo() from src/xml.c

Thu Dec 15 17:56:27 CET 2005 Karel Zak <kzak@redhat.com>

	* src/virsh.c: remove --id / --name options

Wed Dec 14 16:28:24 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: add dump of os/boot informations

Wed Dec 14 13:35:39 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: added dump of physical vbd and read-only status

Wed Dec 14 12:20:06 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/xml.c: started to add block devices and interfaces descriptions
	  in the XML dump.

Tue Dec 13 17:20:11 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h src/Makefile.am src/internal.h src/libvir.c
	  src/libvir_sym.version src/virsh.c src/xml.c: started working on
	  the XML dump, added a dumpxml virsh version and a bit of
	  infrastructure code. Found a way to detect dead ID from xenstore
	  data.

Mon Dec 12 14:21:18 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c src/xen_internal.c src/xen_internal.h: completing the
	  API implementation, only CreateLinux is now missing.

Fri Dec  9 15:39:18 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/search.php docs/index.py docs/*.xsl docs/html/*: fixed the
	  page generation, added the search engine.

Fri Dec  9 14:03:13 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/*: extended the documentation

Fri Dec  9 11:15:41 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in: adding --without-depends to make dist on non
	  Xenified machine.

Fri Dec  9 00:47:12 CET 2005 Daniel Veillard <veillard@redhat.com>

	* Makefile.am include/libvir.h.in libvir.pc.in: various fixes.
	* docs/*: regenerated the docs

Fri Dec  9 00:02:06 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/virsh.c: added support for suspend/resume/destroy, validating
	  the previous code.

Thu Dec  8 18:16:20 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c src/xen_internal.c src/xen_internal.h: implement
	  Pause, Resume, Destroy, but untested yet.

Thu Dec  8 17:43:11 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h src/libvir.c src/libvir_sym.version: adding
	  virDomainFree()
	* docs/*: regenerated the docs

Thu Dec  8 16:07:07 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in include/libvir.h.in include/libvir.h src/Makefile.am
	  include/Makefile.am: provide/fix library versionning information
	  include/libvir.h is now generated !
	* include/libvir.h.in src/libvir.c: revamp APIs and implement
	  complete ones.
	* src/virsh.c: finish the version command and a bit of cleanup.

Thu Dec  8 15:20:57 CET 2005 Karel Zak <kzak@redhat.com>

	* src/virsh.c: code cleanup to prevent gcc warnings

Thu Dec  8 14:25:09 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in: activate pedantic flags
	* src/libvir.c src/libvir_sym.version src/xen_internal.[ch]
	  include/libvir.h: implementing hypervisor Version and Type interfaces
	* src/virsh.c: adding a version command, WIP

Thu Dec  8 11:19:48 CET 2005 Karel Zak <kzak@redhat.com>

	* src/Makefile.am src/virsh.c configure.in: adding readline support,
	  and implement basic commands to virsh.

Thu Dec  8 11:12:36 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/libvir.c src/xen_internal.c: fixed the new Xen hypervisor call

Wed Dec  7 19:09:48 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in src/Makefile.am src/libvir.c src/xen_internal.c
	  src/xen_internal.h: removed dependancy on xenctrl library, untested
	  yet.

Wed Dec  7 15:08:54 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/*: adding missing links to API page.

Wed Dec  7 14:43:28 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in libvir.spec.in docs/Makefile.am: make sure the
	  docs are installed and packaged in the -devel RPM
	* docs/api.xsl docs/newapi.xsl: forgot to commit API HTML stylesheets

Wed Dec  7 14:09:48 CET 2005 Karel Zak <kzak@redhat.com>
	* include/libvir.h src/libvir.c: adding xenConnectNumOfDomains()
	  to returns number of active domains.

Wed Dec  7 13:55:04 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/ChangeLog.awk docs/ChangeLog.xsl: Changelog handling from
	  libxml2 adapted to libvir
	* docs/* docs/html/libxml-libvir.html: regenerated

Wed Dec  7 11:58:20 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/* docs/html/*: more work on the docs generation
	* include/libvir.h: adding informations on the header

Wed Dec  7 10:31:29 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in docs/FAQ.html docs/Libxml2-Logo-90x34.gif
	  docs/Makefile.am docs/bugs.html docs/index.html docs/intro.html
	  docs/libvir.html docs/redhat.gif docs/site.xsl: starting to add
	  the web site, based on libxml2 one.
	* src/hash.c: add a missing include

Tue Dec  6 17:47:11 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/Makefile.am docs/apibuild.py docs/libvir-api.xml
	  docs/libvir-refs.xml: fix XML API generation
	* include/libvir.h src/libvir.c src/virsh.c: fix the info memory
	  API again, use KB, not bytes so that an unsigned long is sufficient.

Tue Dec  6 17:12:52 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h src/libvir.c src/virsh.c: adding the extraction
	  of the number of virtual CPUs for both interfaces.

Tue Dec  6 14:46:50 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h src/libvir.c src/virsh.c: tweaking of the
	  GetInfo() API, returns bytes and nanoseconds, try to fix
	  the scales, but time on unpriviledged interfaces doesn't work.

Mon Dec  5 19:14:05 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libvir.h src/libvir.c src/libvir_sym.version src/virsh.c:
	  first pass at trying to implement virDomainGetInfo() quite a bit
	  of work left to do.

Mon Dec  5 12:15:16 CET 2005 Daniel Veillard <veillard@redhat.com>

	* Makefile.am README TODO autogen.sh configure.in libvir.pc.in
	  libvir.spec.in docs/Makefile.am docs/apibuild.py docs/structures.fig
	  include/Makefile.am include/libvir.h src/Makefile.am src/hash.c
	  src/hash.h src/internal.h src/libvir.c src/libvir_sym.version
	  src/virsh.c: renamed to libvir

Fri Dec  2 15:15:26 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libxen.h src/libxen.c src/libxen_sym.version: adding
	  xenConnectListDomains() to list active domains
	* src/xensh.c: integrated a basic test for xenConnectListDomains()

Fri Dec  2 13:10:04 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in src/Makefile.am: more warnings from compiler and
	  link static in work environement

Thu Dec  1 18:32:43 CET 2005 Daniel Veillard <veillard@redhat.com>

	* Makefile.am configure.in docs/apibuild.py docs/libxen-api.xml
	  docs/libxen-refs.xml docs/structures.fig: starting to add docs
	  and the extraction tool
	* src/libxen.c: fixed comments error raised by apibuild

Thu Dec  1 17:34:23 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libxen.h src/libxen.c src/libxen_sym.version: add read-only
	  connections for normal users (but need /var/run/xenstored/socket_ro
	  to be chmoded to 666)
	* src/xensh.c: if not root use the RO access

Thu Dec  1 11:50:16 CET 2005 Daniel Veillard <veillard@redhat.com>

	* include/libxen.h src/libxen.c src/libxen_sym.version src/xensh.c:
	  changed entry points naming conventions based on feedback with
	  Karel Zak

Wed Nov 30 14:18:19 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/Makefile.am src/hash.[ch]: added hash module based on libxml2
	  one.
	* include/libxen.h src/libxen.c src/libxen_sym.version: extend API
	  start to access libxenctrl directly (need xen update to get includes)
	* src/xensh.c: access to both xenstore and hypervisor

Tue Nov 22 17:09:11 CET 2005 Daniel Veillard <veillard@redhat.com>

	* configure.in: checking xenstore library, error out on missing libs
	* include/libxen.h src/libxen.c src/libxen_sym.version: adding new
	  entry points

Thu Nov 10 17:11:03 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/makefile.am src/libxen.c src/xensh.c: add a small tool sensh,
	  implement xenopenconnect and xencloseconnect.

Wed Nov  9 10:57:12 CET 2005 Daniel Veillard <veillard@redhat.com>

	* docs/Goals: added a Goals document for the library

Mon Nov  7 18:14:50 CET 2005 Daniel Veillard <veillard@redhat.com>

	* TODO: updated
	* include/libxen.h src/libxen.c src/libxen_sym.version: extended
	  entry points to a first minimal set.
	* src/internal.h: TODO macro

Wed Nov  2 16:35:54 CET 2005 Daniel Veillard <veillard@redhat.com>

	* TODO libxen.pc.in libxen.spec.in include/Makefile.am Makefile.am
	  config.h.in configure.in: fix make dist, add rpm packaging
	* src/libxen_sym.version src/Makefile.am: set a policy of no
	  export by default of library symbols

Wed Nov  2 14:17:50 CET 2005 Daniel Veillard <veillard@redhat.com>

	* AUTHORS NEWS README autogen.sh configure.in: allow autogen.sh and
	  configure to start working
	* src/Makefile.am src/internal.h src/libxen.c: make the first compile

Wed Nov  2 13:44:47 CET 2005 Daniel Veillard <veillard@redhat.com>

	* src/libxen.c src/Makefile.am include/libxen.h configure.in
	  Makefile.am COPYING.LIB: creation
